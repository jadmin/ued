MI.Base={};String.prototype.toTitle=function(){return this.replace(/\r/g,"").replace(/\n/g,"").replace(/\'/g,"&#39;").replace(/\"/g,"&#34;").replace(/</g,"&#60;").replace(/>/g,"&#62;")};function jubao(j,g){var a="http://jubao.qq.com/cn/jubao?";g&&2==g&&(a="http://jubao.qq.com/cn/im_appeal?");""!=j&&(a+=j);var b=UI.html('<div style="width:530px;height:400px;overflow:hidden;border:solid #FFF;border-width:5px 0 10px"><iframe src="about:blank" frameborder="0" scrolling="no" onload="MI.dialog.hideLoad()"></iframe></div>')[0],c=b.firstChild;c.style.cssText="width:538px;height:430px;background:#FFF;margin:-28px 0 0 -5px;-margin-top:-32px;border-style:none";MI.dialog.show({title:'<h3 class="DmainTit">'+(g&&2==g?_("腾讯申诉平台"):_("腾讯举报平台"))+"</h3>",width:562,html:b});MI.dialog.showLoad();c.src=a}function jubao_onClose(){MI.dialog.hide()}function jubao_msg(j){jubao("appname=micoblog&subapp=web&jubaotype=msg&tw_msg_id="+j+"&tw_name=&tw_vip=&envname=web")}function jubao_user(j){jubao("appname=micoblog&subapp=web&jubaotype=uin&tw_pic_url=&tw_name="+j+"&tw_vip=&envname=web")}function jubao_qun_msg(j,g,a){jubao("appname=micoblog&subapp=weiqun&jubaotype=msg&tw_msg_id="+j+"&tw_name=&tw_vip=&envname=web&groupid="+g+"&zone="+(a?a:1))}function jubao_url(j,g,a,b){a=encodeURIComponent(a);1==b?jubao("appname=micoblog&subapp=web&jubaotype=url&tw_msg_id="+j+"&tw_name="+g+"&url="+a):2==b&&jubao("appname=appeal&subapp=micoblog_web&jubaotype=url&tw_name="+g+"&langcode=0&encoding=2&url="+a,b)}MIIco=["star","dyh"];MIIcoHtml=['<a href="http://ent.qq.com/zt2010/star2010/fans.htm" class="ico_star" title="'+_("星光达人")+'" target="_blank"></a>','<a href="http://z.t.qq.com/sz2011/index.htm" target="_blank" class="ico_dyh" title="'+_("大运会")+'"></a>'];function MIIcon(j){return"<%for(var k=0,num=MIIco.length;k<num;k++){if("+j+"[MIIco[k]]){%><%=MIIcoHtml[k]%><%;}}%>"}(function(){var j=UI.G,g=UI.GC;if(!window.MIApp||window.MIApp.lib)window.$=UI.G,window.$$=UI.GC;MI.tmpl.msg='<%for(var i=0,n=talk.length;i<n;i++){%><li id="<%=talk[i].id%>" rel="<%=talk[i].timestamp%>">\t<div class="msgBox"><div class="userName">'+_("发给")+' <a href="http://t.qq.com/<%=talk[i].name%>" title="<%=talk[i].bkname||talk[i].nick%>(@<%=talk[i].chName || talk[i].name%>)"><%=talk[i].bkname||talk[i].nick%></a>'+MIIcon("talk[i].flag")+'</div><div class="msgCnt"><%=talk[i].content%></div><div class="pubTime"><span class="time"><%=talk[i].time%></span> <%=talk[i].from%></div><p class="btnBox"><a href="#" class="replyMsg btn" rel="<%=talk[i].chName || talk[i].name%>">'+_("再写一封")+'</a><a class="btn delBtn" href="#">'+_("删除")+"</a></p></div></li><%}%>";MI.tmpl.msgIn='<%for(var i=0,n=talk.length;i<n;i++){%><li id="<%=talk[i].id%>" rel="<%=talk[i].timestamp%>">\t<div class="userPic"><a href="http://t.qq.com/<%=talk[i].name%>" title="<%=talk[i].bkname||talk[i].nick%>(@<%=talk[i].chName || talk[i].name%>)"><img src="<%=talk[i].pic%>"></a></div>\t<div class="msgBox"><div class="userName"><strong><a href="http://t.qq.com/<%=talk[i].name%>" title="<%=talk[i].bkname||talk[i].nick%>(@<%=talk[i].chName || talk[i].name%>)"><%=talk[i].bkname||talk[i].nick%></a>'+MIIcon("talk[i].flag")+':</strong></div><div class="msgCnt"><%=talk[i].content%></div><div class="pubTime"><span class="time"><%=talk[i].time%></span> <%=talk[i].from%></div><p class="btnBox"><a href="#" class="replyMsg btn" rel="<%=talk[i].chName || talk[i].name%>">'+_("回信")+'</a><a class="btn delBtn" href="#">'+_("删除")+"</a></p></div></li><%}%>";MI.tmpl.fullMediaTalk='<div class="talkWrap bgr3"><div class="sendCnt"><div class="cont bgr"><textarea class="inputTxt c_tx2"></textarea></div><div class="bot clear"><div class="sendStatus"></div><div class="insertFun"><div class="sendList insertFace"><a title="表情" href="#" class="txt"><em class="sico ico_face"></em></a></div><div class="sendList uploadPic"><a href="#" class="txt sendPic" tabindex="3"><em class="sico ico_pic"></em>图片</a></div><div class="sendList uploadMusic"><a tabindex="3" title="可按歌名、歌手名搜索并添加音乐" href="#" class="txt"><em class="sico ico_audio"></em>音乐</a></div><div class="sendList record"><a title="可录下你的语音" href="#" class="txt"><em class="sico ico_record"></em>录音</a></div><div class="sendList uploadVideo"><a href="#" class="txt" title="QQvideo、优酷、土豆、酷六、CNTV可直接播放，也可自己上传" tabindex="3"><em class="sico ico_videos"></em>视频</a></div><div class="sendList atSome"><a title="@朋友帐号就可以提到他" href="#" class="txt"><em class="sico ico_at"></em>朋友</a></div></div><div class="left"></div><input type="button" value="" class="inputBtn sendBtn"><span class="countTxt c_tx5"></span></div></div></div>';MI.tmpl.msgBox='<div class="oldMsgBox"><table border="0" cellspacing="0" cellpadding="0" class="letterBg"><tr><th>'+_("收信人")+'</th><td><div class="txtWrap"><input type="text" name="userName" id="userName" class="msgTo inputTxt" value=""/> <span class="cNote">'+_("请输入你的听众的微博帐号")+"</span></div></td></tr><tr><th>"+_("内　容")+"</th><td>"+MI.tmpl.fullMediaTalk+"</td></tr></table></div>";MI.tmpl.note='<%for(var i=0,n=talk.length;i<n;i++){%><li id="<%=talk[i].id%>" rel="<%=talk[i].timestamp%>">\t<div class="msgBox"><div class="msgCnt"><%=talk[i].content%></div><div class="pubTime"><span class="time"><%=talk[i].time%></span></div><p class="btnBox"><a href="#" class="replyMsg btn">'+_("修改")+'</a><a href="#" class="btn delBtn">'+_("删除")+"</a></p>\t</div></li><%}%>";MI.tmpl.black='<div class="blackTip"><h2><span class="ico_tsW"><span class="ico_te"></span></span>'+_("确定将{0}拉入黑名单？","<%=sex%>")+'</h2><p><span class="fs14">'+_("拉黑之后")+"...</span><br/>"+_("你们之间的收听关系将被解除，对方无法再收听你，而且你也不再收到来自{0}的任何消息与通知","<%=sex%>")+'</p><p><input type="button" value="'+_("确定")+'" /><input type="button" value="'+_("取消")+'" onclick="MI.dialog.hide()"/></p></div>';MI.tmpl.unblack='<div class="blackTip"><h2><span class="ico_tsW"><span class="ico_te"></span></span>'+_("你真的原谅{0}了吗？","<%=sex%>")+'</h2><p><span class="fs14">'+_("取消之后")+"...</span><br/>"+_("你会重新收到来自{0}的私信和其它通知","<%=sex%>")+'</p><p><input type="button" value="'+_("确定")+'"/><input type="button" value="'+_("取消")+'" onclick="MI.dialog.hide()"/></p></div>';MI.tmpl.card='<div class="uCard"><div class="tip">'+_("这是你自己")+'</div><div class="tip"></div><div class="userPic"><a></a><p class="btn"><input type="button" class="addAttention" value="" /><a href="#" class="delAttention" title="'+_("取消收听")+'">'+_('取消<i class="l"></i>')+'</a><a href="#" class="delEach" title="取消收听"><i class="ico_each"></i>取消<i class="l"></i></a></p></div><div class="uCardcnt"><p class="userName"></p><p class="nums"></p><p class="btn"><a href="#" class="reply">'+_("对话")+'</a><a href="#" class="msg">'+_("私信")+'</a><a href="#" class="chat">'+_("聊天")+'<a href="javascript:void(0)" class="more">'+_("更多")+'<em class="btn_ldrop"></em></a></p><div class="moreFun" style="display:none;"><ul><li><a href="#" class="note">'+_("备注")+'</a></li><li><a class="list" href="#">'+_("名单")+'</a></li><li><a class="addqq" href="#">'+_("加QQ")+'</a></li><li class="sep"><a class="reFollow" href="#">'+_("求收听")+'</a></li><li class="sep"><a class="recom" href="#">'+_("推荐")+'</a></li><li><a href="#" class="black">'+_("拉黑")+'</a></li><li><a class="report" href="#">'+_("举报")+'</a></li><li><a class="hotLine" href="#">'+_("热线")+'</a></li></ul></div><div class="uInfobox"><div class="sepline"></div><p class="uIntro"></p><p class="tagBox"></p><p class="company"></p><p class="school"></p></div><div class="uRelaBox"></div><a href="#" class="ico_sFo"></a></div><div class="rf clear" style="display:none"><dl style="display:none"><dt class="commenNum"></dt><dd class="commenFriend"></dd></dl><dl style="display:none"><dt class="commenNum"></dt><dd class="commenFriend"></dd></dl></div><div class="uloadBox"><em class="loading"></em>'+_("资料卡加载中")+'</div><div class="SA"><em>◆</em><span>◆</span><b>◆</b></div></div>';MI.tmpl.code='<div class="verify"><span class="ico_tsW"><span class="ico_te"></span></span><h3></h3><div class="clear"><form><div class="left">'+_("验证码：")+'</div><div class="verifyInput"><input type="text" class="inputTxt" /><div class="cNote">'+_("输入下图中的字符，不区分大小写")+'</div><img width="130" height="53">&nbsp;<a href="#" class="codeChange">'+_("看不清，换一张")+'</a></div></div><div class="btnBox"><button type="submit" class="btn2">'+_("确定")+'</button><button type="button" class="btn2">'+_("取消")+"</button></form></div></div>";MI.tmpl.know='<div class="tjRelaWrap"><div class="title"><div class="left">'+_("可能认识的人")+'<a class="cSign" style="display:none"></a><a class="change" href="#">['+_("换一换")+']</a><a href="http://t.qq.com/potential.php" target="_blank">['+_("全部")+']</a></div><div class="right"><a href="#" class="closebtn">'+_("关闭")+'</a></div></div><ul class="tjRelaList clear"><ul></div>';MI.loadPM=function(a){var b=location.protocol+"//pm.t.qq.com/",c=location.protocol+"//rescdn.qqmail.com/pmweb/",d=[c,"zh_CN/htmledition/js/",{zh_TW:"wbpm.zh_TW.js",en_US:"wbpm.en_US.js"}[window.MILang]||"wbpm.zh_CN.js","?version=120119"].join(""),c=c+"zh_CN/htmledition/style/wbpm.css?v=120119";MI.user.fun.msgCgiLab&&(b=location.protocol+"//t.qq.com/",d=MI.version.Message,c=MI.version.message);window.PMCMarkTime=+new Date;if(window.PM)a&&a();else{UI.getCss(c,function(){});var e=0;setTimeout(function(){if(!e){var a=MI.Uin(),c="&="+Math.random(),d=window.g_pmcompose_btrace=new Image,g=window.g_pmcompose_invest=new Image;d.onload=d.onerror=function(){window.g_pmcompose_btrace=null};g.onload=g.onerror=function(){window.g_pmcompose_invest=null};MI.user.fun.msgCgiLab||(d.src=b+"cgi-bin/getinvestigate?stat=wbpm&type=pmloginfail&subtype="+a+",8"+c);g.src="http://btrace.qq.com/collect?sIp=&iQQ="+a+"&sBiz=pm&sOp=login&iSta=8&iTy=454&iFlow="+c}},2E3);UI.getScript(d,function(){e=1;a&&a()})}};MI.pmcompose=function(a,b,c,d){var e={type:"compose",to:a,from:b,bostype:d,content:c},f=0;MI.dialog.show({width:570,html:'<div style="width:508px;height:169px;text-align:center;line-height:12;"><img style="margin:0 5px -3px;" src="http://mat1.gtimg.com/www/mb/images/loading.gif"/>加载中...</div>',end:function(){f=1}});MI.loadPM(function(){1!=f&&(f=2,PM.init(e))});return!1};MI.pmembedcompose=function(a){a.type="embedcompose";a.from=5;MI.loadPM(function(){PM.init(a)})};MI.TalkBox.prototype.addFace=function(){var a=this;MI.app({Tmpl:function(){a._faceBox||(a._faceBox=UI.html((new UI.tmplString(MI.tmpl.face))({}))[0],UI.C(a._faceBox,"z-index",9999),a._facePreview=g(a._faceBox,".facePreview")[0],a._faceClose=g(a._faceBox,".close")[0],a._faceArrow=g(a._faceBox,".SA")[0],a._faceTab=g(a._faceBox,".tabStyle3 li"),a._faceCont=g(a._faceBox,".faceBox"),a._facePage=g(a._faceBox,".pages")[0],a._faceList=[],a._faceTabCur=0,UI.append(a._faceBox,document.body),UI.hasClass(document.body,"ipad"),a._pic||UI.hide(a._faceTab[3]),a._faceClose.onclick=function(){a.hideFace();return!1},UI.EA(document.body,"click",function(){a.hideFace()}),UI.EA(a._faceBox,"click",function(a){UI.E(a).stop()}),UI.each(a._faceTab,function(b,c){b.onclick=function(){if(a._faceTabCur!=c){UI.each(a._faceTab,function(a,b){a.innerHTML=c==b?"<b>"+UI.text(a)+"</b>":'<a href="#">'+UI.text(a)+"</a>"});UI.removeClass(a._faceTab[a._faceTabCur],"select");UI.addClass(b,"select");UI.hide(a._faceCont[a._faceTabCur]);UI.show(a._faceCont[c]);a._faceTabCur=c;var d=g(a._faceCont[a._faceTabCur],".subTab1 a");d.length?(UI.each(d,function(b){b.onclick=function(){a._faceList=g(a._faceCont[a._faceTabCur],".faceCell");UI.each(a._faceList,function(a){UI.hide(a)});UI.removeClass(g(this.parentNode,".cur")[0],"cur");UI.addClass(this,"cur");var b=UI.A(this,"page"),c;b&&(b=b.split("|"),c=b[0],b=b[1],a._faceList=a._faceList.splice(c-1,b),a.page.show(1,b));return!1}}),d[0].onclick()):(a._faceList=g(a._faceCont[a._faceTabCur],".faceCell"),a.page.show(1,a._faceList.length))}return!1};UI.isUndefined(a.faceHideTabIndex)||a.faceHideTabIndex[c]&&UI.hide(b)}),a.page=new MI.Page({target:a._facePage,call:function(b){UI.each(a._faceList,function(a){"none"!=UI.C(a,"style")&&UI.hide(a)});UI.show(a._faceList[b-1])},num:3}),UI.each(g(a._faceBox,".faceBox .faceCell a"),function(b,c){b.onclick=function(){var b=this.title,c=UI.A(this,"type")||"",f=c+b;"art"==c&&a.addFaceArt[b]?a.addPic({result:0,msg:_("上传成功"),info:{image:"http://t0.qpic.cn/mblogpic/"+a.addFaceArt[b],fileName:b+".jpg"}}):"en_US"==window.MILang?a.addTopic(" /["+f+"]"):a.addTopic(" /"+f);MI.Bos("btnFaceInsert"+c,f);a.hideFace();return!1};b.onmouseover=function(){var b="face/"+this.className.replace("f",""),e="gif",f=this.parentNode.parentNode,h=UI.A(f,"fold"),m=15;UI.A(f,"index")||(UI.each(g(f,"a"),function(a,b){UI.A(a,"i")||UI.A(a,"i",b+"")}),UI.A(f,"index",1));f=Number(UI.A(this,"i")||c);h&&(b=h+(1+f),UI.A(this,"type",h.split("/")[1]),m=14);"z"==h&&(b="emoji/"+this.className,UI.A(this,"type","z"),e="png",m=15);"/art"!=h&&(a._facePreview.innerHTML='<div><p class="faceImg"><img src="http://mat1.gtimg.com/www/mb/images/'+b+"."+e+'" alt=""></p><p class="faceName">'+this.title+"</p></div>",a._facePreview.style.cssText=7<f%m?"left:12px;":"")};b.onmouseout=function(){UI.hide(a._facePreview)}}));"none"==a._faceBox.style.display?setTimeout(function(){a._faceBox.style.cssText="top:"+(UI.getY(a._face)+UI.height(a._face)-MI.scrollHack(a._face)+4)+"px;left:"+(UI.getX(a._face)-4)+"px";if(a._faceArrow&&UI.text(a._face)){var b=UI.width(a._face);UI.C(a._faceArrow,"left",(16<b?b+16:b)/2+"px")}else UI.hide(a._faceArrow);(b=g(a._faceBox,"a")[0])&&b.focus()},0):a._faceBox.style.cssText="display:none";a.faceSingleTabIndex&&UI.fireEvent(a._faceTab[a.faceSingleTabIndex],"click")}})};MI.TalkBox.prototype.hideFace=function(){this._faceBox&&(UI.hide(this._facePreview),UI.hide(this._faceBox))};(function(){var a={};a[_("年夜饭")]="b90fbff36b7e513fdc32";a[_("恭喜发财")]="d82a45604c6740e23796";a[_("年年有余")]="04968f0a62129fa1242c";a[_("花开富贵")]="01e0936320513214b88e";a[_("2012")]="f260699400457a9f1e3e";a[_("火箭")]="f41cb3c61f6550d3956a";a[_("船票")]="7b984c57b94f166dfe54";a[_("合家欢")]="e30e064caf31e6e3698e";a[_("祝福礼花")]="e941afa4483a62e6fb76";a[_("雪人")]="29b8d2eaec0e269e36b2";a[_("圣诞烟火")]="1c23d4080e30fbb60bd0";a[_("礼物房子")]="23959546ff28c74584ba";a[_("发礼物")]="9c3532623d4c5ef975b6";a[_("圣诞老人")]="7f22468bed15d5aae5a6";a[_("圣诞树")]="c48b7e5b478660f27ec0";a[_("生日蛋糕")]="ed8c7c6c30f5df5e78ce";a[_("下雪")]="869a47be445d7463af96";a[_("婚礼")]="e4aaf9f23078063e7d8a";a[_("我爱你")]="86788bf3dc7277bc3cac";a[_("情书")]="721d0d88eec90c8c2216";a[_("玫瑰花")]="1fce104dc920d0355362";a[_("打电话")]="8f3d82cafd85a27f8e62";a[_("史胖纸")]="fb9d4d9b70073f4245e2";a[_("怪蜀黍")]="429704c34f9ebcb27308";a[_("鲸鱼女宝宝")]="d57486c609f64b92e208";a[_("UFO")]="8cadbe0227828d84d058";a[_("缺乏睡眠的可怜人儿")]="6a4f100d8a7e64e596ce";a[_("假期")]="d2488b94eab71dfe1cc4";a[_("出游")]="9c5d9c3d8cb38363ba78";a[_("小雨")]="b56e68af54b4ed73f090";a[_("海滩")]="c0bd5e2c160c5387329a";a[_("下雨")]="ebb26b4ac0ad5a927e7c";a[_("电话")]="9ff10874ed02e1fdb1c0";a[_("钻戒")]="81324487027d5e37974e";a[_("啤酒")]="522c8bbe9e521d6d4bd6";MI.TalkBox.prototype.addFaceArt=a})();MI.TalkList.prototype.gongyiTips=function(a){var b=this,c="http://gongyi.qq.com/js/wgy/weigy.js?t="+MI.random();UI.getScript(c,function(){a.innerHTML="<div>"+_("筑力计划•微爱参与人数：{0}人次",weigy_weibo_total)+"</div>";UI.show(a);MI.tips.position(b);MI.Bos("btnCheckGongyi")})};MI.TalkList.prototype.levelTips=function(a){var b=this,c={mid:"10243"},d=UI.A(this,"user");d&&(c.u=d);MI.ajax({url:MI.url.medal,data:c,type:"get",success:function(c){c=MI.json(c);0==c.result&&(a.innerHTML="<div>"+c.info.html+"</div>",UI.show(a),MI.tips.position(b),MI.Bos("btnCheckLevel"))}})};MI.TalkList.prototype.urlTips=function(a){function b(b){if(0==b.result){var e=UI.A(c,"reltitle");e&&(b.info.title=e);m=b.info.url;var e={5:/soso\.com/gi},f;for(f in e)e[f].test(m)&&(b.info.safe=f);b.info.title&&2<b.info.safe?(h=MI.string.cut(b.info.title,26),m=MI.string.cut(m,60),l="<br>"):(h=d[b.info.safe-1]||d[0],l="：",m=MI.string.cut(m,80));m=m.breakWord(0);f="";if(1==b.info.safe||2==b.info.safe)f=!UI.B.ie?"":"<a href=\"#\" onclick=\"var a=window.clipboardData.setData('Text',this.previousSibling.value),b=this.nextSibling;UI.hide(this);UI.show(b);b.innerHTML=a?'"+_("复制成功")+"':'"+_("复制失败")+"';return false\">"+_("复制网址")+'</a><a class="cNote" style="display:none;text-decoration:none"></a>',e='<a href="###" class="jubao">'+(1==b.info.safe?_("举报链接"):_("申诉链接"))+"</a>",f='<p class="safeFun"><textarea style="display:none">'+b.info.url+"</textarea>"+f+e+"</p>";a.innerHTML=f+'<div class="safeBox clear"><em class="ico safe_'+(b.info.safe||1)+'"></em><p class="safeType">'+MI.string.html(h)+l+m+"</p></div></div>";UI.show(a);MI.tips.position(c);if(f=g(a,".jubao")[0])f.onclick=function(){var a=UI.parents(c,"msgBox")[0],d,e="",f="";a&&(e=g(a,"a")[0].href,e=MI.string.id(e),d=UI.parent(a));d&&("li"==d.nodeName.toLowerCase()?f=UI.A(d,"id"):(a=g(a,".pubInfo .time")[0])&&(f=MI.string.id(a.href)));jubao_url(f,e,b.info.url,b.info.safe)}}}if("A"==this.nodeName){var c=this,d=[_("原链接"),_("此网址可能含有恶意内容或被大量用户举报，不建议打开原链接"),_("腾讯网"),_("原链接"),_("搜搜")],e=c.href,f=e.match(/[^\/]+$/g)[0].split("?")[0],h="",m="",l="",k,x,q,s;if(!e.hasString("?")){var r=g(UI.parents(c,"msgBox")[0],".time"),o=r.length,t;o&&((t=UI.A(r[o-1],"from"))||(t=""));UI.A(c,"href",(UI.B.ie?" ":"")+e+"?type=1&from=19&u="+MI.user.account+"&s="+t+"&f=1&skey=")}c.title&&(UI.A(c,"reltitle",c.title),c.title="");MI.Tips.url[f]?(b(MI.Tips.url[f]),MI.Bos("btnViewUrl","",0.01)):(k=+new Date,MI.ajax({url:MI.url.urlDetail,type:"get",data:"url="+f,success:function(a){x=+new Date-k;a=MI.json(a);0==a.result&&(b(a),MI.Tips.url[f]=a,MI.Bos("btnViewUrl","",0.01));q=+new Date-k;setTimeout(function(){s=+new Date-k;MI.Speed("t_asyn_url",0.1,x,q,s)},0)}}))}};MI.viewSet=function(a){function b(){MI.dialog.show({title:'<h1 class="DmainTit">'+_("浏览设置")+"</h1>",html:MI.viewSet._body,width:560})}if(MI.user.fun.newViewSet)MI.viewSet._body?b():(MI.viewSet.loading||MI.ajax({type:"post",url:MI.url.viewSet,success:function(a){a=MI.json(a);MI.viewSet._body=UI.html(a.info)[0];var a=MI.viewSet._body,c=g(a,"button");g(a,"input");setTimeout(function(){c[0].focus()},0);c[1].onclick=function(){MI.dialog.hide()};8<g(a,".wqList dd label").length&&(g(a,".wqList dd")[0].style.cssText="height:120px;overflow:auto;");b();MI.app({Validate:function(){UI.remove(j("showModSet"));new MI.Validate({id:"myViewSetting",inputs:{viewModel:{noIco:!0},pageSet:{noIco:!0},faceTrans:{noIco:!0},fb:{noIco:!0},wqIds:{noIco:!0,result:function(a){return j("wqIds").checked?a:""}}},messages:function(a){return UI.next(a)},success:function(){MI.tip(_("保存成功"),function(){document.location.href=document.location.href.replace("pagesetMyhome","")})}})}});MI.viewSet.loading=0;MI.Bos("btnViewSet")},fail:function(){MI.viewSet.loading=0}}),MI.viewSet.loading=1);else{UI.css(".showModSet{width:340px}");var a=j(a),c=g(a,"button"),d=g(a,"input");MI.dialog.show({title:'<h1 class="DmainTit">'+_("浏览设置")+"</h1>",html:a,width:380});setTimeout(function(){c[0].focus()},0);MI.Bos("btnViewSet");c[0].onclick=function(){var a=UI.parseUrl(),b=[];UI.each(d,function(b){b.checked&&(a[UI.A(b,"name")]=b.value)});for(var c in a)b.push(c+"="+(a[c]||""));document.location.href=document.location.pathname+"?"+b.join("&")};c[1].onclick=function(){MI.dialog.hide()}}};MI.navMenu=function(){function a(a){var b=c(this);k[b]||(UI.append(l[b],d[b]),k[b]=1);e==b&&clearTimeout(h);f=setTimeout(function(){UI.addClass(d[b],"hover");UI.show(l[b]);e=b},100);UI.E(a).stop()}function b(a){var b=c(this);clearTimeout(f);h=setTimeout(function(){UI.removeClass(d[b],"hover");UI.hide(l[b])},200);UI.E(a).stop()}function c(a){var b=a.className.split(" ")[0];"subNav"==b&&(b=a.parentNode.className.split(" ")[0]);return b}var d=j("nav"),e,f,h,m=MI.user.account;if(d){var d={app:g(d,".app")[0],topic:g(d,".topic")[0]},l={app:UI.html('<div class="subNav"><p><a href="http://t.qq.com/app/qzblog/'+m+'" onmousedown="MI.Bos(\'btnTopMenuAppBlog\')">'+_("日志")+"</a></p><p"+(1==MI.user.fun.app?"":' style="display:none"')+'><a href="http://t.qq.com/app/qzphoto/'+m+'" onmousedown="MI.Bos(\'btnTopMenuAppPhoto\')">'+_("相册")+'</a></p><p><a href="http://t.qq.com/app/music/'+m+'" onmousedown="MI.Bos(\'btnTopMenuAppMusic\')">'+_("音乐")+'</a></p><p><a href="http://tv.t.qq.com/index.php" target="_blank" onmousedown="MI.Bos(\'btnTopMenuAppTV\')">'+_("微电视")+'</a></p><p><a href="http://fm.t.qq.com/fm" target="_blank" onmousedown="MI.Bos(\'btnTopMenuAppFM\')">'+_("微电台")+'</a></p><p><a href="http://e.t.qq.com/weikongjian" target="_blank" onmousedown="MI.Bos(\'btnTopMenuAppKongjian\')">'+_("微空间")+'</a></p><p class="last"><a href="http://app.t.qq.com" onmousedown="MI.Bos(\'btnTopMenuAppChannel\')">'+_("应用频道")+'</a></p><p class="last" style="display:none"><a href="http://open.t.qq.com/apps/appslist.php" >'+_("我的应用")+"</a></p></div>")[0],topic:UI.html('<div class="subNav"><p><a href="http://t.qq.com/p/topic" onmousedown="MI.Bos(\'btnTopMenuTopicHot\')">'+_("热议")+'</a></p><p class="last"><a href="http://t.qq.com/p/event" onmousedown="MI.Bos(\'btnTopMenuTopicActive\')">'+_("活动")+"</a></p></div>")[0]},k={app:0,topic:0};UI.each(l,function(c,e){d[e]&&(UI.hide(c),c.onmouseover=d[e].onmouseover=a,c.onmouseout=d[e].onmouseout=b)})}else(function(){var a=g(document.body,".headWrap")[0];g(a,".apps");var b=g(a,".right .topNavItem")[0],c=g(a,".right .topNavItem")[1],d=j("searchKey"),e=g(a,".tSearchNew")[0];if(a){MI.Bos("usingNewNavNow",0,0.01);UI.B.ie6?a.style.setExpression("top","eval((document.documentElement||document.body).scrollTop) + 'px'"):UI.B.os5&&UI.B.iphone&&UI.B.qq&&(a.style.position="absolute");var f=function(){var a=g(this,".topNavSub")[0],b=g(this,".txt")[0];UI.hide(a);UI.removeClass(b,"active")},h=function(){var a=g(this,".topNavSub")[0],b=g(this,".txt")[0];UI.show(a);UI.addClass(b,"active")};UI.each([c,b],function(a){if(a)if(UI.B.ipad){if(a=g(a,"a")[0])a.onclick=function(){return!1}}else a.onmouseout=f,a.onmouseover=h});d&&(UI.EA(d,"blur",function(){UI.removeClass(e,"active")}),UI.EA(d,"focus",function(){UI.addClass(e,"active")}));setTimeout(function(){var a=g(document.body,".topNav a"),b=document.location.href,a={home:{element:a[0],pathname:["t.qq.com/"+MI.user.account]},news:{element:a[1],pathname:["/p/news","/p/city","/p/top","/college_anas.php","/c/"]},qun:{element:a[2],pathname:["qun.t.qq.com"]},people:{element:a[3],pathname:"/people,/potential.php,/rank.php,/lists.php,/list2.php,/find/friends.php,/find/interest.php".split(",")},app:{element:a[4],pathname:["app.t.qq.com","t.qq.com/app"]},client:{element:a[7],pathname:["/client.php"]}};for(name in a)for(str in a[name].pathname)if(a[name].pathname.hasOwnProperty(str)&&RegExp(a[name].pathname[str]).test(b)){UI.addClass(a[name].element,"active");break}},10);(function(){var a=g(document.body,".apps a")[0];a&&new MI.DropBox({target:a,dir:2,start:1,className:"topNavSub",url:MI.url.htmlContent,data:{type:1},add:'<p class="right"><a href="http://app.t.qq.com/" target="_blank">'+_("应用频道")+'<span class="ffsong">&gt;&gt;</span></a></p><p class="left"><a href="http://app.t.qq.com/?g=2" target="_blank">'+_("进入我的应用")+"</a></p>",html:null,dataFilter:function(a){return a.replace(/\{account\}/g,MI.user.account||"")},domHandler:function(a){a=UI.GT(a,"li");1!=MI.user.fun.app&&UI.hide(a[1])}});(a=g(document.body,".headWrap .groups a")[0])&&new MI.DropBox({htmlStr:'<div style="display:none; width:310px; position: absolute;"><br /><br /><br /><br /></div>',target:a,dir:2,start:1,className:"topNavSub lay_topdrop_qun",url:MI.url.topNavGroup,html:null,defaultHTML:'<div class="lay_topdrop_inner clear"><p class="desc">你还没有加入微群，现在就去<a href="http://qun.t.qq.com/" onmousedown="MI.Bos(\'btnNewMenuGroupIndex0\')">微群广场</a>逛逛吧。</p></div>'})})();var m=j("nav_pub_wrap"),l,k,v="option_nav_publish_"+MI.user.account,p=function(){l||(l=UI.html('<div class="nav_pub_box"><div class="talkBox">\t<div class="sendCnt"><div class="cntBox">\t<textarea id="msgTxt" accesskey="u" name="content" autocomplete="off" tabindex="1"></textarea></div><div class="insertFun clear">\t<div class="sendList insertFace"><a class="txt" href="#" title="'+_("表情")+'" tabindex="3"><em class="sico ico_face"></em></a></div>\t<div class="sendList newTopic"><a href="#" class="creatNew txt" title="'+_("汇聚相同热点的广播")+'"><em class="sico ico_topic"></em>'+_("话题")+'</a></div>\t<div class="sendList atSome"><a class="txt" href="#" title="'+_("@朋友帐号就可以提到他")+'"><em class="sico ico_at"></em>'+_("朋友")+'</a></div>\t<div class="sendList newFeel"><a class="txt" sign="" title="'+_("心情")+'" href="#"><em class="sico ico_feel"></em>'+_("心情")+'</a></div></div>\t</div>\t<div class="sendFun">'+MI.html.button(_("广播"),"gb_btn1","sendBtn")+'<span class="countTxt c_tx5">'+_("还能输入{0}字","<em>140</em>")+"</span></div></div></div>")[0],UI.append(l,m),UI.EA(document.body,"click",function(a){a=UI.E(a).target;!UI.parents(a,"nav_pub_wrap")[0]&&!UI.parents(a,"atWrap")[0]&&UI.removeClass(m,"nav_pub_acitve")}),k=new MI.TalkBox(l,{feelTip:0,data:{},successStart:function(){MI.isS&&MI.S(v,"1");setTimeout(function(){UI.removeClass(m,"nav_pub_acitve")},2E3);MI.Bos("btnNewMenuPubBoxSuccess")}}));setTimeout(function(){UI.hasClass(m,"nav_pub_acitve")&&k&&k.focus()},0)};m&&!UI.B.ipad&&(a=g(m,".nav_pub_tips")[0],MI.isS&&1==MI.S(v)&&UI.hide(a),a=g(m,"a")[0],a.onclick=function(a){UI.toggleClass(m,"nav_pub_acitve");p();UI.E(a).stop();MI.Bos("btnNewMenuPubBox");return!1},UI.B.ie6&&MI.addHover(null),UI.show(m))}})();setTimeout(function(){if(MI.user.account&&(!MI.newCountShow||document.location.href.hasString("/k/")||document.location.href.hasString("/search/")))MI.newCount&&MI.newCount((MI.user.fun.relayFilter?"14":"4")+",2,1,20,19")},0);MI.searchKey();MI.themeSet()};MI.homeTab=function(){var a=j("home_myfriends_top");a&&g(a,".btn_ldrop")[0]&&new MI.NewListDrop({tab:UI.GT(a,"a")[0],className:"listDrop",listData:[{listId:null,listName:MI.currQQType||"QQ群",href:MI.currQQHref||"http://t.qq.com/ilist/qqqun"}],bos:"btnQQFriendDropView"});MI.subTabToggle()};MI.searchKey=function(a){var b=j("searchKey"),c;if(b){c=b.previousSibling;var d="http://t.qq.com/search/index.php";a&&(d="http://1.t.qq.com/search/message.php");var e=UI.hasClass(b.parentNode.parentNode,"tSearchNew")?1:0;MI.searchKeyBox=new MI.SmartBox("searchKey",function(){j("searchForm").submit();j("searchForm").action=d},"",{left:e?-3:-8,top:UI.B.ie?4:6,width:e?172:202,type:1,history:1,isnano:a});c.onmouseup=function(){b.focus()}}};MI.themeSet=function(){var a=j("setTheme");if(a&&(a.onclick=function(){var a=this,c="/"+MI.user.account;if(document.location.pathname!=c)return document.location.href="http://t.qq.com"+c+"?setTheme=1",!1;MI.talkBox&&setTimeout(function(){MI.talkBox._txt.blur()},1E3);UI.A(a,"loaded")?MI.Theme.show():MI.app({Theme:function(){MI.Theme.build();UI.A(a,"loaded",1)}});MI.Bos("btnThemeSetOpen");return!1},void 0!=UI.parseUrl().setTheme))a.onclick()};MI.MayBeKnow=function(){function a(){MI.MayBeKnow.returnResult=0;(new Date).getDay();MI.user.fun.showRecommend&&MI.ajax({url:MI.url.recommend,data:{scene:2,count:18},type:"get",success:function(a){a=MI.json(a);0==a.result&&a.info.list&&a.info.list.length&&(t=a=a.info,3<=a.list.length&&(MI.MayBeKnow.returnResult=1,b(t)))}})}function b(b){if(!l){l=UI.html(MI.tmpl.know)[0];k=g(l,".tjRelaList")[0];x=g(l,".cSign")[0];q=g(l,".change")[0];r=g(l,".closebtn")[0];s=g(l,".left a")[2];if(!j("talkBox"))return;UI.after(l,j("talkBox"));UI.hide("homeBannerTip");UI.hide("NewGuideBannerTip");q.onclick=function(b){MI.feedBack({name:"timeline",iPos:11,iBak1:9,id:1191});var c=g(".tjRelaList li");if(6<=c.length){for(var d=[],e=0;3>e;e++)UI.remove(c[e]);for(e=3;6>e;e++){UI.show(c[e]);var f=UI.A(c[e],"uin")+"."+UI.A(c[e],"reason");d.push(f)}MI.feedBack({name:"timeline",iPos:11,iBak1:1,sBak2:d.join(","),id:1191});(b||window.event)&&MI.Bos("btnRefreshMayBeKnow")}else a();return!1};r.onclick=e;s.onclick=d}x.innerHTML=0<b.newNum?_("新来(+{0})",b.newNum):"";c()}function c(a){for(var b=[],c=t,d=0;d<c.list.length;d++)c.list[d].added||(b.push(c.list[d]),c.list[d].added=!0);k.innerHTML=f(b);m();(a||window.event)&&MI.Bos("btnRefreshMayBeKnow");return!1}function d(){MI.feedBack({name:"timeline",iPos:11,iBak1:10,id:1191})}function e(){MI.Bos("btnTimeineClose");MI.feedBack({name:"timeline",iPos:11,iBak1:14,id:1191});UI.hide(l);UI.cookie("mb_mayBeEveryday",1,1);MI.user.fun.showRecommend=0;UI.show("NewGuideBannerTip");UI.show("homeBannerTip");MI.bannerTips();return!1}function f(a){var b="";UI.each(a,function(a,c){var d=(a.bkname||a.nick).toTitle()+"(@"+(a.chName||a.name)+")",e="/"+a.account,f=MI.string.cut(a.bkName||a.nick,14,"");b+='<li account="'+a.account+'"'+(c>=o?'style="display:none"':"")+' uin="'+a.uin+'" reason="'+a.reason_type+'"><div class="userPic">';b+='<a title="'+d+'" href="'+e+'" target="_blank">';b+='<img onerror="MI.Pic(this,50)" src="'+(a.avatar?a.avatar+"/50":"http://mat1.gtimg.com/www/mb/images/head_50.jpg")+'" /></a>';b+=a.isNew?'<em class="sign_new">'+_("新")+"</em>":"";b+='</div><div class="knownInfo">';b+='<p><a class="uname" title="'+d+'" href="'+e+'" target="_blank">'+f+"</a>"+(!0==a.vip?'<a href="http://t.qq.com/certification" target="_blank" class="vip" title="腾讯认证"></a>':"")+"</p>";b+='<p class="middle">'+a.reason+"<p>";b+='<p class="attentBox" account="'+a.account+'"><input type="button" class="addAttention" value="'+_("收听")+'">';b+='<a href="#" class="delAttention" style="display:none">'+_("取消")+"</a>"+(a.isFollower?a.isFollower:"")+"</p>";b+='<a href="#" class="del" title="'+_("不再推荐此人")+'">×</a>';b+="</div></li>"});return b}function h(a){UI.animate(a,"opacity",0,function(){UI.remove(a);for(var b=0,d=g(k,"li"),e=0;e<d.length;++e){if(b>=o){b=UI.A(d[b-1],"uin")+"."+UI.A(d[b-1],"reason");MI.feedBack({name:"timeline",iPos:11,iBak1:1,sBak2:b,id:1191});break}UI.show(d[e]);b++}d.length<o&&c()})}function m(){UI.each(g(k,".attentBox"),function(a){var b=UI.A(a,"account"),c=g(a,".addAttention")[0],d=g(a,".delAttention")[0],e=UI.A(UI.parents(a)[1],"uin")+"."+UI.A(UI.parents(a)[1],"reason");c.onclick=function(f){UI.E(f).prevent();MI.follow(b,this,function(){UI.show(d);UI.hide(c);c.className="addAttention";MI.Bos("btnFollowMayBeKnow")});MI.feedBack({name:"timeline",iPos:11,iBak1:3,sBak2:e,id:1191});var g=UI.parents(a)[1];setTimeout(function(){h(g)},1E3)};d.onclick=function(a){UI.E(a).prevent();MI.follow(b,this,function(){UI.show(c);UI.hide(d);d.className="delAttention";MI.Bos("btnUnFollowMayBeKnow")});MI.feedBack({name:"timeline",iPos:11,iBak1:8,sBak2:e,id:1191})}});UI.each(g(k,".del"),function(a){a.onclick=function(){var b=UI.parents(a)[1],c=UI.A(b,"account"),d=UI.A(b,"uin")+"."+UI.A(b,"reason");setTimeout(function(){h(b)},500);MI.feedBack({name:"timeline",iPos:11,iBak1:6,sBak2:d,id:1191});MI.ajax({url:MI.url.recommendBlock,data:{id:c},success:function(){}});return!1}});var a=g(k,"li"),b=[];UI.each(a,function(a){a.onmouseover=function(){UI.addClass(a,"hover")};a.onmouseout=function(){UI.removeClass(a,"hover")};var c=UI.A(a,"uin")+"."+UI.A(a,"reason");g(a,".userPic a")[0].onclick=function(){MI.feedBack({name:"timeline",iPos:11,iBak1:2,sBak2:c,id:1191})};g(a,".uname")[0].onclick=function(){MI.feedBack({name:"timeline",iPos:11,iBak1:5,sBak2:c,id:1191})};"none"!=a.style.display&&b.push(c)});MI.feedBack({name:"timeline",iPos:11,iBak1:1,sBak2:b.join(","),id:1191});MI.Card.build(k,".userPic img",2);MI.Card.build(l,".knownInfo .uname",2);MI.Card.build(l,".knownInfo .middle a",2)}var l,k,x,q,s,r,o=3,t;j("followingNum")&&parseInt(j("followingNum").innerHTML);return{getData:a}}();MI.listDrop=function(a){this._id=a.id;this.ctrlHtml=['<a href="http://qun.t.qq.com/create.php">'+_("创建")+'</a>|<a href="http://qun.t.qq.com/">'+_("微群广场")+"</a>",'<a href="http://t.qq.com/lists.php">'+_("广场")+'</a>|<a href="#" class="creatList" onclick="MI.viewListHide&&MI.viewListHide();MI.List.add();MI.Bos(\'btnListViewAdd\');return false">'+_("创建")+'</a>|<a href="http://t.qq.com/list_mine.php" onclick="MI.Bos(\'btnListViewAdmin\')">'+_("管理")+"</a>",""][a.type];this._html='<div class="listDrop" style="display:none;"><div class="ldList"><a href="#" class="ld_btn pageUp" title="'+_("向上滚动")+'" style="display:none"><em></em></a><div class="ldListBox"><ul></ul></div><a href="#" class="ld_btn pageDown" title="'+_("向下滚动")+'" style="display:none"><em></em></a></div>'+(this.ctrlHtml?'<p class="ctrlBar">'+this.ctrlHtml+"</p>":"")+"</div>";this._listDropBtn=j(a.id);this._selectedBtn=this._arrow=null;this._body=UI.html(this._html)[0];this._pageUp=g(this._body,".pageUp")[0];this._pageDown=g(this._body,".pageDown")[0];this._addList=g(this._body,".creatList")[0];this._listUl=g(this._body,".ldListBox ul")[0];this.delay={};this.liHeight=19;this._type=a.type;this._tab=a.tab;this._dataUrl=a.url;this.data=a.data||"";this.current=a.current;this._bos=a.bos;this.build()};MI.listDrop.box={};MI.listDrop.build=function(a){var a=g(a||".homeTab a"),b={home_mygroup_top:{type:0,url:MI.url.qunList,current:null,bos:j("headWrap")?"btnGroupView":"btnGroupViewNew",tab:_("我的微群")},home_mylist_top:{type:1,url:MI.url.allMyList,current:MI.listDrop.current,bos:"btnListView",tab:_("我的名单")},fav_myfav_top:{type:2,url:MI.url.favGroup,data:{op:4,type:1},current:MI.favCurrent,bos:"btnFavView",tab:_("更多")}};a&&UI.each(a,function(a){var d=a.parentNode.id;if(d&&b[d]&&(g(a,".btn_ldrop")[0]||g(a,".btn_drop")[0])&&!MI.listDrop.box[d])b[d].id=d,MI.listDrop.box[d]=new MI.listDrop(b[d])})};MI.listDrop.prototype={listId:{},call:null,isLab:1,load:function(a){var b=this;UI.addClass(b._listUl,a);if(b.listId[a]&&b._listUl.innerHTML)b.show(b.listId[a]);else{MI.app({List:null});var c,d,e,f;c=+new Date;MI.ajax({url:b._dataUrl,data:b.data,success:function(h){d=+new Date-c;h=MI.json(h);0==h.result&&(b.listId[a]=h,b.show(h));e=+new Date-c;setTimeout(function(){f=+new Date-c;MI.Speed("t_asyn_mylist",1,d,e,f)},0)}})}},show:function(a){var b=this;b._listUl.innerHTML=a.info;1==b._type&&(b._addList.style.display=a.canCreate?"":"none");UI.addClass(b._listDropBtn,"select");UI.hasClass(b._arrow,"btn_drop")?UI.addClass(b._arrow.parentNode,"hover"):UI.addClass(b._arrow,"lopen");UI.show(b._body);b.pos();b.page(0);a=g(b._listUl,"a");b.current&&(UI.each(a,function(a){UI.A(a,"href").hasString(b.current)&&(UI.C(a,"color","#ccc"),UI.C(a,"backgroundColor","#fff"),UI.C(a,"cursor","default"),a.onclick=function(){return!1})}),1==b._type&&UI.prepend(UI.html('<li class="select"><a title="'+b._tab+'" style="color:#333">'+b._tab+"</a></li>")[0],b._listUl));b.call&&b.call();MI.Bos(b._bos);try{a[0].focus()}catch(c){}},hide:function(){var a=this;a.delay.hide=setTimeout(function(){UI.hide(a._body);UI.hasClass(a._arrow,"btn_drop")||UI.removeClass(a._arrow,"lopen");a._listDropBtn!=a._selectedBtn&&(UI.removeClass(a._listDropBtn,"select"),UI.hasClass(a._arrow,"btn_drop")&&UI.removeClass(a._arrow.parentNode,"hover"));a.hideCall&&a.hideCall()},200)},pos:function(){var a=this._listDropBtn,b,c;this._body.style.left=UI.getX(a)+"px";this._body.style.top=UI.getY(a)+UI.height(a)+"px";this._listUl.style.height="auto";c=UI.height(this._body);a=UI.windowHeight()+UI.scrollY()-UI.getY(a)-(this.isLab?65:40);210>a&&(a=210);!UI.hasClass(document.body,"ipad")&&c>a&&(b=UI.height(g(this._listUl,"a")[0]),this._listUl.style.cssText+=";overflow:hidden;height:"+b*(a/b-1)+"px");this.liHeight=b},build:function(){var a=this,b=UI.GT(a._listDropBtn,"a")[0];a._arrow=UI.GT(a._listDropBtn,"em")[0];a._selectedBtn=g(a._listDropBtn.parentNode,".select")[0];UI.append(a._body,document.body);b.onmouseover=function(){a.beforeShow(this.parentNode.id);a.mouseover&&a.mouseover()};b.onmouseout=a._body.onmouseout=function(){a.hide();clearTimeout(a.delay.load)};a._body.onmouseover=function(){a.mouseover&&a.mouseover();clearTimeout(a.delay.hide)};1==a._type&&(b.onclick=function(){a.beforeShow(this.parentNode.id);return!1});a.pageEvent()},beforeShow:function(a){var b=this;clearTimeout(b.delay.hide);clearTimeout(b.delay.load);b.delay.load=setTimeout(function(){b.load(a)},100)},pageEvent:function(){var a=this,b=a._pageUp,c=a._pageDown,d=a.liHeight;b.onmousedown=function(){a.page(-d);a.delay.page=setInterval(function(){a.page(-d)},100);return!1};c.onmousedown=function(){a.page(d);a.delay.page=setInterval(function(){a.page(d)},100);return!1};b.onclick=c.onclick=b.onmouseup=c.onmouseup=function(){clearInterval(a.delay.page);return!1};b=function(b){b=UI.E(b);1==b.wheel?a.page(-d):a.page(d);b.prevent()};UI.EA(a._listUl.parentNode.parentNode,"mousewheel",b);UI.B.ie||(a._listUl.parentNode.parentNode.onmousewheel=b)},page:function(a){var b=UI.height(this._listUl),c=this._listUl.scrollHeight,a=this._listUl.scrollTop+a||0;this._listUl.scrollTop=a;0<this._listUl.scrollTop?UI.show(this._pageUp):(UI.hide(this._pageUp),clearInterval(this.delay.page));b+a<c?UI.show(this._pageDown):(UI.hide(this._pageDown),clearInterval(this.delay.page))}};MI.NewListDrop=function(a){var b=this;this.refresh=a.refresh;this.url=a.url;this._tab=a.tab;this.current=a.current;this.listData=a.listData||[];this.linkEvent=a.linkEvent;this.showEvent=a.showEvent;this.hideEvent=a.hideEvent;this.ctrlHtml=a.ctrlHtml||"";this.className=a.className||"";this.bos=a.bos;this.clickTrigger=a.clickTrigger;this.delay={};this._tab.onmouseover=function(){b.startLoad()};this._tab.onmouseout=function(){b.cancelLoad()};this.clickTrigger&&(this._tab.onclick=function(){b.startLoad()})};MI.NewListDrop.prototype={startLoad:function(){var a=this;clearTimeout(a.delay.hide);clearTimeout(a.delay.load);a.delay.load=setTimeout(function(){a.load()},100);a.bos&&MI.Bos(a.bos);return!1},load:function(a){var b=this;b.listData&&b.listData.length?b.show():MI.ajax({url:b.url,data:{u:MI.user.account},success:function(c){c=MI.json(c);a&&a(c);0==c.result&&(b.listData=c.info.list,c.info.list.length&&b.show())}})},cancelLoad:function(){this.hide();clearTimeout(this.delay.load);this.delay.load=-1},show:function(){if(0>this.delay.load)return!1;this.builded||this.build();this.showEvent&&this.showEvent(this);this.refresh&&this.creatList();UI.show(this._body);UI.addClass(this._tabParent,"select");UI.addClass(this._arrow,"lopen");this.setPos();this.page(0);try{this.firstLink.focus()}catch(a){}},build:function(){var a=this;a.wrapHtml='<div class="'+a.className+'" style="position:absolute;z-index:99999;display:none;"><div class="ldList"><a href="#" class="ld_btn pageUp" title="'+_("向上滚动")+'" style="display:none"><em></em></a><div class="ldListBox"><ul></ul></div><a href="#" class="ld_btn pageDown" title="'+_("向下滚动")+'" style="display:none"><em></em></a></div>'+(a.ctrlHtml||"")+"</div>";a._body=UI.html(a.wrapHtml)[0];a._pageUp=g(a._body,".pageUp")[0];a._pageDown=g(a._body,".pageDown")[0];a._listUl=g(a._body,".ldListBox ul")[0];a._arrow=UI.GT(a._tab,"em")[0];a._tabParent=a._tab.parentNode;a.isSelected=UI.hasClass(a._tabParent,"select");a.creatList();UI.append(a._body,document.body);a._body.onmouseout=function(){a.cancelLoad()};a._body.onmouseover=function(){clearTimeout(a.delay.hide)};a.builded=1;a.pageEvent()},creatList:function(){var a=this,b="";UI.each(a.listData,function(c){b+=a.current&&a.current==c.listId?'<li class="on"><a style="cursor:default">'+c.listName+"</a></li>":'<li><a href="'+(c.href||"javascript:void(0)")+'" title="'+c.listName+'" listid="'+c.listId+'">'+c.listName+"</a></li>"});a._listUl.innerHTML=b;UI.each(g(a._listUl,"li a"),function(b,d){0==d&&(a.firstLink=b);if(UI.hasClass(b.parentNode,"on"))return!1;a.linkEvent&&(b.onclick=function(){a.hide();a.linkEvent.call(b,a);a.current=UI.A(b,"listid");return!1})})},hide:function(){var a=this;a.delay.hide=setTimeout(function(){if(!a.builded)return!1;UI.hide(a._body);UI.removeClass(a._arrow,"lopen");a.isSelected||UI.removeClass(a._tabParent,"select");a.hideEvent&&a.hideEvent(a)},200)},setPos:function(){var a,b,c;this._body.style.left=UI.getX(this._tab.parentNode)+"px";this._body.style.top=UI.getY(this._tab)+UI.height(this._tab)+"px";this._listUl.style.height="auto";this.liHeight=a=UI.height(this.firstLink);b=UI.height(this._body);c=UI.windowHeight()+UI.scrollY()-UI.getY(this._tab)-(this.isLab?65:40);!UI.hasClass(document.body,"ipad")&&b>c&&(this._listUl.style.cssText="overflow:hidden;height:"+a*Math.floor(c/a)+"px")},pageEvent:function(){var a=this,b=a._pageUp,c=a._pageDown;b.onmousedown=function(){a.page(-17);a.delay.page=setInterval(function(){a.page(-17)},100);return!1};c.onmousedown=function(){a.page(17);a.delay.page=setInterval(function(){a.page(17)},100);return!1};b.onclick=c.onclick=b.onmouseup=c.onmouseup=function(){clearInterval(a.delay.page);return!1};b=function(b){b=UI.E(b);1==b.wheel?a.page(-17):a.page(17);b.prevent()};UI.EA(a._listUl.parentNode.parentNode,"mousewheel",b);UI.B.ie||(a._listUl.parentNode.parentNode.onmousewheel=b)},page:function(a){var b=UI.height(this._listUl),c=this._listUl.scrollHeight,a=this._listUl.scrollTop+a||0;this._listUl.scrollTop=a;0<this._listUl.scrollTop?UI.show(this._pageUp):(UI.hide(this._pageUp),clearInterval(this.delay.page));b+a<c?UI.show(this._pageDown):(UI.hide(this._pageDown),clearInterval(this.delay.page))}};MI.badge={appended:0,delay:0,build:function(){var a=this;MI.user.account&&(a.badges=g(".ico_badge"),UI.each(a.badges,function(b){UI.A(b,"rel")&&(b.onmouseover=function(){var b=this;clearTimeout(a.delay);a.delay=setTimeout(function(){a.show(b)},200)},b.onmouseout=function(){clearTimeout(a.delay);a.delay=setTimeout(function(){a.hide()},200)})}))},show:function(a){var b=this,c="",d=UI.A(a,"rel"),e=UI.A(a,"isSet"),f=UI.A(a,"user");b.appended||(b._body=UI.html('<div class="badgeTips"><div class="SA" style="position:absolute"><em>◆</em><span>◆</span></div><div class="badgeCnt"></div></div>')[0],b._cont=g(b._body,".badgeCnt")[0],b._arrow=g(b._body,".SA")[0],UI.hide(b._body),UI.append(b._body,document.body),b.appended=1,b._body.onmouseover=function(){clearTimeout(b.delay);UI.show(this)},b._body.onmouseout=function(){b.delay=setTimeout(function(){b.hide()},200)});d&&(c+="mid="+d+"&");e&&(c+="isSet=1&");f&&(c+="u="+f+"&");UI.hide(b._body);b.cache[d]?b.position(a,b.cache[d]):MI.ajax({url:MI.url.medal,type:"get",data:c,success:function(c){c=MI.json(c);0==c.result&&(b.cache[d]=c,b.position(a,c))}})},hide:function(){UI.hide(this._body)},position:function(a,b){var c=UI.getY(a),d=UI.getX(this.badges[0]),e=UI.getX(a),f=0;2==MI.hostType&&(f=160);a.title="";this._body.style.cssText="top:"+c+"px;left:"+(d+f)+"px;";this._arrow.style.margin="0 0 0 "+(e-d-f)+"px";this._cont.innerHTML=b.info.html},cache:{}};MI.autoMore=function(){function a(){MI.talkList.moreTimes<b&&700>UI.pageHeight()-UI.scrollY()-UI.windowHeight()&&MI.talkList.more(1);MI.talkList.moreTimes>=b&&(MI.user.fun.autoMoreContinue||UI.ER(window,"scroll",c),UI.show("pageSetLink"))}var b=2,c=function(){clearTimeout(void 0);setTimeout(a,200)};UI.EA(window,"scroll",c)};MI.linkBoss=function(){setTimeout(function(){var a=g("#UIn a,.SM a,.mobileBox a,.proposal a"),b=g("#hotTopic li"),c=g(".topMenu a"),d=g(".topNav a");UI.each(a,function(a,b){UI.EA(a,"mousedown",function(){0!=d.length&&(7==b||11==b||13==b||16==b)?MI.Bos("btnNewMenuSide"+b):MI.Bos("btnSide"+b)});a.onmousemove=function(){UI.A(this,"hideFocus","true");this.onmousemove=null}});UI.each(b,function(a,b){a.onmousedown=function(){var a=g(this,"a")[0];a&&(a=a.getAttribute("href",2).replace(/http:\/\/t.qq.com/g,""),MI.Bos({name:"btnHotTopicList",iBak1:b,sBak1:a,id:1158}),MI.Bos("btnHotTopicList",a.replace(/\/k\//g,"")))}});UI.each(c,function(a,b){UI.EA(a,"mousedown",function(){MI.Bos("btnTopMenu_"+(b+1))})});UI.each(d,function(a,b){UI.EA(a,"mousedown",function(){MI.Bos("btnTopNewMenu_"+(b+1))})})},2E3)};MI.sFollow=function(a,b,c){var d=UI.hasClass(b,"foLight")?0:1;b.sending||(MI.ajax({url:MI.url.sFollow,data:{u:a,op:d},success:function(a){a=MI.json(a);0==a.result?(d?(UI.addClass(b,"foLight"),b.title=MI.sFollowTip[1]):(UI.removeClass(b,"foLight"),b.title=MI.sFollowTip[0]),c&&c(d)):MI.alert(a.msg);b.sending=0}}),b.sending=1)};MI.Note={_body:null,_user:null,_target:null,title:"",account:"",updateClassName:".AL .msgBox .userName a,.AL .msgBox .msgCnt a",updateName:function(a,b){var c=a+"(@"+(this.chName||this.account)+")";UI.each(g(MI.Note.updateClassName),function(d){d.title==b?(d.innerHTML=a,d.title=c):UI.A(d,"rel")==b&&(d.innerHTML=a,UI.A(d,"rel",c))});this.title=c},add:function(a,b){var c=this;c.nick=UI.A(a,"nick")||"";c.account=UI.A(a,"account")||"";c.chName=UI.A(a,"chName")||"";c.note=UI.A(a,"note")||"";c.call=b;c.title=(c.note||c.nick)+"(@"+(c.chName||c.account)+")";c._body||(c._body=UI.html('<div class="Dnick"><form action="'+MI.url.bkName+'" method="post" id="addNoteForm" onsubmit="return false">\t<h4>'+_("对<b></b>添加备注")+'：</h4>\t<span><input name="u" id="u" value="" type="hidden"><input name="op" id="op" value="0" type="hidden"></span><b></b>\t<div class="funBox"><input name="bk" id="bk" type="text" class="inputTxt" value="'+c.note+'"><button type="submit" class="btn1">'+_("保存")+'</button></div>\t<div class="error">&nbsp;</div></form>\t</div>')[0],c._user=g(c._body,"b")[0],MI.app({Validate:function(){setTimeout(function(){new MI.Validate({id:"addNoteForm",inputs:{bk:{noIco:!0,rule:function(a){var b=a.length;a.split("");if(a.match(/[^\u4e00-\u9fa5\w-\s]/g))return _("仅支持中文、字母、数字、下划线或减号");if(12<b)return _("仅支持{0}个中文、字母、数字、下划线或减号","1-12")}},u:{noIco:!0},op:{noIco:!0}},messages:function(a){return UI.next(a.parentNode)},success:function(a){setTimeout(function(){MI.tip(_("添加成功"))},0);var b=j("bk").value;if(c.call)a.bkname=b,c.call(a);else if(a=c._target.parentNode.parentNode,UI.hasClass(a,"nickFun")&&(b?UI.addClass(a,"nickFunDis"):UI.removeClass(a,"nickFunDis")),c._target.innerHTML=b||_("添加备注"),UI.A(c._target,"note",b),a=MI.Card.users[c.account])a.bkname=b;c.updateName(b||c.nick,c.title);MI.S("time",0)}})},100)}}));c._target=a;c._user.innerHTML=c.nick;MI.dialog.show({title:"",width:290,html:c._body,start:function(){j("u").value=c.account;j("bk").value=c.note;MI.focus(j("bk"))}});MI.Bos("btnNoteAdd")}};MI.black=function(a){var b,c=UI.hasClass(a.target,"blackDel")?1:0;b=c?"un":"";var d=c?MI.url.unblock:MI.url.block,e=[_("拉黑名单"),_("取消拉黑")];MI.black[b+"black"]||(MI.black[b+"black"]=UI.html((new UI.tmplString(MI.tmpl[b+"black"]))(a))[0]);MI.dialog.show({width:420,html:MI.black[b+"black"]});a.txt=UI.isUndefined(a.txt)?1:a.txt;UI.isArray(a.txt)&&(e=a.txt);b=g(MI.black[b+"black"],"input")[0];try{b.focus()}catch(f){}b.onclick=function(){var b=this;b.sending||(MI.ajax({url:d,data:{u:a.u,r:MI.random()},success:function(d){d=MI.json(d);0==d.result?(a.txt&&(a.target.innerHTML="<b></b>"+(c?e[0]:e[1])),c?UI.removeClass(a.target,"blackDel"):UI.addClass(a.target,"blackDel"),MI.dialog.hide(),a.call&&a.call(c)):MI.alert(d.msg);b.sending=0}}),b.sending=1)}};MI.confirm=function(a){a&&(a.type="success"==a.type?"s":"e",a.title=a.title||"",a.content=a.content||"",a.confirmTxt=a.confirmTxt||_("确定"),a.cancelTxt=a.cancelTxt||_("取消"),a.width=a.width||330,MI.confirm.html&&(UI.remove(MI.confirm.html),MI.confirm.html=null),MI.confirm.html=UI.html('<div class="blackTip" style="width:'+a.width+'px"><h2><span class="ico_tsW"><span class="ico_t'+a.type+'"></span></span>'+a.title+"</h2><p>"+a.content+'</p><p><input type="button" value="'+a.confirmTxt+'" id="__confirmBtn__" /><input type="button" value="'+a.cancelTxt+'" id="__cancelBtn__" /></p></div>')[0],MI.dialog.show({html:MI.confirm.html,width:a.width+80}),a.confirm&&(j("__confirmBtn__").onclick=a.confirm),j("__cancelBtn__").onclick=function(){MI.dialog.hide();a.cancel&&a.cancel.apply(this)},setTimeout(function(){j("__confirmBtn__").focus()},100))};MI.TalkList.prototype.levelTips=function(a){var b=this,c={mid:"10243"},d=UI.A(this,"user");d&&(c.u=d);MI.ajax({url:MI.url.medal,data:c,type:"get",success:function(c){c=MI.json(c);0==c.result&&(a.innerHTML="<div>"+c.info.html+"</div>",UI.show(a),MI.tips.position(b),MI.Bos("btnCheckLevel"))}})};MI.Flash={version:0,getObject:function(a,b,c,d,e){b="<object "+(e?'id="'+e+'"':"")+' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+c+'" height="'+d+'" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0"><param name="allowScriptAccess" value="always" /><param name="movie" value="'+b+'" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><param value="langVer='+window.MILang+'" name="FlashVars" /><embed '+(e?'name="'+e+'"':"")+' src="'+b+'" width="'+c+'" height="'+d+'" quality="high" wmode="transparent" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" allowScriptAccess="always" FlashVars="langVer='+window.MILang+'" type="application/x-shockwave-flash"/></object>';if(a)a.innerHTML=b;else return b},getVersion:function(){var a="0",b=navigator,c;if(this.version)return this.version;if(b.plugins&&b.plugins.length)UI.each(b.plugins,function(b){b.name.hasString("Shockwave Flash")&&(c=parseFloat(b.description.split("Shockwave Flash")[1]),a=Math.max(c,a))});else if(window.ActiveXObject)for(b=7;13>b;b++)try{var d=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+b+"');");d&&(a=d.GetVariable("$version").split("WIN")[1].replace(/\,/g,"."))}catch(e){}return this.version=parseFloat(a)},updateTip:function(a){var b=this.getVersion();if(UI.B.ipad)return'<div class="flashVersion"><p>你的系统不支持Flash,不能使用此功能</p></div>';a='<div class="flashVersion"><p>'+(b?_("你当前的FlashPlayer播放器版本是{0}，<br>低于此功能所需版本{1}",b,a||""):_("你的系统中没有安装FlashPlayer播放器"));a+=_("，请更新播放器版本后再试");return a+='</p><p><a target="_blank" href="http://get.adobe.com/cn/flashplayer/">'+_("点此链接下载最新版")+"</a></p></div>"}};MI.SmartBox=function(a,b,c,d){if(a&&UI.isString(a)){if(this._key=j(a),!this._key)return}else if(UI.isElement(a))this._key=a;else return!1;var e=this,f;this._callback=b?b:null;this.url=MI.url.smartBox;this._type=c?c:"";this._fix=UI.B.ie?[0,0]:[1,2];this.param="key=%key%";this._valTip=!!d.type;this._query=MI.guest?UI.html('<span><input type="hidden" id="label" name="label" value="8" /><input type="hidden" id="uname" name="uname" value='+MI.guest.user+"></span>")[0]:UI.html('<span><input type="hidden" id="label" name="label" value="8" /><input type="hidden" id="poster" name="poster" value="2" /></span>')[0];this._queryAll=UI.html('<input type="hidden" class="pos" name="pos"/>')[0];this._queryQun=UI.html('<input type="hidden" id="from" name="from" value="smart" />')[0];this._style=d?d:{left:0,top:0,width:306};this._pos={x:UI.getX(this._key),y:UI.getY(this._key)};a=null;this._form=a=this._key.parentNode;this._select=UI.html('<div class="smartBox" style="display:none"></div>')[0];this._ldrop=g("#searchForm .btn_ldrop")[0];this._list=[];this.s=[];this._isBoss=0;e._form&&(UI.hasClass(e._form.parentNode,"tSearchNew")?e._isBoss=1:UI.hasClass(e._form.parentNode,"tSearch")&&(e._isBoss=2));UI.append(this._select,document.body);this._key.blur();1==e._style.history&&e._ldrop&&(e._ldrop.onclick=function(a){e._form&&(1==e._isBoss?MI.Bos("btnClickHistoryNew"):2==e._isBoss&&MI.Bos("btnClickHistoryOld"));UI.E(a).stop();clearTimeout(f);UI.hasClass(e._ldrop,"lopen")?(MI.focus(e._key),UI.removeClass(e._ldrop,"lopen")):(e.getHistory(),UI.addClass(e._ldrop,"lopen"));return!1});this._tip=this._key.previousSibling;this.tip=this._tip&&"LABEL"==this._tip.nodeName;this.tip&&(this._key.value&&UI.hide(this._tip),this._tip.onclick=function(){e._key.focus()},this._style.isnano||(13==MI.boss?e._tip.innerHTML=_("搜我的广播/搜全站"):MI.guest&&(e._tip.innerHTML=_(MI.string.sprintf("搜%s的广播/搜全站",MI.guest.sex)))));UI.EA(document.body,"click",function(){e.hide()});UI.EA(this._key,"focus",function(){e.tip&&UI.hide(e._tip);e.isDisplay||e.hide();e.getMsg(e._key.value)});UI.EA(this._key,"blur",function(a){var b=UI.E(a).target;e.tip&&!b.value&&UI.show(e._tip);f=setTimeout(function(){e.hide()},500);if(e._style.onblur&&UI.isFunction(e._style.onblur))e._style.onblur(a)});this._key.onbeforeeditfocus=function(){e.isDisplay||e.hide()};this._key.onclick=function(a){UI.E(a).stop();if(e._style.onclick&&UI.isFunction(e._style.onclick))e._style.onclick(a)};this._key.onkeydown=function(a){var b=UI.E(a);if(e.isDisplay)if(40==b.key||38==b.key){null!=e._form&&(e._form.action="http://t.qq.com/search/index.php",e._style.isnano&&(e._form.action="http://1.t.qq.com/search/message.php"));38==b.key?e.index=0>e.index-1?e.indexMax:e.index-1:40==b.key&&(e.index=e.index+1>e.indexMax?0:e.index+1);if(e._valTip){e.removePara();for(var b=g(e._key.parentNode,".pos")[0],c=0,d=e._list.length;c<d;c++)UI.removeClass(e._list[c],"on");UI.hasClass(e._list[e.index],"special")||UI.hasClass(e._list[e.index],"speak")?(UI.hasClass(e._list[e.index],"special")?(UI.after(e._query,e._key),UI.A(g(e._key.parentNode,".pos")[0],"value","173")):UI.A(b,"value","179"),this.value=UI.text(g(e._select,"span")[0])):UI.hasClass(e._list[e.index],"searchUser")?(UI.A(b,"value","176"),this.value=UI.text(g(e._select,"span")[0]),null!=e._form&&(e._form.action="http://t.qq.com/search/user.php",e._style.isnano&&(e._form.action="http://1.t.qq.com/search/user.php"))):UI.hasClass(e._list[e.index],"searchQun")?(UI.A(b,"value","178"),UI.after(e._queryQun,e._key),this.value=UI.text(g(e._select,"span")[0]),null!=e._form&&(e._form.action="http://t.qq.com/search/qun.php")):UI.hasClass(e._list[e.index],"qunGet")||UI.hasClass(e._list[e.index],"userGet")?(UI.A(b,"value","0"),b=UI.A(e._list[e.index],"name"),c=UI.A(e._list[e.index],"value"),d=c.indexOf("<a"),this.value=-1==d?c:c.substring(0,d),UI.hasClass(e._list[e.index],"qunGet")?null!=e._form&&(e._form.action="http://qun.t.qq.com/"+b+"?from=smart"):UI.hasClass(e._list[e.index],"userGet")&&null!=e._form&&(e._form.action="http://t.qq.com/"+b,e._style.isnano&&(e._form.action="http://1.t.qq.com/"+b))):(UI.A(b,"value","174"),this.value="DT"==e._list[e.index].nodeName?UI.text(g(e._list[e.index],"span")[0]):UI.text(e._list[e.index]))}else this.value=UI.text(e._list[e.index]);e.select(e.index)}else{if(13==b.key||27==b.key)27==b.key?e.hide():e.select()}else UI.trim(this.value)&&(0<e._list.length&&(40==b.key||38==b.key)?e.show():e.getMsg(this.value));if(e._style.onkeydown&&UI.isFunction(e._style.onkeydown))return e._style.onkeydown(a,e)};this._key.onkeyup=function(a){a=UI.E(a);13==a.key&&e._form&&(1==e._isBoss?MI.Bos("btnSubmitSearchNew"):2==e._isBoss&&MI.Bos("btnSubmitSearchOld"));40==a.key||38==a.key||13==a.key&&""==this.value||27==a.key||e.getMsg(this.value)}};MI.SmartBox.prototype={lastOrigin:null,isDisplay:!1,timer:null,index:-1,indexMax:0,cache:[],hide:function(){this._ldrop&&UI.removeClass(this._ldrop,"lopen");UI.hide(this._select);this.isDisplay=!1},show:function(){MI.user.fun.search&&(this.resize(),UI.show(this._select),this.isDisplay=!0)},select:function(a){this.index=a;this._list[this.index]&&UI.addClass(this._list[this.index],"on");this.lastOrigin&&UI.removeClass(this.lastOrigin,"on");this.lastOrigin=this._list[this.index]},resize:function(){this._pos={x:UI.getX(this._key),y:UI.getY(this._key)};this._select.style.width=this._style.width+"px";this._select.style.left=this._pos.x+this._style.left+this._fix[0]+"px";this._select.style.top=this._pos.y+this._key.offsetHeight+this._style.top-this._fix[1]+"px"},removePara:function(){var a=this,b=j("pos");b&&UI.remove(b);(b=g(this._key.parentNode,"input"))&&UI.each(b,function(b){UI.A(b,"name")&&"pos"==UI.A(b,"name")&&a._valTip&&UI.remove(b)});UI.after(this._queryAll,this._key)},getMsg:function(a){var b=this;if(UI.trim(a)){var c=this.param.replace(/\%key\%/g,encodeURIComponent(a)),a=MI.string.html(a);this.timer&&clearTimeout(this.timer);if("music"==this._type)this.timer=window.setTimeout(function(){UI.getScript(b.url+"?"+c)},150);else{var d=UI.A(b._key,"id");b.cache[a]&&b.cache[a][d]?b.buildDom(b.cache[a][d],a):this.timer=window.setTimeout(function(){MI.ajax({url:b.url,type:"get",data:c,success:function(c){c=MI.json(c);b.cache[a]=[];b.cache[a][d]=c;b.buildDom(c,a)}})},150)}}else b.hide()},buildDom:function(a,b){var c=this;if(0==a.result){c.s=[];var d=0,e=0,f=0,h=0,m='<dt class="speak">'+(13==MI.boss||7==MI.boss?_("搜全站广播："):_("搜广播："))+'<span index="0" value="'+b+'" class="cSign">'+b+"</span></dt>",l='<dt class="special">'+_("搜我的广播：")+'<span index="1" value="'+b+'" class="cSign">'+b+"</span></dt>",k;MI.guest&&(k=_(MI.string.sprintf("搜%s的广播: ",MI.guest.sex)),k='<dt class="special">'+k+'<span class="cSign" index="1" value="'+b+'">'+b+"</span></dt>");var e='<dt class="searchUser">'+_("搜用户：")+'<span class="cSign" index="1" value="'+b+'">'+b+"</span></dt>",j='<dt class="searchQun">'+_("搜微群：")+'<span class="cSign" index="1" value="'+b+'">'+b+"</span></dt>";c.s.push(c._valTip?'<dl class="s1">':"");a.info.user&&"group"!==c._type?(c.s.push(c._valTip?e:""),e=a.info.user.length,0!=e&&(c.s.push(c._valTip?'<dd><ul class="uList">':""),UI.each(a.info.user,function(a){c.s.push(c._valTip?'<li class="userGet" value="'+a.nick+'" name="'+a.account+'"><div class="userPic"><img src="'+a.src+'"></div><div class="userInfo"><span class="userName">'+a.nick+'</span><span class="userId">@'+a.account+"</span></div></li>":"")}),c.s.push(c._valTip?"</ul></dd>":""))):e=-1;!c._style.isnano&&a.info.qun&&(c.s.push(c._valTip?j:""),f=a.info.qun.length,0!=f?(c.s.push(c._valTip?'<dd><ul class="uList">':""),UI.each(a.info.qun,function(a){c.s.push(c._valTip?'<li class="qunGet" value="'+a.nick+'" name="'+a.id+'"><div class="userPic"><img src="'+a.src+'"></div><div class="userInfo"><span class="userName">'+a.nick+'</span><span class="userId">'+_("成员")+a.num+_("人")+"</span></div></li>":"")}),c.s.push(c._valTip?"</ul></dd>":""),f+=1):f=1);j=[];j=a.info.msg?a.info.msg:a.info;if(0!=j.length&&"group"!==c._type){if(h=j.length,c.index=-1,c.s.push(c._valTip?m+"<dd><ul>":"<ul>"),UI.each(j,function(a,b){c.s.push('<li value="'+a+'" index="'+(parseInt(b)+1)+'">'+a+"</li>")}),c.s.push(c._valTip?"</ul></dd>":"</ul>"),d=h+1,13==MI.boss||7==MI.boss)MI.guest?c.s.push(c._valTip?k:""):c.s.push(c._valTip?l:""),d=h+2}else 0==j.length&&"group"!==c._type&&(c._valTip?13==MI.boss||7==MI.boss?(c.indexMax=2,MI.guest?c.s.push(m+k):c.s.push(m+l),d=2):(c.indexMax=1,c.s.push(m),d=1):c.hide());c.s.push(c._valTip?"</dl>":"");c.indexMax=c._valTip?d+e+f:h-1;if(2!=c.s.length){c._select.innerHTML=c.s.join("");(c._valTip||!c._valTip&&""!=c._select.innerHTML)&&c.show();c._list=g(c._select,"li");null==c._list&&(c._list=[]);if(c._valTip){a.info.user&&g(c._select,".searchUser")[0]&&c._list.unshift(g(c._select,".searchUser")[0]);!c._style.isnano&&a.info.qun&&c._list.splice(e+1,0,g(c._select,".searchQun")[0]);g(c._select,".speak")[0]&&c._list.splice(e+f+1,0,g(c._select,".speak")[0]);if(13==MI.boss||7==MI.boss)(d=g(c._select,".special")[0])&&c._list.push(d);UI.EA(c._select,"mousedown",function(a){a=UI.E(a).target;c.removePara();var b=g(c._key.parentNode,".pos")[0];b||(b=UI.html('<input type="hidden" class="pos" name="pos" value="">')[0],UI.after(b,c._key),b=g(c._key.parentNode,".pos")[0]);UI.hasClass(a,"special")?(UI.A(b,"value","173"),UI.after(c._query,c._key)):UI.hasClass(a,"searchUser")?UI.A(b,"value","176"):UI.hasClass(a,"searchQun")?(UI.A(b,"value","178"),UI.after(c._queryQun,c._key)):UI.hasClass(a,"speak")&&UI.A(b,"value","179")})}UI.each(c._list,function(a){a.onmouseover=function(){for(var a=0,b=c._list.length;a<b;a++)UI.removeClass(c._list[a],"on");UI.addClass(this,"on")};a.onclick=function(){if(UI.hasClass(a,"userGet")){var b=UI.A(a,"name");document.location=c._style.isnano?"http://1.t.qq.com/"+b:"http://t.qq.com/"+b}else UI.hasClass(a,"qunGet")?(b=UI.A(a,"name"),document.location="http://qun.t.qq.com/"+b+"?from=smart"):(c._key.value="DT"==this.nodeName?UI.text(g(this,"span")[0]):UI.text(this),c._key.value&&c._tip&&"LABEL"==c._tip.nodeName&&UI.hide(c._tip),UI.A(c._key,"index",UI.A(this,"index")),"DT"!=this.nodeName&&c._valTip&&(c.removePara(),UI.A(g(c._key.parentNode,".pos")[0],"value","174")),c.submit(a))}})}}else c.hide()},submit:function(a){null!=this._form&&(this._form.action="http://t.qq.com/search/index.php",this._style.isnano&&(this._form.action="http://1.t.qq.com/search/message.php"));this._callback&&(a&&UI.hasClass(a,"searchUser")?null!=this._form&&(this._form.action="http://t.qq.com/search/user.php",this._style.isnano&&(this._form.action="http://1.t.qq.com/search/user.php")):a&&UI.hasClass(a,"searchQun")&&null!=this._form&&(this._form.action="http://t.qq.com/search/qun.php"),this._callback());this._form&&(1==this._isBoss?MI.Bos("btnSubmitSearchNew"):2==this._isBoss&&MI.Bos("btnSubmitSearchOld"))},getHistory:function(){var a=this;this.timer&&clearTimeout(this.timer);this.timer=window.setTimeout(function(){MI.ajax({url:MI.url.searchList,type:"post",success:function(b){b=MI.json(b);a.bulidList(b)}})},50)},bulidList:function(a){var b=this;if(0==a.result)if(a.info){var c=[],d=a.info.length;b.indexMax=1==b._style.history?d-1:d;b.index=-1;var e=0;c.push("<ul>");UI.each(a.info,function(b,d){c.push('<li value="'+b+'" index="'+(parseInt(d)+1)+'" class="">'+(1==a.stat[e]?'<b class="ico_rss"></b>':'<b class="ico_his"></b>')+"<span>"+b+"</span></li>");e++});c.push("</ul>");2!=c.length&&(b._select.innerHTML=c.join(""),b.show(),b._list=g(b._select,"li"),UI.each(b._list,function(a){a.onmouseover=function(){for(var a=0,c=b._list.length;a<c;a++)UI.removeClass(b._list[a],"on");UI.addClass(this,"on")};a.onclick=function(){b._key.value="DT"==this.nodeName?UI.text(g(this,"span")[0]):UI.text(this);UI.A(b._key,"index",UI.A(this,"index"));b._key.value&&b._tip&&"LABEL"==b._tip.nodeName&&UI.hide(b._tip);b.submit()}}))}else b.hide();else b.hide()}};MI.AutoCmt=function(a){function b(a){UI.E(a);clearTimeout(f.delay);f.delay=setTimeout(function(){c()},150)}function c(){var a,b,c,h;b=f._target.value;if(0<f.clicks)f.clicks--;else if(f.cursorX=MI.cursorX(f._target),document.selection&&document.selection.createRange().text==MI.TalkBox.prototype.txtTopic.slice(1,-1)?(f.cursorXHack=6,f.cursorX-=f.cursorXHack):f.cursorXHack=0,b=b.replace(/\r/g,""),a=b.slice(0,f.cursorX).replace(/＠/,"@"),!f.key&&a.match(/^@/)?(f.filter="@",a=a.replace(/^@/,"")):f.filter="",b=b.slice(f.cursorX),c=a.slice(-1),f.word=f.key?a.match(/@[^\s@\n\r]{0,64}$/g):a.match(/[^\s\n\r]{0,64}\S$/g),f.text=a,f.topic&&"#"==c&&0!=a.match(/#/g).length%2){b=MI.json(MI.S("option_topic_"+MI.user.account));c=[];var j=0;f.creatDom();f._txt.innerHTML=f.key?f.shadowText(a):"";for(h in b)a=decodeURI(h).slice(1,-1),c.push('<li title="'+a+'"'+(j?"":' class="on"')+"><span>"+MI.string.cut(a,20,"")+"</span></li>"),j++;j&&(f._body.style.cssText="",f._cont.style.cssText="",UI.hide(f._all),UI.hide(f._search),UI.hide(f._tips),UI.show(f._key),f._key.innerHTML="<ul>"+c.join("")+"</ul>",f.list=g(f._key,"li"),UI.each(f.list,function(a,b){a.onclick=d;a.onmouseover=e;a.index=b}),f.index=0,f.indexMax=f.list.length-1,UI.show(f._body),f.display=0,f.position(),f.display=1);f.selectType=1;f.model=0}else f.word?(f.word=f.word[0],h=f.word.length,1<h&&(a=a.slice(0,-h+1)),f.selectType=0,f.model=0,UI.show(f._tips),f._txt.innerHTML=f.key?f.shadowText(a):"",f._txtEnd.innerHTML=f.shadowText(b),f.creatDom(function(){UI.EA(window,"beforeunload",function(){var a="top_"+MI.user.account;if(MI.isS){var b=[],c;for(c in MI.users)b.push(c+":"+MI.users[c]);MI.S(a,"{"+b.join(",")+"}")}})}),f.getData()):1!=f.model&&(clearTimeout(f.delay),f.hide())}function d(a){a=UI.E(a);f.select(a);f.clickCall&&f.clickCall(this)}function e(){null==f.index&&(f.index=0);UI.removeClass(f.list[f.index],"on");UI.addClass(this,"on");f.index=this.index}var f=this;f._target=a.target;f.key=a.key;f.call=a.call;f.clickCall=a.clickCall;f.type=a.type||0;f.align=a.align||"left";f.topic=a.topic||0;f.face=a.face||0;f.tips=UI.isUndefined(a.tips)?1:a.tips;f.moreName=a.moreName||0;f.minWidth=a.minWidth;f.maxWidth=a.maxWidth;var h="atSearch_"+MI.random();f._body=UI.html('<div class="atWrap" style="display:none"><div class="musicTab" style="display:none"><div class="atSearch"><label for="'+h+'">'+_("输入名字/帐号")+'</label><input id="'+h+'" type="text" class="inputTxt"><span class="atbtn"><input type="button" class="btn_search2"><a href="#" class="del" title="'+_("清空")+'"></a></span></div><a href="#" class="close" title="'+_("关闭")+'"></a></div><div class="autoCmt" style="display:none"><div class="autoCmtAll"></div><div class="autoCmtKey"></div></div><div class="tips" style="display:none">'+(UI.isString(f.tips)?f.tips:_("@朋友帐号,他就能在[提到我的]页收到"))+"</div>\t</div>")[0];f._shadow=UI.html('<div class="txtShadow"><span></span><b>|</b><span></span></div>')[0];UI.after(f._shadow,a.target);f._txt=f._shadow.firstChild;f._cursor=f._txt.nextSibling;f._txtEnd=f._shadow.lastChild;UI.B.ie&&UI.before(UI.html('<b style="display:none;width:0;overflow:hidden"></b>')[0],a.target);UI.EA(a.target,"keydown",function(a){a=UI.E(a);f.keyEvent(a)});UI.EA(document.body,"click",function(){f.hide()});UI.EA(a.target,"keyup",b);UI.EA(a.target,"focus",b);UI.EA(a.target,"mouseup",b)};MI.AutoCmt.prototype={_body:0,_search:0,_cont:0,_all:0,_key:0,_tips:0,max:1E3,maxCss:"height:220px;overflow-y:scroll;overflow-x:hidden;",allList:0,keyList:0,list:0,listTmpl:"",display:0,clicks:0,index:0,filter:"",cursorX:0,cursorXHack:0,shadowText:function(a){return a.replace(/\r\n|\n/g,"<br>").replace(/ /g,"&nbsp;")},tips:1,creatDom:function(a){var b=this;b._body.appended||(UI.append(b._body,document.body),b._body.appended=1);b._cont||(b._search=g(b._body,".musicTab")[0],b._input=g(b._body,".inputTxt")[0],b._btn=g(b._body,".btn_search2")[0],b._close=g(b._body,".close")[0],b._del=g(b._body,".del")[0],b._cont=g(b._body,".autoCmt")[0],b._all=g(b._body,".autoCmtAll")[0],b._key=g(b._body,".autoCmtKey")[0],b.tips&&(b._tips=g(b._body,".tips")[0],UI.show(b._tips)),b._close.onclick=function(){b.hide();MI.Bos("btnAutoAtClose");return!1},b._btn.onclick=function(){MI.focus(b._input)},b._del.onclick=function(a){b._input.value="";b._input.focus();b._input.onkeyup(a);UI.show(b._btn);MI.Bos("btnAutoAtDel");return!1},b._input.onkeyup=b._input.onfocus=function(a){var a=UI.E(a),d=UI.trim(this.value).replace(/^@/g,"");!(38==a.key||37==a.key||39==a.key||40==a.key||13==a.key)&&MI[b.usersStorageKey]&&b.show(MI[b.usersStorageKey],MI[b.usersStorageKeyPY],1);d?UI.hide(b._btn):UI.show(b._btn);UI.hide(UI.prev(this));UI.A(this,"focused",1)},b._input.onblur=function(){UI.trim(this.value)||(UI.show(UI.prev(this)),UI.show(b._btn));UI.A(this,"focused","")},b._input.onkeydown=function(a){b.keyEvent(a)},b._body.onclick=function(a){1==b.model&&UI.E(a).stop()});a&&a()},keyEvent:function(a){var b=UI.E(a);if(this.display&&UI.isNumber(this.index))if(40==b.key||38==b.key)UI.removeClass(this.list[this.index],"on"),38==b.key?this.index--:40==b.key&&this.index++,0>this.index?this.index=this.indexMax:this.index>this.indexMax&&(this.index=0),UI.addClass(this.list[this.index],"on"),this._cont.scrollTop=22*(this.index-4),this.clicks=1,clearTimeout(this.delay),b.prevent();else if(13==b.key||27==b.key)27==b.key?this.hide():1==this.model&&UI.isNumber(this.index)&&this.list[this.index]?(this.cursorX=MI.cursorX(this._target),this.list[this.index].onclick(a)):this.select(b),this.clicks=1,clearTimeout(this.delay),b.prevent()},selectType:0,select:function(a){MI.TalkBox.cur&&MI.TalkBox.cur._txt==this._target&&MI.TalkBox.cur.guideTextRemove();if(0==this.selectType){if(UI.isNumber(this.index)&&this.list[this.index]){var b=this._target.scrollTop,c=this.list[this.index].txt,d;MI.selectTxt(this._target,this.cursorX,this.cursorX,this.cursorX);this.word?this.key?MI.insertTxt(this._target,c+" ",this.cursorX,this.word.slice(1).length):MI.insertTxt(this._target,c+" ",this.cursorX,this.word.length):MI.insertTxt(this._target,"@"+c+" ",this.cursorX,0);d=MI.users[c];MI.users[c]=d?d+1:1;!this.key&&1!=this.moreName&&(this._target.value=this.filter+c);this.call&&this.call(a);this._target.scrollTop=b;MI.Bos("btnAutoAtAccount"+(this.model?this.model:""),0,this.model?0.01:0)}}else 1==this.selectType&&(c="#"+this.list[this.index].title+"#",a=this.cursorX,b=1,UI.B.ie||(this._target.value=this._target.value.replace(MI.TalkBox.prototype.txtTopic,"#")),this.cursorXHack&&(b=this.cursorXHack,MI.selectTxt(this._target,a+b-1,a+b+1)),MI.insertTxt(this._target,c,a,b),this.cursorXHack&&(c=a+c.length-1,MI.selectTxt(this._target,c,c)),MI.Bos("btnAutoAddTopic"));0==this.model&&this.hide()},getData:function(a){function b(a){var b={info:{}},c={};if(UI.isArray(a.info))for(var d=0;d<a.info.length;++d)b.info[a.info[d][0]]=a.info[d][1],a.info[d][2]&&(c[a.info[d][0]]=[a.info[d][2].toLowerCase(),MI.MatchPY.whole2sim(a.info[d][2])]);else b=a;return[b,c]}var c=this,d="follow_"+c.type+"_"+MI.user.account,e="top_"+MI.user.account,f=d+"_PY",g=MI.S(d),m=MI.S(e);c.usersStorageKey=d;c.usersStorageKeyPY=f;if(MI.isS)if(m||MI.S(e,"{}"),MI.users||(MI.users=MI.json(MI.S(e)),c.sort()),!MI[d]&&!c.sending&&(!g||432E5<(new Date).getTime()-MI.S("time")||-1==g.indexOf("]]}"))||!MI.S("time")){c.sending=1;var l,k,j,q;l=+new Date;MI.ajax({url:MI.url.at,type:"get",data:"user="+MI.user.account+"&type="+(c.type?c.type:0)+"&num="+(UI.B.ie?750:2E3),success:function(e){k=+new Date-l;var g=MI.json(e);0==g.result&&(MI.S(d,e),MI.S("time",(new Date).getTime()),e=b(g),MI[d]=e[0],MI[f]=e[1],c.show(MI[d],MI[f]),a&&a());c.sending=0;j=+new Date-l;setTimeout(function(){q=+new Date-l;MI.Speed("t_asyn_nicktips",1,k,j,q)},0)}})}else MI[d]||(e=b(MI.json(g)),MI[d]=e[0],MI[f]=e[1]),c.show(MI[d],MI[f]),a&&a()},model:0,showAll:function(a){function b(){UI.show(c._search);UI.show(c._all);UI.show(c._tips);UI.hide(c._key);UI.show(c._btn);c._body.style.cssText="top:"+(UI.getY(a)+UI.height(a)+3-MI.scrollHack(a))+"px;left:"+(UI.getX(a)-1)+"px";c._input.value="";c._input.blur();c._input.focus();c.display=1;c.selectType=0;c.model=1}var c=this;c.creatDom();if(""==c._all.innerHTML||!MI.S("time"))c.word="",c.getData(function(){b()});b()},show:function(a,b,c){function d(a){a=UI.E(a);h.select(a);h.clickCall&&h.clickCall(this)}function e(){null==h.index&&(h.index=0);UI.removeClass(h.list[h.index],"on");UI.addClass(this,"on");h.index=this.index;h.mouseHoverCall&&h.mouseHoverCall(this)}function f(){h.mouseOutCall&&h.mouseOutCall(this)}var b=b||{},h=this,m=function(a){return"<b>"+a+"</b>"};c||UI.hide(h._search);h.listEvent=function(a){var b=1==a,c=b?"allList":"keyList";h[c]=g(h[b?"_all":"_key"],"li");UI.each(h[c],function(a,b){a.onclick=d;a.onmouseover=e;a.onmouseout=f;a.txt=y[b];a.index=b});h.list=h[c];h.display=0;h.index=0;h.indexMax=h.list.length-1;UI.addClass(h.list[0],"on");h.showCall&&h.showCall(a)};var l=[],k=0,j=c?UI.trim(h._input.value.replace(/^@/g,"")):h.key?h.word.slice(1):h.word,q=MI.string.escapeReg(j),s=RegExp("(^"+q+")","i"),r=RegExp("("+q+")","ig"),o,t,w;t=c?50:10;var z=0,y=[],u={},v={},p=a.info;if(j){for(var i in p){if(k>=h.max)break;if(p[i]&&(i.match(s)||p[i].match(s))){o=i.replace(s,m);var n=p[i].replace(s,m);l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':""));h.listTmpl&&(v[i]=[p[i],o,n]);y.push(i);u[i]=1;k++}z++}if(MI.TransformST){if(o=MI.TransformST.toggle(q),t=RegExp("(^"+o+")","i"),w=RegExp("("+o+")","ig"),o!=q)for(i in p){if(k>=h.max)break;if(p[i]&&(i.match(t)||p[i].match(t)))o=i.replace(s,m),n=p[i].replace(s,m),l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':"")),h.listTmpl&&(v[i]=[p[i],o,n]),y.push(i),u[i]=1,k++;z++}}else MI.app({TransformST:function(){h.show(a,b,c)}});if(k<h.max)for(i in t=j.toLowerCase(),p){if(k>=h.max)break;if(b[i]&&!u[i]){if(n=MI.MatchPY.sim(b[i][1],t))o=i,n=p[i].substring(0,n[0])+"<b>"+p[i].substring(n[0],n[0]+n[1])+"</b>"+p[i].substring(n[0]+n[1]),l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':"")),h.listTmpl&&(v[i]=[p[i],o,n]),y.push(i),u[i]=1,k++;z++}}if(k<h.max)for(i in t=j.toLowerCase(),p){if(k>=h.max)break;if(b[i]&&!u[i]){if(n=MI.MatchPY.whole(b[i][0],t))o=i,n=p[i].substring(0,n[0])+"<b>"+p[i].substring(n[0],n[0]+n[1])+"</b>"+p[i].substring(n[0]+n[1]),l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':"")),h.listTmpl&&(v[i]=[p[i],o,n]),y.push(i),u[i]=1,k++;z++}}if(k<h.max){for(i in p){if(k>=h.max)break;if(p[i]&&(i.slice(1).match(r)||p[i].slice(1).match(r))&&!u[i])o=i.replace(r,m),n=p[i].replace(r,m),l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':"")),h.listTmpl&&(v[i]=[p[i],o,n]),y.push(i),u[i]=1,k++;z++}if(w&&w!=r)for(i in p){if(k>=h.max)break;if(p[i]&&(i.slice(1).match(w)||p[i].slice(1).match(w))&&!u[i])o=i.replace(w,m),n=p[i].replace(w,m),l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':"")),h.listTmpl&&(v[i]=[p[i],o,n]),y.push(i),u[i]=1,k++;z++}}}else if(MI.usersArr&&MI.usersArr.length){h.sort();i=0;for(m=MI.usersArr.length;i<m&&!(i>=t);i++){r=MI.usersArr[i].account;if(w=a.info[r])o=r,n=w,l.push(w+" ("+r+")"),k++,h.listTmpl&&(v[r]=[w,o,n]),y.push(r),u[r]=1}}else"@"==h.word&&(h._body.appended||(UI.append(h._body,document.body),h._body.appended=1),h._txt.innerHTML=h.key?h.shadowText(h.text):"",h._body.style.cssText="",h.list=g(h._body,"li"),h.index=0,h.display=0,h.position(),h.display=1);if(!j&&c)for(i in p){if(k>=h.max)break;u[i]||(o=i,n=p[i],l.push(n+" ("+o+")"+("*"==i.substr(0,1)?'<em class="ico_qGroup"></em>':"")),h.listTmpl&&(v[i]=[p[i],o,n]),y.push(i),u[i]=1,k++);z++}10<k?(h._cont.style.cssText=h.maxCss,h._cont.scrollTop=0):h._cont.style.cssText="";c||(h._body.style.cssText="");l=h.listTmpl?(new UI.tmplString(h.listTmpl))({data:v}):"<ul><li><span>"+l.join("</span></li><li><span>")+"</span></li></ul>";k||(l="");if(!j&&!h.allList&&c)h._all.innerHTML=l;else if(j||!c)h._key.innerHTML=l;UI.removeClass(h.list[h.index],"on");!j&&c?(UI.hide(h._key),UI.show(h._all),h.listEvent(1),h.allList&&10<h.allList.length&&(h._cont.style.cssText=h.maxCss)):(UI.show(h._key),UI.hide(h._all),h.listEvent(2));k||(UI.hide(h._cont),j&&!c&&UI.hide(h._body));c||h.position();h.display=1},hide:function(){this.display&&(UI.hide(this._body),UI.removeClass(this.list[this.index],"on"),this.index=null,this.model=0)},position:function(){var a,b,c,d;this.display||(d=UI.windowWidth(),c=UI.width(this._body),this.key?(a=UI.getX(this._cursor)-12,b=UI.getY(this._cursor)-this._target.scrollTop-MI.scrollHack(this._cursor)+26):(a=UI.getX(this._target),b=UI.getY(this._target)+UI.height(this._target)-1),this.minWidth&&c<=this.minWidth&&(this._body.style.width=this.minWidth+"px"),this.maxWidth&&c>this.maxWidth&&(this._body.style.width=this.maxWidth+"px"),"right"==this.align&&(a-=c-UI.width(this._target)),"top"==this.align&&(b=UI.getY(this._target)-UI.height(this._body)),b=";top:"+b+"px;left:"+a+"px;",0>d-(c+a)&&(b+="left:auto;right:0;"),this._body.style.cssText+=b)},sort:function(){delete MI.usersArr;var a=[],b;for(b in MI.users)a.push({account:b,count:MI.users[b]});MI.usersArr=a.sort(function(a,b){return b.count-a.count})}};MI.MatchPY={sp:"|",sim:function(a,b){var c=a.indexOf(b);return-1==c?null:[c,b.length]},whole:function(a,b){var c=a.split(this.sp),d=c.join(""),e=c.length;if(1==e)return d==b?[0,1]:null;for(var f=0;f<e;++f){if(this.startsWith(d,b))return[f,this.len(c,f,b)];d=d.substring(c[f].length)}return null},whole2sim:function(a){for(var a=a.split(this.sp),b="",c=0;c<a.length;++c)b+=a[c].charAt(0)||"?";return b.toLowerCase()},len:function(a,b,c){for(var c=c.length,d=0,e=a.length,f=b;f<e;++f){d+=a[f].length;if(c==d)return f-b+1;if(c<d)return f-b}return e},startsWith:function(a,b){return 0==a.lastIndexOf(b,0)}};MI.Dialog=function(a){a=a||{};a=a.tmpl||'<div class="D">'+(UI.B.ie6?'<iframe src="javascript:false;" class="cover_select"></iframe>':"")+'<div class="bg"></div><div class="CR"><table border="0" cellspacing="0" cellpadding="0" class="tbSendMsg"><tr><td class="tl"></td><td class="tm"></td><td class="tr"></td></tr><tr><td class="lm"></td><td><div class="DWrap"><div class="DTitle"></div><a title="'+_("关闭")+'" class="DClose close" href="#">'+_("关闭")+'</a><div class="DLoad"></div><div class="DCont"></div></div></div></td><td class="rm"></td></tr><tr><td class="bl"></td><td class="bm"></td><td class="br"></td></tr></table></div></div>';this._body=UI.html(a)[0];this._bg=this.$(".bg");this._cover=this.$(".cover_select");this._wrap=this.$(".CR");this._title=this.$(".DTitle");this._close=this.$(".DClose");this._cont=this.$(".DCont");this._load=this.$(".DLoad");a=UI.bind(this._titleMousedown,this,!0);UI.EA(this._title,"mousedown",a);UI.EA(this._title,"touchstart",a);UI.EA(window,"resize",UI.bind(this.resizeBg,this,!0));if(self!=parent)try{"qq.com"==parent.document.domain&&(this.iframe=1)}catch(b){}};MI.Dialog.prototype={width:462,iframe:0,close:1,_titleMousedown:function(a){var b=this._wrap,a=UI.E(a),c=a.x-parseInt(b.style.left),d=a.y-parseInt(b.style.top),e=UI.windowWidth(),f=UI.windowHeight();a.prevent();document.onmousemove=document.ontouchmove=function(a){a=UI.E(a);if(!UI.B.ie&&(0>a.x||0>a.y||a.x>e||a.y>f))return!1;b.style.top=a.y-d+"px";b.style.left=a.x-c+"px";return!1};document.onmouseup=document.ontouchend=function(){document.onmousemove=document.ontouchmove=null;document.onmouseup=document.ontouchend=null};return!1},_closeClick:function(){this.closeEnd&&this.closeEnd();this.hide();return!1},resizeBg:function(){var a=this;a.display&&(UI.B.ie&&(a._bg.style.cssText+=";width:100%;"),a.delay=setTimeout(function(){var b=UI.pageHeight(),c=UI.windowHeight();a._bg.style.cssText+=";margin-left:0;width:"+UI.pageWidth()+"px;height:"+(b<c?c:b)+"px;";UI.B.ie6&&(a._cover.style.cssText=a._bg.style.cssText)},0))},show:function(a){var b=this,c;b._close.onclick||(b._close.onclick=UI.bind(b._closeClick,b,!0));a.html?document.body.appendChild(b._body):b._append||(document.body.appendChild(b._body),b._append=1);b.close=void 0!=a.close?a.close:b.close;b.ico=a.ico;b.close?UI.show(b._close):UI.hide(b._close);b._title.innerHTML=a.title||"";UI.C(b._title,"height",a.title?"":"0");if(a.html&&!a.noReserve)for(c=b._cont.childNodes.length;0<c;c--){var d=b._cont.childNodes[c-1];1==d.nodeType&&(UI.hide(d),UI.append(d,document.body))}UI.isString(a.html)?b._cont.innerHTML=a.html:UI.isObject(a.html)&&(b._cont.innerHTML="",UI.append(a.html,b._cont),UI.show(a.html));a.width&&(b.width=a.width);a.height&&(b.height=a.height);UI.C(b._wrap,"width",b.width+"px");UI.C(b._wrap,"opacity",0);UI.show(b._body);b.height&&UI.C(b._cont,"height",b.height+"px");c=UI.windowHeight();var d=UI.scrollY(),e=0,f=window.frameElement;if(b.iframe){c=parent.innerHeight||parent.document.documentElement&&parent.document.documentElement.clientHeight||parent.document.body.clientHeight;d=parent.pageYOffset||parent.document.documentElement&&parent.document.documentElement.scrollTop||parent.document.body.scrollTop;do e+=f&&f.offsetTop,f=f.offsetParent;while(f);d-=e}c="width:"+b.width+"px;top:"+(d+c/2-UI.height(b._wrap)/2)+"px;left:"+(UI.windowWidth()/2-b.width/2)+"px;";void 0!=a.left&&(c+="left:"+a.left+"px;margin-left:0;");void 0!=a.top&&(c+="top:"+a.top+"px;margin-top:0;");setTimeout(function(){b.resizeBg()},0);b._wrap.style.cssText=c;a.html&&(a.start&&a.start(),b.end=a.end?a.end:null,b.closeEnd=a.closeEnd?a.closeEnd:null,this.call&&this.call());b.display=1;UI.B.firefox||UI.C(UI.B.ie?document.documentElement:document.body,"overflowX","hidden")},hide:function(){UI.hide(this._body);this.hideLoad();this.end&&this.end();this.display=0;UI.B.firefox||UI.C(UI.B.ie?document.documentElement:document.body,"overflowX","auto")},showLoad:function(a,b,c,d,e){var a=a||this._cont,f="",d=d||UI.width(a),e=e||UI.height(a);UI.isNumber(b)&&(f+="top:"+b+"px;");UI.isNumber(c)&&(f+="left:"+c+"px;");this._load.style.cssText="width:"+d+"px;height:"+e+"px;"+f},hideLoad:function(){var a=this;setTimeout(function(){UI.hide(a._load)},0)},showTip:function(a){var b=this,c=b.close;a.close=0;a.html='<div class="popBox"><span class="ico_tsW"><span class="'+(a.ico?a.ico:"ico_ts")+'"></span></span><h2>'+a.html+"</h2><p></p></div>";a.end=a.end||b.end;b.show({width:9999});b.show(a);b.show({width:UI.width(b._cont)+40});setTimeout(function(){b.hide();b.close=c},a.delay?a.delay:1E3)},alert:function(a,b){var c=this,d;c.show({width:9999});c.show({html:'<div class="popBox"><span class="ico_tsW"><span class="ico_te"></span></span><h3>'+a+'</h3><p><input type="button" value="'+_("知道了")+'" onclick="MI.dialog.hide()"></p></div>',end:b});setTimeout(function(){c.show({width:UI.width(c._cont)+40});(d=g(c._cont,"input")[0])&&d.focus()},0)},$:function(a){return g(this._body,a)[0]}};MI.PV=function(a){window.pvCurUrl&&""!=pvCurUrl&&(pvCurUrl="/"+a,pvRepeatCount=1,"function"==typeof pgvMain&&pgvMain())};MI.Code=function(){};MI.Code.prototype={type:null,typeCheck:{"-100":1,"-110":1},check:function(a){this.type=a;return this.typeCheck[""+a]},addEvented:0,addEvent:function(){function a(){var a=b._value.value;!a||4>a.length||5<a.length?(b._value.focus(),b._msg.innerHTML=_("你输入的验证码有误，请重新输入")):a&&(MI.dialog.hide(),b.call&&setTimeout(function(){b.type&&"-100"!=b.type&&(a+=","+b.type);b.call(a)},300));return!1}var b=this;b.addEvented||(b._body=UI.html(MI.tmpl.code)[0],b._msg=g(b._body,"h3")[0],b._code=g(b._body,"img")[0],b._form=g(b._body,"form")[0],b._codeChange=g(b._body,".codeChange")[0],b._btn=g(b._body,"button"),b._value=g(b._body,"input")[0],b._btn[0].onclick=a,b._btn[1].onclick=function(){MI.dialog.hide()},b._codeChange.onclick=function(){b._code.src=UI.A(b._code,"crs")+"&"+Math.random();b._value.focus();return!1},b._form.onsubmit=a,b.addEvented=1)},show:function(a){var b=this,c=MI.dialog,d,e;b.addEvent();this._msg.innerHTML=a.msg;this._value.value="";this.call=a.call;this._code.src=a.code+"&"+Math.random();UI.A(this._code,"crs",a.code);c.display&&(d=c._cont.firstChild,e=c.width,b.end=function(){c.show({html:d,width:e,end:function(){b.end=null}})});c.show({html:this._body,width:a.width||363,end:b.end});setTimeout(function(){b._value.focus()},0)}};MI.DisableDblClickSelect=function(a){if(a){var b=function(){return(a.getAttribute("_MouseDownNoSelect_")||"").toString().split(",")},c=function(b,c){a.setAttribute("_MouseDownNoSelect_",[b,c])};1==b().length&&(c(+new Date,"up"),a.onmousedown=function(a){var e=+new Date,f=parseInt(b()[0]);c(e,"down");500>e-f&&UI.E(a).prevent()},a.onmouseup=function(){c(b()[0],"up")},a.onselectstart=function(a){"up"==b().pop()&&UI.E(a).prevent()})}return a};MI.MsgBox=function(a,b){function c(){d.countTxt()}var d=new MI.TalkBox(a,{noFlash:1});d.txtTipSend=_("发送中");d._msgTo=d.$(".msgTo");d._num=g(".msgNum");d.url=MI.url.inboxSend||"http://t.qq.com/inbox/send.php";d.msgTo={};d.data=b?{source:b}:{};d.getMsgTo=function(){};d.successStart=function(a){0==a.result&&(MI.tip(_("发送成功")),UI.removeClass(d._body,"pubSuc"))};(!UI.B.ie6||!UI.hasClass(d._txt,"noAutoCmt"))&&new MI.AutoCmt({target:d._msgTo,type:2,tips:_("只能发给收听你的用户"),call:function(){d.countTxt()}});UI.EA(d._msgTo,"keyup",c);UI.EA(d._msgTo,"keydown",c);UI.EA(d._msgTo,"blur",c);return d};MI.MsgList=function(a){a=new MI.TalkList(a);a.removeTip=_("确定删除这条私信？");return a};MI.Reply=function(a){var b;this._body=UI.html(MI.tmpl.reply.replace('<div class="left"></div>','<div class="left" style="display:;"><label style="display:none"><input type="checkbox" '+(MI.user.fun.syncQzone?" checked":"")+' class="replayQzoneCheckbox check1">'+_("同步到空间")+"</label></div>").replace("talkSuc",""))[0];UI.hide(this._body);this.talkBox=new MI.TalkBox(this._body);this._talkTo=g(this._body,".replyTitle")[0];this._msg=g(this._body,".msg")[0];this.talkBox._syncQzone=g(this._body,".replayQzoneCheckbox")[0];this.talkBox.boxType=a;b=this.talkBox;b._btn.value="发送";b.txtTipSend=_("发送中");b.successStart=function(){MI.dialog.showTip({html:_("发送成功!")})};b.success=function(){UI.removeClass(b._body,"pubSuc")};"trans"==a&&(this.talkBox.topic=_("#我来翻译#"))};MI.Reply.prototype={talkBox:null,show:function(a){var b=this.talkBox;MI.dialog.show({html:this._body,width:475});this._talkTo.innerHTML=_("对 <b>{0}</b> 说:",b.talkTo);b._txt.value="";b.talkId="";b.type="";a&&(a.title&&(this._talkTo.innerHTML=a.title),a.cont&&(b._txt.value=a.cont),a.height&&UI.C(b._txt,"height",a.height+"px"),a.type&&(b.type=a.type),a.talkId&&(b.talkId=a.talkId),a.offsetY&&(g(document.body,".CR")[0].style.top=a.offsetY+"px"),a.syncQzone?UI.show(b._syncQzone.parentNode):b._syncQzone.checked=0,a.success&&(b.success=function(){a&&a.success&&(a.success(),a=null);UI.removeClass(b._body,"pubSuc")}));(a&&!1!==a.doFocus||!a)&&setTimeout(function(){MI.focus(b._txt);b.countTxt()},200)}};MI.TransMe=MI.Reply;MI.Msg=function(){var a;UI.hide(this._body);a=this.talkBox=new MI.MsgBox(this._body);a.success=function(){UI.removeClass(a._body,"pubSuc")}};MI.Msg.prototype={_body:UI.html(MI.tmpl.msgBox)[0],show:function(){var a=this.talkBox;MI.dialog.show({width:570,html:this._body,start:function(){a._txt.value="";UI.removeClass(a._btn,"btnNoStr")}});a.getMsgTo();setTimeout(function(){a._txt.focus();a.countTxt()},0)}};MI.Page=function(a){var b=this;b.num=a.num||3;b.max=a.max||0;b.target=a.target||UI.DC("b");b.target.onclick=function(a){a=UI.E(a).target;"A"==a.nodeName&&!UI.hasClass(a,"disabled")&&b.show(Number(UI.A(a,"page")),b.total);return!1};a.call&&(b.call=a.call);a.total&&(b.total=a.total)};MI.Page.prototype.show=function(a,b,c){var d=this.num;if(b=b||this.total){this.total=b=!this.max||b<this.max?b:this.max;if(1<b){a>b?a=b:1>a&&(a=1);var e=[],f;e.push('<a page="'+(a-1)+'" '+(1==a?'class="disabled"':'href="#"')+">"+_("上一页")+"</a>");e.push('<a page="1" '+(1==a?'class="cur"':'href="#"')+">1</a>");if(2<b){2<a-d&&e.push("<span>...</span>");f=a>d+1?a-d:2;b-f<2*d&&(f=b-2*d,2>f&&(f=2));for(d=f+(2==f?2*d:2*d+1);f<d&&f<b;f++)e.push('<a page="'+f+'" '+(a==f?'class="cur"':'href="#"')+">"+f+"</a>");f<=b-1&&e.push("<span>...</span>")}e.push('<a page="'+b+'" '+(a==b?'class="cur"':'href="#"')+">"+b+"</a>");e.push('<a page="'+(a+1)+'" '+(a==b?'class="disabled"':'href="#"')+">"+_("下一页")+"</a>");this.target.innerHTML=e.join("");UI.show(this.target)}else UI.hide(this.target);this.call&&("undefined"===typeof c||c)&&this.call(a)}};MI.TabDialog=function(a){this.list=a.list;this.selectClass=a.selectClass||"select";this.bodyClass=a.bodyClass||"";this.openIndex=a.openIndex||0;this.width=a.width||0;this.build()};MI.TabDialog.prototype={build:function(){this.tab=[];this.div=[];this.explain=[];this._body=this.getBody(this.list);this.bindEvent();this.toggleTab(this.openIndex)},getBody:function(a){if(a&&a.length){var b=this,c=UI.html('<div class="DshareWrap dialogTalkBox '+b.bodyClass+'"><div class="tabStyle1 shareTitle"><ul></ul></div><div class="explain"></div></div>')[0],d=UI.GT(c,"ul")[0],e=g(c,".explain")[0];UI.each(a,function(a,g){var m=UI.html('<li class="'+(g==b.openIndex?b.selectClass:"")+'"><a href="javascript:void(0)">'+a.tab+"</a></li>")[0],l=UI.html('<div style="padding:10px 0"></div>')[0],k=UI.isElement(a.content)?a.content:UI.html(a.content)[0];b.tab.push(m);b.div.push(k);b.explain.push(l);UI.append(m,d);UI.append(l,e);UI.append(k,c)});return c}},changeExplain:function(a){var b=this;UI.each(a,function(a,d){b.explain[d].innerHTML=a})},bindEvent:function(){var a=this;UI.each(a.tab,function(b,c){UI.EA(b,"click",function(){a.toggleTab(c);UI.isFunction(a.list[c].tabEvent)&&a.list[c].tabEvent(b,c)})})},toggleTab:function(a){var b=this;UI.each(b.div,function(c,d){d==a?(UI.show(c),UI.show(b.explain[d]),UI.addClass(b.tab[a],b.selectClass)):(UI.hide(c),UI.hide(b.explain[d]),UI.removeClass(b.tab[d],b.selectClass))});b.lastIndex=a},show:function(a){MI.dialog.show({title:'<h1 class="DmainTit"> </h1>',html:this._body,start:function(){a&&a()},width:this.width})},reset:function(a,b){MI.app({TalkBoxRich:function(){a._txt.value=b||"";a.hideMedia();a.reset();a.delPic();a.delMusic();a.delVideo()}})}};MI.Card=function(){MI.Note&&(this.updateName=MI.Note.updateName)};MI.Card.prototype={_body:UI.html(MI.tmpl.card)[0],_target:null,title:"",account:"",chName:"",name:"",bkname:"",topic:"",target:null,avatar:"",addQQ:"",qq:"",follow:"",followed:"",gender:"",flag:"",baseUrl:"http://t.qq.com",addEvented:0,recomText:null,addEvent:function(){var a=this,b=a._body,c,d,e,f;a.addEvented||(a._pic=g(b,".userPic a")[0],a._name=g(b,".userName")[0],a._num=g(b,".nums")[0],a._note=g(b,".note")[0],a._reply=g(b,".reply")[0],a._msg=g(b,".msg")[0],a._follow=g(b,".addAttention")[0],a._unfollow=g(b,".delAttention")[0],a._uneach=g(b,".delEach")[0],a._more=g(b,".more")[0],a._moreFun=g(b,".moreFun")[0],a._black=g(b,".black")[0],a._chat=g(b,".chat")[0],a._list=g(b,".list")[0],a._recom=g(b,".recom")[0],a._reFollow=g(b,".reFollow")[0],a._report=g(b,".report")[0],a._hotLine=g(b,".hotLine")[0],a._blackTip=g(b,".tip")[1],a._sFollow=g(b,".ico_sFo")[0],a._tag=g(b,".tagBox")[0],a._sepline=g(b,".sepline")[0],a._uIntro=g(b,".uIntro")[0],a._company=g(b,".company")[0],a._school=g(b,".school")[0],a._uRela=g(b,".uRelaBox")[0],a._addQQ=g(b,".addqq")[0],a._rf=g(b,".rf")[0],b=null,a.creatBox=function(){a.reply=new MI.Reply;a.msg=new MI.Msg;a.reFollow=new MI.Reply("reFollow");e=a.reFollow.talkBox;c=a.reply.talkBox;d=a.msg.talkBox;f=c.txtMax;a.creatBox=function(){}},a._pic.onclick=function(){MI.Bos("btnCardHead")},a._body.onclick=function(b){UI.hasClass(this,"small")&&(document.location.href=a.baseUrl+"/"+a.account);UI.E(b).stop()},a._body.onmouseout=function(){a.hide()},a._body.onmouseover=function(){clearTimeout(MI.Card.hideCard);UI.show(a._body)},a._follow.onclick=function(){var b=a._sFollow,c=this;MI.follow(a.account,c,function(d){UI.hide(a._follow);a.follow&&a.followed?UI.show(a._uneach):UI.show(a._unfollow);UI.show(a._sFollow);MI.user.fun.note&&UI.show(a._note);var e=MI.Card.users[a.account];e.follow=1;UI.removeClass(b,"foLight");b.title=MI.sFollowTip[0];e.num[1]++;a.num(e);a._follow.className="addAttention";var e=UI.next(a._target.parentNode.parentNode),f=g(e,".nickFun")[0];g(e,".nickFun a");f&&UI.show(f);a.followCall&&a.followCall(d,c);UI.animate(g(a._rf,"dl")[1],"opacity",0,function(){a.getCommenFriend(a.account,0)});MI.Bos("btnCardFollow");MI.feedBack({name:"usercard",iPos:52,iBak1:3,sBak1:"",id:1191})});return!1},a._uneach.onclick=a._unfollow.onclick=function(){var b=this;MI.follow(a.account,b,function(c){UI.hide(b);UI.hide(a._sFollow);UI.hide(a._note);UI.show(a._follow);var d=MI.Card.users[a.account];d.follow=0;d.group&&(d.group.im=0);d.num[1]--;d.bkname="";a.num(d);a.setName(d);a._unfollow.className="delAttention";a.updateName(a.name,a.title);var e=UI.next(a._target.parentNode.parentNode),d=g(e,".nickFun")[0],e=g(e,".nickFun a")[0];d&&(UI.hide(d),UI.removeClass(d,"nickFunDis"),UI.A(e,"note",""),e.innerHTML=_("添加备注"));a.followCall&&a.followCall(c,b);UI.animate(g(a._rf,"dl")[0],"opacity",0,function(){a.getCommenFriend(a.account,1)});MI.Bos("btnCardUnFollow");MI.feedBack({name:"usercard",iPos:52,iBak1:8,sBak1:"",id:1191})});return!1},a._note.onclick=function(){MI.Note.add(this,function(b){var c=MI.Card.users[a.account];c&&(c.bkname=b.bkname);a.updateName(b.bkname||a.name,a.title);var c=UI.next(a._target.parentNode.parentNode),d=g(c,".nickFun")[0],e=g(c,".nickFun a")[0];d&&(b.bkname?UI.addClass(c,"nickFunDis"):UI.removeClass(c,"nickFunDis"),e.innerHTML=b.bkname||_("添加备注"),UI.A(e,"note",b.bkname))});MI.Bos("btnNoteCardAdd");return!1},a._reply.onclick=function(){a.creatBox();var b,d="";a.chName&&a.chName.match(/^[^\d]/g)?(c.topic="@"+a.chName+" ",b=7):(d=a.chName,c.topic="",b=2);c.talkTo=a.bkname||a.name;c.txtMax=f-c.topic.length;a.reply.show({type:b,talkId:d});MI.Bos("btnCardReply");return!1},a._reFollow.onclick=function(){if(UI.hasClass(this,"disabled"))return!1;var b=_("我收听你了，你也快来收听我吧！");a.creatBox();e.topic="@"+a.account+" ";e.talkTo=a.bkName||a.name;e.txtMax=f-e.topic.length-b.length;a.reFollow.show({type:7,cont:b,title:_("邀请")+" <b>"+(a.bkname||a.name)+"</b> "+_("收听你:")+'<span class="gray">'+_(" (会作为一条半公开的对话发出来)")+"</span>"});"none"!=a._moreFun.style.display&&MI.Bos("btnCardReFollow");return!1},a._msg.onclick=function(){if(MI.user.fun.msgLab)return UI.hasClass(this,"disabled")||MI.pmcompose(a.chName,1),!1;a.creatBox();UI.hasClass(this,"disabled")?MI.Bos("btnCardMsgDisabled"):(d._msgTo.value=a.chName,a.msg.show(),MI.Bos("btnCardMsg"));return!1},a._black.onclick=function(){var b=MI.json(UI.A(this,"rel"));b.txt=[_("拉黑"),_("取消拉黑")];b.target=this;b.call=function(){var c=MI.Card.users[b.u],d=UI.hasClass(b.target,"blackDel");c.follow&&d&&(c.follow=0,c.group&&(c.group.im=0),c.num[1]--);c.block=d;a.blackCall&&a.blackCall(d)};MI.black(b);return!1},a._sFollow.onclick=function(){var b=UI.hasClass(this,"foLight")?0:1;MI.sFollow(a.account,this,function(c){var d=MI.Card.users[a.account];d.group&&(d.group.im=b);a.sFollowCall&&a.sFollowCall(c)});b?MI.Bos("btnCardSFollow"):MI.Bos("btnCardUnSFollow");return!1},a._chat.onclick=function(){if(!a.chat)return!1;MI.chat(a.account,a.name,a.avatar);MI.Bos("btnCardChat");return!1},a._addQQ.onclick=function(){!0!=UI.hasClass(a._addQQ,"disabled")&&(MI.Bos("btnCardQQ"),MI.addQQ(a.name,a.qq,a.account,MI.user.name,MI.user.account,a.gender,MI.Uin(),a.addQQ));return!1},a._list.onclick=function(){MI.app({List:function(){MI.List.listFollow(a.account,{title:_("名单分组"),bkname:" ",foset:" "})}});MI.Bos("btnCardList");return!1},a._report.onclick=function(){MI.report(a.account);MI.Bos("btnCardReportUser");return!1},a._recom.onclick=function(){var b=[_("向大家介绍一下<b>{0}</b>吧:",a.bkname||a.name),_("可以单独向某个朋友推荐<b>{0}</b>",a.bkname||a.name)],c=_("#推荐收听# @{0} ",a.account);if(!a.recom){var d='<div class="recomTip">'+_("提示：TA是什么样的人，TA的微博好玩么，哪些是最值得你推荐的？")+'</div><div class="bot clear">';a.recom=new MI.TabDialog({width:530,list:[{tab:_("公开推荐"),content:'<div class="d_hp d_hm d_hv">'+MI.tmpl.fullMediaTalk.replace('<div class="bot clear">',d)+"</div>"},{tab:_("私信推荐"),content:MI.tmpl.msgBox.replace('<div class="bot clear">',d)}]})}a.recomPublishBox||(a.recomPublishBox=new MI.TalkBox(a.recom.div[0],{noFlash:1}),a.recomPublishBox.success=function(){MI.ajax({url:MI.url.comm,data:{accounts:a.account}});MI.tip(_("发送成功"))});a.recomPublishBox.data={commAccount:a.account};a.recomMsgBox||(a.recomMsgBox=new MI.MsgBox(a.recom.div[1]));a.recom.reset(a.recomPublishBox);a.recomPublishBox.topic=c;a.recomPublishBox.countTxt();a.recom.reset(a.recomMsgBox);a.recomMsgBox.topic=c;a.recomMsgBox._msgTo.value="";a.recomMsgBox.countTxt();a.recom.changeExplain(b);a.recom.show(function(){[a.recomPublishBox,a.recomMsgBox][a.recom.lastIndex].focus()});MI.Bos("btnCardRecom");return!1},a._hotLine.onclick=function(){var b="#"+(a.topic||"热线平台")+"# ",c=[_(b)+"@"+(a.bkname||a.name),_(b)+"@"+(a.bkname||a.name)];a.hotLine||(a.hotLine=new MI.TabDialog({width:530,list:[{tab:_("发广播"),content:MI.tmpl.fullMediaTalk},{tab:_("发私信"),content:MI.tmpl.msgBox}]}));a.hlPublishBox||(a.hlPublishBox=new MI.TalkBox(a.hotLine.div[0],{noFlash:1}),a.hlPublishBox.data={},a.hlPublishBox.success=function(){MI.tip(_("发送成功"))});a.hlMsgBox||(a.hlMsgBox=new MI.MsgBox(a.hotLine.div[1],1712));a.hotLine.reset(a.hlPublishBox);a.hlPublishBox.topic=b+"@"+a.account+" ";a.hlPublishBox.txtMax=140-MI.countTxt(a.hlPublishBox.topic);a.hlPublishBox.countTxt();a.hotLine.reset(a.hlMsgBox);a.hlMsgBox.topic=b;a.hlMsgBox._msgTo.value=a.account;a.hlMsgBox.txtMax=140-MI.countTxt(a.hlMsgBox.topic);a.hlMsgBox.countTxt();a.hotLine.changeExplain(c);a.hotLine.show(function(){[a.hlPublishBox,a.hlMsgBox][a.hotLine.lastIndex].focus()});MI.Bos("btnCardHotLine");return!1},a._more.onmouseover=function(){UI.show(a._moreFun);UI.addClass(a._more,"hover")},a._more.onmouseout=function(){clearTimeout(a._more.delay);a._more.delay=setTimeout(function(){UI.hide(a._moreFun);UI.removeClass(a._more,"hover")},1E3)},a._moreFun.onmouseover=function(){clearTimeout(a._more.delay);UI.show(a._moreFun);UI.addClass(a._more,"hover")},a._moreFun.onmouseout=function(){UI.hide(a._moreFun);UI.removeClass(a._more,"hover")},a._company.onmousedown=function(){MI.Bos("btnCardCompany")},a.addEvented=1)},getPos:function(a){for(var b=UI.getX(a)+(parseFloat(UI.C(a,"paddingLeft"))||0),c=UI.getY(a)+(parseFloat(UI.C(a,"paddingTop"))||0),d=a.parentNode;d&&d!=document.body;)d.scrollTop&&(c-=d.scrollTop),d=d.parentNode;if("2"==this.cType){var d=UI.windowHeight(),e=UI.scrollY(document.documentElement||document.body),f=UI.height(this._body)||100,a=UI.height(a);c+f+10>d+e?(c=c-f-10,UI.addClass(this._body,"cardB")):(c=c+a+10,UI.removeClass(this._body,"cardB"))}else if(("3"==this.cType||"4"==this.cType)&&260>b)UI.removeClass(this._body,"cardR"),UI.addClass(this._body,"cardL"),b=b+260+UI.width(a)+10;return{x:b,y:c}},setPos:function(a){a=this.getPos(a);this._body.style.left=a.x+"px";this._body.style.top=a.y+"px"},getCommenFriend:function(a,b){var c=this;if(MI.Card.commenFriends&&MI.Card.commenFriends[a]&&MI.Card.commenFriends[a][b])c.showCommenFriend(MI.Card.commenFriends[a][b],b);else{var d=b?MI.url.relationsIdol:MI.url.recommend,e={};c.flag.auth?e.srv="same_star":(e.srv="common_old",e.scene=6);e.medium=a;e.count=10;MI.ajax({url:d,type:"get",data:b?{count:10,id:a+","+MI.user.account}:e,success:function(d){d=MI.json(d);0==d.result?(c.showCommenFriend(d.info,b),MI.Card.commenFriends[a]={},MI.Card.commenFriends[a][b]=d.info):UI.hide(c._rf)}})}},showCommenFriend:function(a,b){if(a.list&&a.list.length){var c="",d=0;UI.each(a.list,function(a){if(4>d){var b=MI.getInternalUrl(0,a.name);c+='<a href="'+b+'">';c+='<img onerror="MI.Pic(this,30)" title="'+a.nick+'" src="'+(a.avatar?a.avatar+"/30":"http://mat1.gtimg.com/www/mb/images/head_50.jpg")+'" />';c+="</a>";d++}});var e=1==b?0:1,f=g(this._rf,"dl"),h=_("这些人也收听了{0}:",this.gender);1==b&&(h=a.wording&&2==a.wording?_("我们共同收听了:"):h);g(this._rf,".commenNum")[b].innerHTML=1==b?h:_("收听{0}的人还收听:",this.gender);g(this._rf,".commenFriend")[b].innerHTML=c;UI.show(f[b]);UI.C(f[b],"opacity","1");UI.hide(f[e]);UI.show(this._rf)}else UI.hide(this._rf)},show:function(a){function b(b){var d=c.account.toLocaleLowerCase()!=MI.user.account.toLocaleLowerCase(),e;e=b.follow&&b.followed?c._uneach:b.follow?c._unfollow:c._follow;var f=c._sFollow,h=c._note,j=b.gender?_("他"):_("她");c.bkname=b.bkname;c.name=b.nick;c.avatar=b.avatar;c.title=(c.bkname||c.name)+"(@"+(c.chName||c.account)+")";c.chat=b.chat;1!==MI.user.fun.chat?UI.hide(c._chat):(UI.show(c._chat),c.chat?UI.removeClass(c._chat,"disabled"):UI.addClass(c._chat,"disabled"));c.flag={};c.flag=b.flag;b.flag.auth&&(c.flag.auth=b.flag.auth);c.addQQ=b.addQQ;c.qq=b.qq;c.follow=b.follow;c.followed=b.followed;c.gender=b.gender;UI.show(c._addQQ);!c.follow||!c.followed?UI.addClass(c._addQQ,"disabled"):UI.removeClass(c._addQQ,"disabled");if("1"!=c.cType){var k=b.avatar;c._pic.innerHTML='<img src="'+(k?k+"/50":"http://mat1.gtimg.com/www/mb/images/head_50.jpg")+'" />'}2==b.gender&&(j=_("它"));c.gender=j;j="{u:'"+c.account+"',name:'"+(c.bkname||c.name)+"',sex:'"+c.gender+"'}";b.block?(c._black.innerHTML=_("取消拉黑"),UI.addClass(c._black,"blackDel"),c._blackTip.style.display="block",c._blackTip.innerHTML='<a href="#" class="right blackDel" rel="'+j+'">['+_("移出")+"]</a>"+_("{0}在你的黑名单里",c.gender),g(c._blackTip,"a")[0].onclick=c._black.onclick):(c._black.innerHTML=_("拉黑"),UI.removeClass(c._black,"blackDel"),UI.hide(c._blackTip));UI.A(c._black,"rel",j);c.num(b);c.setName(b);d?e.style.display="block":UI.addClass(c._body,"isMe");b.mail||d&&b.followed?(UI.removeClass(c._msg,"disabled"),c._msg.title=""):(UI.addClass(c._msg,"disabled"),c._msg.title=_("私信只能发给你的听众"));b.follow&&d&&!b.followed?UI.removeClass(c._reFollow,"disabled"):UI.addClass(c._reFollow,"disabled");d&&b.follow?(b.group?(b.group.im?(UI.addClass(f,"foLight"),f.title=MI.sFollowTip[1]):(UI.removeClass(f,"foLight"),f.title=MI.sFollowTip[0]),UI.show(f)):UI.hide(f),UI.show(h)):(UI.hide(f),UI.hide(h));UI.A(h,"account",c.account);UI.A(h,"chName",c.chName);UI.A(h,"note",b.bkname||"");UI.A(h,"nick",b.nick);MI.user.fun.note||UI.hide(c._note);b.hotLine?UI.show(c._hotLine):UI.hide(c._hotLine);"3"!=c.cType&&"4"!=c.cType&&(b.company=b.school="");b.tag||b.uIntro||b.company||b.school?UI.show(c._sepline):UI.hide(c._sepline);if(b.tag){c._tag.innerHTML=_("标签：")+b.tag+"";if("3"==c.cType||"4"==c.cType||b.uIntro||b.company||b.school){var l=g(c._tag,"span"),m=0,i=0,n=!0;for(UI.each(l,function(a,b){n&&(m+=6*MI.string.length(UI.text(a))+8,185<m&&(i=l.length-b,n=!1))});i;)c._tag.removeChild(c._tag.lastChild),i--;n||(c._tag.innerHTML+='<span class="etc"><a title="'+_("更多")+'" href="'+c.baseUrl+"/"+c.account+'">...</a></span>')}UI.show(c._tag)}else UI.hide(c._tag);b.uIntro?(c._uIntro.innerHTML=b.uIntro,d=UI.text(c._uIntro),72<MI.string.length(d)?(c._uIntro.title=d,c._uIntro.innerHTML=MI.string.cut(d,72,"...")):c._uIntro.removeAttribute("title"),UI.show(c._uIntro)):UI.hide(c._uIntro);b.company?(d=MI.string.cut(b.company.comName,30,"..."),c._company.innerHTML=_("公司：")+'<a href="'+b.company.href+'" title="'+b.company.comName+'">'+d+"</a>",UI.show(c._company)):UI.hide(c._company);b.school?(d=e=b.school.name||"",j=b.school.href||"",f=h=b.school.objectName||"",k=b.school.objectHref||"",30<MI.string.length(d+f)&&(d=MI.string.cut(d,14,"..."),f=MI.string.cut(f,12,"...")),k?(c._school.innerHTML=_("学校：")+'<a href="'+j+'" title="'+e+'">'+d+'</a> <a href="'+k+'" title="'+h+'">'+f+"</a>",UI.EA(g(c._school,"a")[1],"mousedown",function(){MI.Bos("btnCardSchoolObject")})):c._school.innerHTML=_("学校：")+'<a href="'+j+'" title="'+e+'">'+d+'</a> <span title="'+h+'">'+f+"</span>",UI.EA(g(c._school,"a")[0],"mousedown",function(){MI.Bos("btnCardSchool")}),UI.show(c._school)):UI.hide(c._school);d=0;d=b.follow?0:1;c.getCommenFriend(c.account,d);c._uRela.innerHTML=c.uRela;c._uRela.style.display=c.uRela?"block":"none";UI.removeClass(c._body,"loading");UI.removeClass(c._body,"small");c.setPos(a);MI.Bos("btnCardOpen",null,0.01)}var c=this;c.addEvent();if(c.target==a)UI.show(c._body);else{if("a"==a.nodeName.toLowerCase())var d=a,e="";else{d=a.parentNode;e=a.src;if(-1!=d.href.indexOf("/setting_work.php"))return;e&&(c._pic.innerHTML='<img src="'+e+'">')}var e=UI.A(d,"ctype"),f=UI.A(d,"rel")||"@..",h=/@[^@]+$/g,j=MI.string.id(d.href.split("?")[0]);UI.A(d,"account")&&(j=UI.A(d,"account"));var l=f.match(h)[0].slice(1,-1),f=f.replace(h,"").slice(0,-1),h=MI.getInternalUrl(0,j),d=UI.A(d,"uRela")||"",k,x,q,s;c._body.className="uCard cType"+e+" card"+[0,1,"T","R","R"][1*e];c.cType=e;c.account=j;c.name=f;c.chName=l;c._pic.href=h;c.uRela=d;UI.hide(c._follow);UI.hide(c._unfollow);UI.hide(c._uneach);c.setPos(a);"1"==c.cType?UI.addClass(c._body,"small"):UI.addClass(c._body,"loading");UI.append(c._body,document.body);UI.removeClass(c._body,"isMe");UI.show(c._body);c._target=c.target=a;UI.hide(c._rf);MI.Card.users[j]?b(MI.Card.users[j]):(k=+new Date,MI.ajax({url:MI.url.userCard,type:"get",data:"u="+j+"&t="+c.cType+"&r="+MI.random(),success:function(a){x=+new Date-k;a=MI.json(a);0==a.result?(b(a.info),MI.Card.users[j]=a.info):c.hide();q=+new Date-k;setTimeout(function(){s=+new Date-k;MI.Speed("t_asyn_card",0.1,x,q,s)},0)}}))}},setName:function(a){for(var b="",c=0,d=MIIco.length;c<d;c++)if(a.flag[MIIco[c]]){b+=MIIcoHtml[c];break}a.icon&&(b+=a.icon);c=a.bkname||a.nick;a.flag.member&&(c='<span class="c_vip" title="会员参加#给生活找点乐#点亮红名">'+c+"</span>");this._name.innerHTML='<a href="'+MI.getInternalUrl(0,this.account)+'">'+c+"</a>"+b+'<br /><span class="en">'+(a.bkname?a.nick:"")+"@"+this.chName+"</span>"},updateName:function(){},num:function(a){var b=a.num;this._num.innerHTML=_("广播{0}条",b[0])+"<span>"+(a.flag.vivi?"":"|</span>"+_("听众{0}人",b[1])+"")},hide:function(){UI.hasClass(this._body,"small")||(UI.hide(this._body),this.target=null)}};MI.Card.show=function(a){var b=UI.E(a).target;clearTimeout(MI.Card.delay);clearTimeout(MI.Card.hideCard);MI.Card.delay=setTimeout(function(){MI.card.show("SPAN"==b.nodeName?b.parentNode:b)},400)};MI.Card.users={};MI.Card.commenFriends={};MI.Card.hide=function(){clearTimeout(MI.Card.delay);clearTimeout(MI.Card.hideCard);MI.Card.hideCard=setTimeout(function(){MI.card.hide()},500)};MI.Card.build=function(a,b,c){MI.user.fun.card&&(c=c||1,UI.each(g(a,b),function(a){var b="a"==a.nodeName.toLowerCase()?a:a.parentNode;UI.A(b,"card")||(UI.A(b,"card","1"),UI.A(b,"ctype",c),UI.A(b,"rel",b.title),a.title=b.title,3===MI.hostType&&b.href&&b.href.match(MI.Card.build.REG_QZAPP_HREF)&&(b.href=MI.getInternalUrl(0,RegExp.$2)),a.title&&MI.string.account(a.title)&&(UI.EA(a,"mouseover",MI.Card.show),UI.EA(a,"mouseover",function(){b.title=a.title=""}),UI.EA(a,"touchstart",MI.Card.show),UI.EA(a,"mouseout",MI.Card.hide),UI.EA(a,"touchend",MI.Card.hide),UI.EA(a,"click",function(){MI.Bos("btnHead")})))}))};MI.Card.build.REG_QZAPP_HREF=/^(http:\/\/z.t.qq.com)?\/([A-Za-z][A-Za-z0-9_\-]*)$/;MI.DropBox=function(a){this.target=a.target;this.dir=a.dir;this.start=a.start||1;this.add=a.add;this.url=a.url;this.data=a.data||{};this.data._=+new Date;this.html=a.html;this.htmlStr=a.htmlStr||this.htmlStr;this.className=a.className;this.dataFilter=a.dataFilter||function(a){return a};this.domHandler=a.domHandler||function(){};this.delayTime=0;this.defaultHTML=a.defaultHTML||"";this.build()};MI.DropBox.prototype={htmlStr:'<div style="display:none;position:absolut;"><div class="itemBox clear"><br /><br /><br /><br /></div><div class="func"><div class="clear"></div></div></div>',activeClass:"active",dirList:["left","right","top","bottom"],setPos:function(){var a="left";if(!this.dir)return!1;UI.C(this.body,this.dirList[this.dir],"100%");a=2>this.dir?[this.dirList[3],this.dirList[1]][this.start]:[this.dirList[1],this.dirList[0]][this.start];UI.C(this.body,a,0)},build:function(){var a=this;a.body=UI.html(a.htmlStr)[0];a.listBox=g(a.body,".itemBox")[0]||a.body;a.funcBox=g(a.body,".func .clear")[0];a.funcBox&&(a.funcBox.innerHTML=a.add);a.className&&UI.addClass(a.body,a.className);UI.append(a.body,a.target.parentNode);a.setPos();UI.B.ipad?(a.target.ontouchstart=function(){a.show()},a.target.onclick=function(){return!1}):(a.target.onmouseover=function(){a.show()},a.target.onmouseout=a.body.onmouseout=function(){a.hide()},a.body.onmouseover=function(){a.show()})},show:function(){var a=this;clearTimeout(a.delayHide);UI.addClass(a.target,a.activeClass);UI.show(a.body);clearTimeout(a.delayShow);a.listData||(a.delayShow=setTimeout(function(){a.refresh(a.html)},a.delayTime))},hide:function(){var a=this;clearTimeout(a.delayHide);a.delayHide=setTimeout(function(){UI.hide(a.body);UI.removeClass(a.target,a.activeClass)},20)},refresh:function(a){var b=this;a||b.listData?(b.listBox.innerHTML=b.listData=a||b.listData,b.domHandler(b.listBox)):b.url&&(UI.addClass(b.listBox,"loading"),MI.ajax({url:b.url,type:"get",data:b.data,success:function(a){UI.removeClass(b.listBox,"loading");a=MI.json(a);0==a.result?a.info&&(a=b.dataFilter(a.info),b.refresh(a),b.listData=a,b.delayTime=0):(a.msg=a.msg?'<p style="text-align:center;padding:20px 0;">'+a.msg+"</p>":b.defaultHTML,b.listBox.innerHTML=a.msg,b.delayTime+=500)}}))}};MI.subTabToggle=function(){var a=g(document.body,".homeFilter .subTab1")[0];if(a){var b=g(document.body,".homeFilter .more_link")[0],c=g(a,".homeFilter .subTab1 a"),d=b&&UI.A(b,"expand"),e=UI.height(a),f=a.scrollHeight,f=!UI.B.ie?f-7:UI.B.ie9?f-8:UI.B.ie8?f-7:f;UI.each(c,function(b){b.onclick=function(){d&&UI.cookie(d,UI.height(a),7,"t.qq.com")}});if(b){var h=function(){b.innerHTML=_("收起↑");UI.addClass(b,"up")},j=function(){b.innerHTML=_("展开↓");UI.addClass(b,"up")};53>=f?(UI.hide(b),UI.C(a,"height","auto")):e>=f?h():e<f&&j();b.onclick=function(){f>e+53?e+=53:f>e&&f<=e+53?(e=f,h()):(e=53,j());clearInterval(MI.subTabToggle.animate);MI.subTabToggle.animate=UI.animate(a,"height",e,function(){d&&UI.cookie(d,UI.height(a),7,"t.qq.com")});return!1}}}};MI.Shortcuts={add:function(a){var b=this;a&&(UI.isArray(a)?UI.each(a,function(a){b.add(a)}):(b.builded[a.event]||b.build(a.event),b.key[a.event]||(b.key[a.event]=[]),b.key[a.event].push(a)))},del:function(a){var b=this;if(a)if(UI.isArray(a))UI.each(a,function(a){b.del(a)});else if(b.builded[a.event]){var c=0,d;for(d in b.key[a.event])b.key[a.event][d]===a&&(c=d);b.key[a.event].splice(c,1);0==b.key[a.event].length&&UI.ER(document.documentElement,a.event,b.builded[a.event])}},key:{},keyDo:function(a,b){var c=UI.E(a);UI.each(this.key[b],function(a){var b=c.target.nodeName;"INPUT"!=b&&"TEXTAREA"!=b&&c.key==a.key&&a.call(c)})},builded:{},build:function(a){var b=this;b.builded[a]=function(c){b.keyDo(c,a)};UI.EA(document.documentElement,a,b.builded[a])},talkList:[{event:"keyup",key:80,call:function(){var a=j("plain");a?(a.checked=a.checked?!1:!0,a.onclick&&a.onclick()):MI.talkList&&MI.talkList.iconPicToggle()}},{event:"keyup",key:70,call:function(){var a=MI.talkList.cur;if(MI.talkList&&a&&(a=g(j(a),".fav")[0]))a.onclick()}},{event:"keyup",key:82,call:function(){MI.talkList&&MI.talkList._new&&UI.fireEvent(MI.talkList._new,"click")}},{event:"keyup",key:84,call:function(){window.scrollTo(0,0)}},{event:"keyup",key:66,call:function(){window.scrollTo(0,UI.pageHeight())}},{event:"keyup",key:83,call:function(){var a=j("searchKey");if(a)try{a.focus()}catch(b){}}},{event:"keyup",key:78,call:function(){MI.talkBox&&MI.talkBox.focus()}}]};MI.GoTop={_body:UI.html('<div class="sToolbar single"><div class="bg"></div><div class="sToolbarBg"><em></em></div></div>')[0],_mBox:UI.html('<div class="mSimpleBox" style="display:none"><a href="#" class="ico_mState" style="display:none"></a><button class="btn_mPlay">'+_("播放")+'<b class="mask"></b></button><button class="btn_mPause" style="display:none">'+_("暂停")+'<b class="mask"></b></button><b class="mbg"></b></div>')[0],_tBox:UI.html('<div class="goTopBox" style="display:none"><a href="#" class="btn_goTop" onclick="window.scrollTo(0,0);MI.Bos(\'btnTop\');this.blur();return false" title="'+_("返回顶部")+'">'+_("返回顶部")+'<b class="mask"></b></a></div>')[0],_qBox:UI.html('<div class="qTalkBox"><a href="#" onclick="return false" class="btn_qTalk" title="'+_("实时聊天加载中...")+'"><b class="mask"></b></a></div>')[0],_qqBox:UI.html('<div id="EQQ_Container"></div>')[0],delay:{},resize:0,btnNum:1,chat:0,btnClass:["sToolbar single","sToolbar double","sToolbar"],btnSet:function(){this._body.className=this.btnClass[this.btnNum-1]},position:function(){MI.user.fun.goTop&&this.build()},build:function(a){function b(a){r=a&&"resize"==UI.E(a).type||d.resize;clearTimeout(d.delay.position);if(UI.B.ie6){if(MI.dialog&&MI.dialog.display)return;UI.hide(d._body);UI.hide(d._qqBox)}d.delay.position=setTimeout(c,UI.B.ie?1E3:100);MI.card&&MI.card.hide()}function c(){var a=MI.music.state;q=UI.pageHeight();r&&(x=UI.windowHeight(),m=UI.getX(h)+UI.width(h)-e,l=UI.windowWidth()-UI.getX(h)-UI.width(h)-30-31+f,d.resize=0);s=UI.scrollY();parseInt(UI.C(d._body,"left"))!=m&&(d._body.style.cssText="left:"+m+"px;");parseInt(UI.C(d._qqBox,"right"))!=l&&(d._qqBox.style.cssText="right:"+l+"px;");52>s?(UI.hide(d._tBox),d.btnNum=null!=a?2:1,!d.chat&&null==a&&UI.hide(d._body)):(d.btnNum--,UI.show(d._tBox),UI.show(d._body),null!=a&&UI.show(d._mBox),d.chat&&UI.show(d._body),d.btnNum=null!=a?3:2);d.btnSet();o=s+x-q;o>=-k?(d._body.style.cssText+=";position:absolute;top:"+(q-37-k)+"px",d._qqBox.style.cssText+=";position:absolute;top:"+(q-k)+"px"):"absolute"==UI.C(d._body,"position")&&(d._body.style.cssText="left:"+m+"px;",d._qqBox.style.cssText="right:"+l+"px;")}var d=this,a=a||j("mainWrapper");d._target||(d._target=a);if(!UI.hasClass(document.body,"ipad")&&d._target){UI.isNumber(MI.user.fun.chat)&&setTimeout(function(){MI.app({WebQQ:function(){var a=g(MI.GoTop._qBox,".btn_qTalk")[0];a&&(UI.C(a,"background","none"),UI.C(a,"filter",""),a.title="")}})},50);var e=5,f=6,h=d._target,m,l,k,x=UI.windowHeight(),q=UI.pageHeight(),s,r,o,a=MI.music.state;UI.isNumber(MI.user.fun.chat)&&(d.chat=1);UI.B.ie6?f-=5:UI.B.ie&&(f-=4);window.innerWidth||(f+=21);UI.B.mac&&(f+=2,navigator.userAgent.hasString("Mac OS X 10_7")&&(f+=13));UI.pageHeight()<=UI.windowHeight()&&(f+=15);h&&(UI.after(d._mBox,g(d._body,".bg")[0]),d.chat?(UI.after(d._qBox,g(d._body,".bg")[0]),UI.append(d._qqBox,document.body)):d.btnClass.unshift(d.btnClass[0]),UI.after(d._tBox,g(d._body,".mSimpleBox")[0]),UI.append(d._body,document.body),d.musicBoxEvent(),null!=a&&UI.show(d._mBox),k=q-(UI.getY(h)+UI.height(h)),b(),d._body.onfocus=function(){this.blur()},UI.EA(window,"scroll",b),UI.EA(window,"resize",b));r=1;c()}},showMusicBox:function(a){var b="none"!=this._tBox.style.display,c=this._mBox,d=g(c,".ico_mState")[0],e=g(c,".btn_mPlay")[0],f=g(c,".btn_mPause")[0];this.btnNum="none"!=this._tBox.style.display?3:2;this.btnSet();(this.chat||b||null!=a)&&UI.show(this._body);UI.show(c);1==a?(a=_("正在播放 "),UI.show(d),UI.hide(f),UI.hide(e)):(a=_("点击播放 "),UI.show(e),UI.hide(f),UI.hide(d));c.title=a+MI.music.info.songName+"-"+MI.music.info.singerName},hideMusicBox:function(){var a=this,b="none"!=a._tBox.style.display;a.btnNum=b?2:1;a.btnSet();UI.hide(a._mBox);setTimeout(function(){!a.chat&&!b&&null==MI.music.state&&UI.hide(a._body)},0)},musicBoxEvent:function(){var a=0,b=this._mBox,c=g(b,".ico_mState")[0],d=g(b,".btn_mPlay")[0],e=g(b,".btn_mPause")[0];b.onmouseover=function(){a=MI.music.state;0!=a&&1!=a&&2!=a&&6!=a?(UI.show(e),UI.hide(d)):(UI.show(d),UI.hide(e));UI.hide(c)};b.onmouseout=function(){a=MI.music.state;0!=a&&1!=a&&2!=a&&6!=a?(UI.show(c),UI.hide(d)):(UI.show(d),UI.hide(c));UI.hide(e)};d.onclick=function(){MI.TalkList.musicPlay(MI.music.info);MI.Bos("btnMiniPlayerPlay")};e.onclick=function(){MI.TalkList.musicStop();MI.Bos("btnMiniPlayermPause")}}};UI.clear(function(){try{MI.TalkList.musicStop()}catch(a){}})})();/*  |xGv00|c9270f0917fc84ff02b65b3aa13cda47 */
(function(){if(typeof webq=="undefined")webq={};var k=webq.framework={},j=k.dom={},v=k.string={},r=k.event={},p=k.func={};v=k.string={};k.model={};k.view={};k.controller={};k.collection={};j.id=function(a){return document.getElementById(a)};j.hasClass=function(a,c){return RegExp("(^|\\s)"+c+"(\\s|$)").test(a.className)};j.addClass=function(a,c){if(!j.hasClass(a,c))a.className=a.className+" "+c};j.removeClass=function(a,c){a.className=a.className.replace(RegExp("(^|\\s)"+c+"(?:\\s|$)"),"$1")};j.getElementsByClassName=function(a,c,e){if(arguments.length!=3)alert("Be careful with it...");else{for(var b=a.getElementsByTagName(c),d=[],f=0,g=b.length;f<g;f++)j.hasClass(b[f],e)&&d.push(b[f]);return d}};var t=function(){return document.compatMode==="CSS1Compat"?document.documentElement:document.body};j.getClientWidth=function(a){a=a||t();return a.getClientWidth};_findPapa=function(a,c){var e=4,b=c.substr(1),d;d={"#":function(f,g){return f.id==g},".":function(f,g){return j.hasClass(f,g)}}[c.charAt(0)];return function(){if(d(a,b))return a;else if(e>0){e--;if(a.parentNode)a=a.parentNode;else e=0;return arguments.callee()}return null}};j.superFindPapa=_findPapa;j.findPapa=function(){var a=4;return function(c,e){if(j.hasClass(c,e))return c;else if(a>0){a--;return arguments.callee(c.parentNode,e)}return null}};j.node=function(a,c,e){var b,d=(e||window).document.createElement(a);for(b in c){a={"class":function(){d.className=c[b]},style:function(){d.style.cssText=c[b]}};if(a[b])a[b]();else d.setAttribute(b,c[b])}return d};j.hide=function(a){if(typeof a=="string")j.id(a).style.display="none";else a.style.display="none"};j.show=function(a){if(typeof a=="string")j.id(a).style.display="block";else a.style.display="block"};var l;t=function(){if(l)return l;return l=document.compatMode==="CSS1Compat"?document.documentElement:document.body};j.getClientHeight=function(a){a=a||t();return a.clientHeight};j.getClientWidth=function(a){a=a||t();return a.clientWidth};j.getOffsetHeight=function(a){a=a||t();return a.offsetHeight};j.getOffsetWidth=function(a){a=a||t();return a.offsetWidth};j.getClientXY=function(a){var c=0,e=0;if(a)if(document.documentElement.getBoundingClientRect&&a.getBoundingClientRect){e={left:0,top:0,right:0,bottom:0};try{e=a.getBoundingClientRect()}catch(b){return[0,0]}a=a.ownerDocument;c=e.top-0+((a?a.scrollTop:Math.max(document.documentElement.scrollTop,document.body.scrollTop))||0);e=e.left-0+((a?a.scrollLeft:Math.max(document.documentElement.scrollLeft,document.body.scrollLeft))||0)}else for(;a.offsetParent;){c+=a.offsetTop;e+=a.offsetLeft;a=a.offsetParent}return[e,c]};webq.framework.cookie={set:function(a,c,e,b,d){if(d){var f=new Date;f.setTime((new Date).getTime()+36E5*d)}window.document.cookie=a+"="+c+"; "+(d?"expires="+f.toGMTString()+"; ":"")+(b?"path="+b+"; ":"path=/; ")+(e?"domain="+e+";":"domain="+domainPrefix+";");return true},get:function(a){a=window.document.cookie.match(RegExp("(?:^|;+|\\s+)"+a+"=([^;]*)"));return!a?"":a[1]},remove:function(a,c,e){window.document.cookie=a+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; "+(e?"path="+e+"; ":"path=/; ")+(c?"domain="+c+";":"domain="+domainPrefix+";")}};v.encodeHtmlSimple=function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/>/g,"&gt;");a=a.replace(/</g,"&lt;");a=a.replace(/"/g,"&quot;");return a=a.replace(/'/g,"&#39;")};v.obj2queryString=function(a){var c=[],e,b;for(b in a){e=a[b];c.push(encodeURIComponent(String(b))+"="+encodeURIComponent(String(e)))}return c.join("&")};var h={};(function(){function a(y){b.lastIndex=0;return b.test(y)?'"'+y.replace(b,function(z){var w=g[z];return typeof w==="string"?w:"\\u"+("0000"+z.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+y+'"'}function c(y,z){var w,u,A,F,D=d,B,s=z[y];if(s&&typeof s==="object"&&typeof s.toJSON==="function")s=s.toJSON(y);if(typeof q==="function")s=q.call(z,y,s);switch(typeof s){case "string":return a(s);case "number":return isFinite(s)?String(s):"null";case "boolean":case "null":return String(s);case "object":if(!s)return"null";d+=f;B=[];if(Object.prototype.toString.apply(s)==="[object Array]"){F=s.length;for(w=0;w<F;w+=1)B[w]=c(w,s)||"null";A=B.length===0?"[]":d?"[\n"+d+B.join(",\n"+d)+"\n"+D+"]":"["+B.join(",")+"]";d=D;return A}if(q&&typeof q==="object"){F=q.length;for(w=0;w<F;w+=1){u=q[w];if(typeof u==="string")if(A=c(u,s))B.push(a(u)+(d?": ":":")+A)}}else for(u in s)if(Object.hasOwnProperty.call(s,u))if(A=c(u,s))B.push(a(u)+(d?": ":":")+A);A=B.length===0?"{}":d?"{\n"+d+B.join(",\n"+d)+"\n"+D+"}":"{"+B.join(",")+"}";d=D;return A}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,f,g={"":"\\b","\t":"\\t","\n":"\\n","":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},q;if(typeof h.stringify!=="function")h.stringify=function(y,z,w){var u;f=d="";if(typeof w==="number")for(u=0;u<w;u+=1)f+=" ";else if(typeof w==="string")f=w;if((q=z)&&typeof z!=="function"&&(typeof z!=="object"||typeof z.length!=="number"))throw Error("JSON.stringify");return c("",{"":y})};if(typeof h.parse!=="function")h.parse=function(y,z){function w(A,F){var D,B,s=A[F];if(s&&typeof s==="object")for(D in s)if(Object.hasOwnProperty.call(s,D)){B=w(s,D);if(B!==undefined)s[D]=B;else delete s[D]}return z.call(A,F,s)}var u;e.lastIndex=0;if(e.test(y))y=y.replace(e,function(A){return"\\u"+("0000"+A.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(y.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){u=eval("("+y+")");return typeof z==="function"?w({"":u},""):u}throw new SyntaxError("JSON.parse");}})();k.json=h;p.toggle=function(a,c,e){var b=0,d=function(){b?c():a();b=!b};d.reset=e?function(){c();b=0}:function(){b=0};return d};p.each=function(a,c){var e,b;for(b in a)if(a.hasOwnProperty(b))if(e=c(b,a[b],a))return e};fx=function(a,c,e){this.time=a=Math.floor(1E3/a);this.func=c;if(fx._intervals[a])fx._funcs[a].push(c);else{fx._funcs[a]=[];fx._funcs[a].push(c);fx._intervals[a]=setInterval(this._run(a),a)}if(e){fx._ids[e]=fx._ids[e]||[];fx._ids[e].push([a,c])}};fx._ids={};fx._intervals={};fx._funcs={};fx.prototype={_run:function(a){return function(){for(var c=fx._funcs[a],e=c.length-1;e>=0;e--)c[e]()}},_addFunc:function(a,c){fx._funcs[a]=fx._funcs[a]||[];fx._funcs[a].push(c)},_removeFunc:function(a,c){for(var e=fx._funcs[a],b=e.length-1;b>=0;b--)if(e[b]==c){e.splice(b,1);break}if(e.length==0){clearInterval(fx._intervals[a]);delete fx._intervals[a]}c.reset&&c.reset()},stop:function(a){if(a){if(fx._ids[a]){for(var c=0;c<fx._ids[a].length;c++)this._removeFunc(fx._ids[a][c][0],fx._ids[a][c][1]);delete fx._ids[a]}}else this._removeFunc(this.time,this.func)}};p.fx=fx;p.arrayIndexOf=function(a,c,e){var b=a.length;e=Number(e)||0;e=e<0?Math.ceil(e):Math.floor(e);if(e<0)e+=b;for(;e<b;e++)if(e in a&&a[e]===c)return e;return-1};if(document.addEventListener)var m=function(a,c,e){var b=false;a||J.out("targetModel undefined:"+c+e);if(!a._eventTypes)a._eventTypes={};a._eventTypes[c]||(a._eventTypes[c]=[]);a.addEventListener(c,e,false);a=a._eventTypes[c];for(c=0;c<a.length;c++)if(a[c]==e)b=true;b||a.push(e)},x=function(a,c,e){if(c)if(e){a.removeEventListener(c,e,false);if(a._eventTypes&&a._eventTypes[c])for(var b=a._eventTypes[c],d=0;d<b.length;d++)if(b[d]===e){b[d]=null;b.splice(d,1);break}}else{if(a._eventTypes&&a._eventTypes[c]){b=a._eventTypes[c];for(d=0;d<b.length;d++)a.removeEventListener(c,b[d],false);a._eventTypes[c]=[]}}else if(a._eventTypes){c=a._eventTypes;for(var f in c){b=a._eventTypes[f];for(d=0;d<b.length;d++)a.removeEventListener(f,b[d],false)}}};else if(document.attachEvent){m=function(a,c,e){if(r._find(arguments)==-1){var b=function(g){if(!g)g=window.event;g={_event:g,type:g.type,target:g.srcElement,currentTarget:a,relatedTarget:g.fromElement?g.fromElement:g.toElement,eventPhase:g.srcElement==a?2:3,clientX:g.clientX,clientY:g.clientY,screenX:g.screenX,screenY:g.screenY,layerX:g.offsetX,layerY:g.offsetY,pageX:g.clientX+document.body.scrollLeft,pageY:g.clientY+document.body.scrollTop,altKey:g.altKey,ctrlKey:g.ctrlKey,shiftKey:g.shiftKey,charCode:g.keyCode,keyCode:g.keyCode,stopPropagation:function(){this._event.cancelBubble=true},preventDefault:function(){this._event.returnValue=false}};if(Function.prototype.call)e.call(a,g);else{a._currentHandler=e;a._currentHandler(g);a._currentHandler=null}};a.attachEvent("on"+c,b);b={element:a,eventType:c,handler:e,wrappedEvent:b};var d=(a.document||a).parentWindow,f=r._uid();if(!d._allHandlers)d._allHandlers={};d._allHandlers[f]=b;if(!a._handlers)a._handlers=[];a._handlers.push(f);if(!d._onunloadEventRegistered){d._onunloadEventRegistered=true;d.attachEvent("onunload",r._removeAllEvents)}}};x=function(a){var c=r._find(arguments);if(c!=-1){for(var e=(a.document||a).parentWindow,b=0;b<c.length;b++){var d=c[b],f=a._handlers[d],g=e._allHandlers[f];a.detachEvent("on"+g.eventType,g.wrappedEvent);a._handlers[d]=null;a._handlers.splice(d,1);delete e._allHandlers[f]}if(a._handlers&&a._handlers.length==0)a._handlers=null}};r._find=function(a){var c=a[0],e=a[1],b=a[2],d=c._handlers;if(!d)return-1;c=(c.document||c).parentWindow;var f=[];if(a.length===3)for(a=d.length-1;a>=0;a--){var g=d[a];g=c._allHandlers[g];if(g.eventType==e&&g.handler==b){f.push(a);return f}}else if(a.length===2){for(a=d.length-1;a>=0;a--){g=d[a];g=c._allHandlers[g];g.eventType==e&&f.push(a)}if(f.length>0)return f}else if(a.length===1){for(a=d.length-1;a>=0;a--)f.push(a);if(f.length>0)return f}return-1};r._removeAllEvents=function(){for(var a in this._allHandlers){var c=this._allHandlers[a];c.element.detachEvent("on"+c.eventType,c.wrappedEvent);c.element._handlers=null;delete this._allHandlers[a]}};r._counter=0;r._uid=function(){return"h"+r._counter++}}r.off=x;r.on=m;(function(){var a={};v.template=function c(e,b){var d=!/\W/.test(e)?a[e]=a[e]||c(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return b?d(b):d}})();var o=function(){};o.prototype={bind:function(a,c){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(c)},unbind:function(a,c){this._events=this._events||{};a in this._events!==false&&this._events[a].splice(p.arrayIndexOf(this._events[a],c),1)},trigger:function(a){this._events=this._events||{};if(a in this._events!==false)for(var c=0;c<this._events[a].length;c++)this._events[a][c].apply(this,Array.prototype.slice.call(arguments,1))}};o.mixin=function(a){for(var c=["bind","unbind","trigger"],e=0;e<c.length;e++)a.prototype[c[e]]=o.prototype[c[e]]};k.view=function(a){this.init(a)};k.model=function(a){this.init(a)};k.collection=function(a){this.init(a)};k.controller=function(a){this.init(a)};k.view.eventParser=function(){this.init()};k.view.eventParser.prototype={init:function(){var a=this;this.op=[{"!":function(c,e,b){c=c.split(",");for(var d=c.length-1;d>=0;d--)if(a.match(c[d],e,b))return false;return true}},{".":function(c,e,b){return b.target.className==c},"#":function(c,e,b){return b.target.id==c},".~":function(c,e,b){return j.hasClass(b.target,c)},"..#":function(c,e,b){return _findPapa(b.target,"#"+c)()},"...":function(c,e,b){return _findPapa(b.target,"."+c)()}},{">":function(c,e,b,d){var f;f=c.split(">");c=f[0];f=f[1];if((f=="*"||a.match(f,e,b))&&(d=_findPapa(b.target,c)()))return[true,{target:d,stopPropagation:function(){b.stopPropagation()}}];return false}}];this.op2Level=["!",[".","#",".~","...","..#"],">"]},match:function(a,c,e){var b;if(a.indexOf(this.op2Level[2])>-1)return this.op[2][this.op2Level[2]](a,c,e,b);else for(var d=3;d>0;){if(b=this.op[1][a.substr(0,d)])if(b(a.substr(d),c,e))return true;d--}return false},router:function(a,c,e,b){if(b=this.op[0][a.charAt(0)]){if(b(a.substr(1),c,e))return true}else{var d=a.split(",");for(b=d.length-1;b>=0;b--)if(a=this.match(d[b],c,e))return a}return false},parse:function(a,c,e){a=this.router(a,c,e);if(a.length==2)c(a[1]);else a&&c(e)}};k.view.eventParser=new k.view.eventParser;k.view.prototype={init:function(a,c){c&&this.initOption(c);if(a)this._data=a},initOption:function(a){this.beforeRender=a.beforeRender||this.beforeRender},afterInit:function(){},render:function(){if(this.target&&typeof this.target=="string")this.target=j.id(this.target);if((this.template||this.html)&&this.target){if(this.template)var a=v.template(this.template,this._data);else if(this.html)a=this.html;if(this.container){var c=this.container.pop();if(typeof c!="function"){this.container.push(c);c=null}this.el=j.node.apply(null,this.container);if(c){c(this.el,this);this.container.push(c)}this.el.innerHTML=a;this.beforeRender(this.el);this.target.appendChild(this.el)}else{this.el=this.target;this.beforeRender(this.el);this.el.innerHTML=a}this.events&&this.initEvents();this.incrId()}else if(this.target&&this.events){this.el=this.target;this.initEvents()}},beforeRender:function(){},afterRender:function(){},update:function(a){this._data=a;this.removeEvents();if(this.template&&this.target){a=v.template(this.template,this._data);if(this.container){var c=this.container.pop();if(typeof c!="function"){this.container.push(c);c=null}if(c){c(this.el,this);this.container.push(c)}}else this.el=this.target;this.beforeRender(this.el);this.el.innerHTML=a;this.events&&this.initEvents()}},hash:{"#":"id",".":"className","@":"el","!":"!"},eventsNotBubble:{"@click":1,blur:1,focus:1,change:1},initEvents:function(){var a={},c=this,e=this.hash,b=this.eventsNotBubble;p.each(this.events,function(d,f){if(typeof f=="string")f=c.observers[f];var g=f;f=function(){Array.prototype.push.call(arguments,c);g.apply(this,arguments)};var q=d.split(" "),y=q[0];q=q[1];a[q]=a[q]||[];a[q].push([y,f]);this._events=a});p.each(a,function(d,f){if(b[d])for(var g=f.length-1;g>=0;g--)for(var q=f[g][0].split(","),y=q.length-1;y>=0;y--){var z=e[q[y].charAt(0)];if(z=="id")r.on(j.id(q[y].substr(1)),d,f[g][1]);else if(z=="el")r.on(c.el,d.substr(1),f[g][1])}else r.on(c.el,d,function(w){for(var u=f.length-1;u>=0;u--)k.view.eventParser.parse(f[u][0],f[u][1],w)})})},removeEvents:function(){var a=this,c=this.hash,e=this.eventsNotBubble;p.each(this.events,function(b,d){if(e[b])for(var f=d.length-1;f>=0;f--)for(var g=d[f][0].split(","),q=g.length-1;q>=0;q--){type=c[g[q].split("")[0]];if(type=="id")r.off(j.id(g[q].substr(1)));else type=="el"&&r.off(a.el)}});r.off(a.el)},id:function(a){this._domsCache=this._domsCache||{};return this._domsCache[a]?this._domsCache[a]:this._domsCache[a]=j.id(a)},destory:function(){delete this._domsCache;this.removeEvents();this.el.parentNode.removeChild(this.el)},_id:0,incrId:function(){},getCount:function(){},setId:function(a){this.__id=a},getId:function(){return this.__id},show:function(){this.isShow=true;j.show(this.el)},hide:function(){this.isShow=false;j.hide(this.el)}};k.controller.prototype={init:function(){if(this.collection){var a=this;this._hash={};this.collection=new this.collection;this.key=this.collection.key;this.collection.bind("add",function(c,e){a.add(c,e)});this.collection.bind("update",function(c,e){a.update(c,e)});this.collection.bind("remove",function(c){a.remove(c)})}},feed:function(a,c){this.collection.init(a,c)},bite:function(a,c){this.collection.add(a,c)},puke:function(a){this.collection.remove(a)},find:function(a){return this._hash[a]},add:function(a,c){var e=this,b=new this.view(a,c);b.setId(a[this.key]);this._hash[b.getId()]=b;p.each(this.viewObserver,function(d,f){var g=f;b.bind(d,function(){Array.prototype.push.call(arguments,e);g.apply(this,arguments)})});b.afterInit(c);b.render();b.afterRender(c)},update:function(a,c){this.find(a[this.key]).update(a,c)},remove:function(a){this.find(a).destory();delete this._hash[a]}};k.collection.prototype={init:function(a,c){if(a){var e=this;p.each(a,function(b,d){e.add(d,c)})}else{this._hash={};this._queue=[]}},key:"id",find:function(a){return this._hash[a]},add:function(a,c){if(this._hash[a[this.key]])this.update(a,c);else{var e=new this.model(a),b=e[this.key];this._hash[b]=e;this._queue.push(b);this.trigger("add",e,c)}},update:function(a,c){var e=this.find(a[this.key]);p.each(a,function(b,d){e.setter(b,d)});this.trigger("update",e,c)},getFirst:function(){return this.find(this._queue[0])[this.key]},getLast:function(){return this.find(this._queue[this._queue.length-1])[this.key]},getLength:function(){return this._queue.length},insertBefore:function(a){var c=p.arrayIndexOf(this._queue,a);if(c>-1){this._queue.splice(c,1);this._queue.unshift(a)}},remove:function(a){delete this._hash[a];var c=p.arrayIndexOf(this._queue,a);c>-1&&this._queue.splice(c,1);this.trigger("remove",a)},filter:function(a){var c=[];p.each(this._hash,function(e,b){var d=false;p.each(a,function(f,g){g=g.toLowerCase();if(String(b[f]).toLowerCase().indexOf(g)!=-1)d=true;return d});d&&c.push(b)});return c},map:function(a){p.each(this._hash,function(c,e){a(c,e)})}};k.model.prototype={init:function(a){var c=this;a&&p.each(a,function(e,b){c.setter(e,b)})},setter:function(a,c){this[a]=this.map(a,c,this);var e=this.xss[a];if(e)this[e]=v.encodeHtmlSimple(c);return this},getter:function(a){return this[a]},xss:{},map:function(a,c){return c},toString:function(){var a={};p.each(this,function(c,e){a[c]=e});return k.json.stringify(a)}};o.mixin(k.view);o.mixin(k.controller);o.mixin(k.collection);o.mixin(k.model);k.controller.extend=k.collection.extend=k.model.extend=k.view.extend=function(a){var c=function(){arguments[0]&&this.init.apply(this,[].slice.call(arguments))},e;e=c.prototype=new this;for(var b in a)if(a.hasOwnProperty(b))if(b=="init"){var d=a.init,f=e.init;delete e.init;e.init=function(g){f.call(this,g);d.call(this,g)}}else e[b]=a[b];return e.constructor=c}})();(function(){var k=webq.framework,j=k.dom,v=k.view,r=k.model,p=k.collection,t=k.controller,l=k.func,h=k.event;k=[];webq.module={};webq.CONST={msg_id:0,MAIN_DOMAIN:"qq.com",CLIENTID:String(Math.round(Math.random()*100)+(new Date).getTime()%1E6),CONN_SERVER_DOMAIN:"http://t.web2.qq.com/",CONN_PROXY_URL:"http://t.web2.qq.com/proxy.html?v=20110331001",SYSTEM_FACE_URL:"http://mat1.gtimg.com/www/mb/images/face/",DEFAULT_FACE_URL:"http://mat1.gtimg.com/www/mb/css/webqq/images/default_30.jpg",MAX_LOGIN_AMOUNT:1,MAX_FAIL_AMOUNT:2,Z_INDEX_BASE:3E3,LOAD_AVATAR_AMOUNT:50,TRANSFER_TABLE:[14,1,2,3,4,5,6,7,8,9,10,11,12,13,0,50,51,96,53,54,73,74,75,76,77,78,55,56,57,58,79,80,81,82,83,84,85,86,87,88,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,32,113,114,115,63,64,59,33,34,116,36,37,38,91,92,93,29,117,72,45,42,39,62,46,47,71,95,118,119,120,121,122,123,124,27,21,23,25,26,125,126,127,128,129,130,131,132,133,134,52,24,22,20,60,61,89,90,31,94,65,35,66,67,68,69,70,15,16,17,18,19,28,30,40,41,43,44,48,49],T_TRANSFER_TABLE:{14:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,0:14,50:15,51:16,96:17,53:18,54:19,73:20,74:21,75:22,76:23,77:24,78:25,55:26,56:27,57:28,58:29,79:30,80:31,81:32,82:33,83:34,84:35,85:36,86:37,87:38,88:39,97:40,98:41,99:42,100:43,101:44,102:45,103:46,104:47,105:48,106:49,107:50,108:51,109:52,110:53,111:54,112:55,32:56,113:57,114:58,115:59,63:60,64:61,59:62,33:63,34:64,116:65,36:66,37:67,38:68,91:69,92:70,93:71,29:72,117:73,72:74,45:75,42:76,39:77,62:78,46:79,47:80,71:81,95:82,118:83,119:84,120:85,121:86,122:87,123:88,124:89,27:90,21:91,23:92,25:93,26:94,125:95,126:96,127:97,128:98,129:99,130:100,131:101,132:102,133:103,134:104,52:105,24:106,22:107,20:108,60:109,61:110,89:111,90:112,31:113,94:114,65:115,35:116,66:117,67:118,68:119,69:120,70:121,15:122,16:123,17:124,18:125,19:126,28:127,30:128,40:129,41:130,43:131,44:132,48:133,49:134},FACE_2_SHORTCUT:["/微笑","/撇嘴","/色","/发呆","/得意","/流泪","/害羞","/闭嘴","/睡","/大哭","/尴尬","/发怒","/调皮","/呲牙","/惊讶","/难过","/酷","/冷汗","/抓狂","/吐","/偷笑","/可爱","/白眼","/傲慢","/饥饿","/困","/惊恐","/流汗","/憨笑","/大兵","/奋斗","/咒骂","/疑问","/嘘...","/晕","/折磨","/衰","/骷髅","/敲打","/再见","/擦汗","/抠鼻","/鼓掌","/糗大了","/坏笑","/左哼哼","/右哼哼","/哈欠","/鄙视","/委屈","/快哭了","/阴险","/亲亲","/吓","/可怜","/菜刀","/西瓜","/啤酒","/篮球","/乒乓","/咖啡","/饭","/猪头","/玫瑰","/凋谢","/示爱","/爱心","/心碎","/蛋糕","/闪电","/炸弹","/刀","/足球","/瓢虫","/便便","/月亮","/太阳","/礼物","/拥抱","/强","/弱","/握手","/胜利","/抱拳","/勾引","/拳头","/差劲","/爱你","/NO","/OK","/爱情","/飞吻","/跳跳","/发抖","/怄火","/转圈","/磕头","/回头","/跳绳","/挥手","/激动","/街舞","/献吻","/左太极","/右太极"],SHORTCUT_2_FACE:{"/微":{"/微笑":14},"/撇":{"/撇嘴":1},"/色":{"/色":2},"/发":{"/发呆":3,"/发怒":11,"/发抖":41},"/得":{"/得意":4},"/流":{"/流泪":5,"/流汗":27,"/流淚":5},"/害":{"/害羞":6},"/闭":{"/闭嘴":7},"/睡":{"/睡":8},"/大":{"/大哭":9,"/大兵":29},"/尴":{"/尴尬":10},"/调":{"/调皮":12},"/呲":{"/呲牙":13},"/惊":{"/惊讶":0,"/惊恐":26},"/难":{"/难过":15},"/酷":{"/酷":16},"/冷":{"/冷汗":96},"/抓":{"/抓狂":18},"/吐":{"/吐":19},"/偷":{"/偷笑":20},"/可":{"/可爱":21,"/可怜":111,"/可愛":21,"/可憐":111},"/白":{"/白眼":22},"/傲":{"/傲慢":23},"/饥":{"/饥饿":24},"/困":{"/困":25},"/憨":{"/憨笑":28},"/奋":{"/奋斗":30},"/咒":{"/咒骂":31,"/咒罵":31},"/疑":{"/疑问":32,"/疑問":32},"/嘘":{"/嘘...":33},"/晕":{"/晕":34},"/折":{"/折磨":35},"/衰":{"/衰":36},"/骷":{"/骷髅":37,"/骷髏":37},"/敲":{"/敲打":38},"/再":{"/再见":39,"/再見":39},"/擦":{"/擦汗":97},"/抠":{"/抠鼻":98},"/鼓":{"/鼓掌":99},"/糗":{"/糗大了":100},"/坏":{"/坏笑":101},"/左":{"/左哼哼":102,"/左太极":133,"/左太極":133},"/右":{"/右哼哼":103,"/右太极":134,"/右太極":134},"/哈":{"/哈欠":104},"/鄙":{"/鄙视":105,"/鄙視":105},"/委":{"/委屈":106},"/快":{"/快哭了":107},"/阴":{"/阴险":108},"/亲":{"/亲亲":109},"/吓":{"/吓":110},"/菜":{"/菜刀":112},"/西":{"/西瓜":89},"/啤":{"/啤酒":113},"/篮":{"/篮球":114},"/乒":{"/乒乓":115},"/咖":{"/咖啡":60},"/饭":{"/饭":61},"/猪":{"/猪头":46},"/玫":{"/玫瑰":63},"/凋":{"/凋谢":64},"/示":{"/示爱":116,"/示愛":116},"/爱":{"/爱心":66,"/爱你":122,"/爱情":42},"/心":{"/心碎":67},"/蛋":{"/蛋糕":53},"/闪":{"/闪电":54},"/炸":{"/炸弹":55,"/炸彈":55},"/刀":{"/刀":56},"/足":{"/足球":57},"/瓢":{"/瓢虫":117,"/瓢蟲":117},"/便":{"/便便":59},"/月":{"/月亮":75},"/太":{"/太阳":74,"/太陽":74},"/礼":{"/礼物":69},"/拥":{"/拥抱":49},"/强":{"/强":76},"/弱":{"/弱":77},"/握":{"/握手":78},"/胜":{"/胜利":79},"/抱":{"/抱拳":118},"/勾":{"/勾引":119},"/拳":{"/拳头":120,"/拳頭":120},"/差":{"/差劲":121,"/差勁":121},"/N":{"/NO":123},"/O":{"/OK":124},"/飞":{"/飞吻":85},"/跳":{"/跳跳":43,"/跳绳":128,"/跳繩":128},"/怄":{"/怄火":86},"/转":{"/转圈":125},"/磕":{"/磕头":126,"/磕頭":126},"/回":{"/回头":127,"/回頭":127},"/挥":{"/挥手":129},"/激":{"/激动":130,"/激動":130},"/街":{"/街舞":131},"/献":{"/献吻":132},"/發":{"/發呆":3,"/發怒":11,"/發抖":41},"/閉":{"/閉嘴":7},"/尷":{"/尷尬":10},"/調":{"/調皮":12},"/驚":{"/驚訝":0,"/驚恐":26},"/難":{"/難過":15},"/饑":{"/饑餓":24},"/奮":{"/奮鬥":30},"/噓":{"/噓...":33},"/暈":{"/暈":34},"/摳":{"/摳鼻":98},"/壞":{"/壞笑":101},"/陰":{"/陰險":108},"/親":{"/親親":109},"/嚇":{"/嚇":110},"/籃":{"/籃球":114},"/飯":{"/飯":61},"/豬":{"/豬頭":46},"/雕":{"/雕謝":64},"/愛":{"/愛心":66,"/愛你":122,"/愛情":42},"/閃":{"/閃電":54},"/禮":{"/禮物":69},"/擁":{"/擁抱":49},"/強":{"/強":76},"/勝":{"/勝利":79},"/飛":{"/飛吻":85},"/慪":{"/慪火":86},"/轉":{"/轉圈":125},"/揮":{"/揮手":129},"/獻":{"/獻吻":132}}};if(typeof MILang!="undefined"&&MILang=="zh_TW")webq.CONST.FACE_2_SHORTCUT=["/微笑","/撇嘴","/色","/發呆","/得意","/流淚","/害羞","/閉嘴","/睡","/大哭","/尷尬","/發怒","/調皮","/呲牙","/驚訝","/難過","/酷","/冷汗","/抓狂","/吐","/偷笑","/可愛","/白眼","/傲慢","/饑餓","/困","/驚恐","/流汗","/憨笑","/大兵","/奮鬥","/咒罵","/疑問","/噓...","/暈","/折磨","/衰","/骷髏","/敲打","/再見","/擦汗","/摳鼻","/鼓掌","/糗大了","/壞笑","/左哼哼","/右哼哼","/哈欠","/鄙視","/委屈","/快哭了","/陰險","/親親","/嚇","/可憐","/菜刀","/西瓜","/啤酒","/籃球","/乒乓","/咖啡","/飯","/豬頭","/玫瑰","/雕謝","/示愛","/愛心","/心碎","/蛋糕","/閃電","/炸彈","/刀","/足球","/瓢蟲","/便便","/月亮","/太陽","/禮物","/擁抱","/強","/弱","/握手","/勝利","/抱拳","/勾引","/拳頭","/差勁","/愛你","/NO","/OK","/愛情","/飛吻","/跳跳","/發抖","/慪火","/轉圈","/磕頭","/回頭","/跳繩","/揮手","/激動","/街舞","/獻吻","/左太極","/右太極"];for(var m=0;m<105;m++)k.push('<div class="EQQ_qqfaces" title="'+webq.CONST.FACE_2_SHORTCUT[m]+'" id="EQQ_qqface_'+m+'" ></div>');k=k.join("");k='            <div style="display:none;" class="EQQ_faceSelection" id="EQQ_FaceSelection" style="display:none">                '+k+'            </div>            <div id="EQQ_MainPanel" class="EQQ_mainPanel">                <div class="EQQ_title">                    <div style="display:none;" id="EQQ_CloseButton" class="EQQ_CloseButton" title="'+_("隐藏好友列表")+'">'+_("最小化")+'</div>                    <a href="#"><div id="EQQ_MinButton" class="EQQ_MinButton" title="'+_("最小化")+'">'+_("最小化")+'</div></a>                    <a class="EQQ_FeedbackButton2" href="http://support.qq.com/portal/discuss_pdt/420_1.html" target="_blank">'+_("反馈")+'</a>                    <ul id="EQQ_SettingPanel" class="EQQ_SettingPanel" style="display:none;"><a href="#" onclick="return false;"><li flag="online" class="EQQ_SettingPanel_item" style="margin-top:6px;">                            <div class="EQQ_setIcon EQQ_setOnlineIcon">icon</div>                            <div class="EQQ_SettingPanel_Text">'+_("在线")+'</div>                        </li></a><a href="#" onclick="return false;">                        <li title="'+_("断开服务器连接")+'" flag="offline" class="EQQ_SettingPanel_item">                            <div class="EQQ_setIcon EQQ_setOfflineIcon">icon</div>                            <div class="EQQ_SettingPanel_Text">'+_("离线")+'</div>                        </li></a><a href="#" onclick="return false;">                        <li title="'+_("不接受实时聊天消息")+'" flag="lock" class="EQQ_SettingPanel_item">                            <div class="EQQ_setIcon EQQ_setLockIcon">icon</div>                            <div class="EQQ_SettingPanel_Text">'+_("禁用")+'</div>                        </li></a>                    </ul>\t<a href="#" onclick="return false;">\t                    <div id="EQQ_SettingButton" class="EQQ_settingButton" title="'+_("设置")+'">\t                        <div class="EQQ_settingButtonIcon">'+_("下")+'</div>\t                        <div id="EQQ_settingButtonText" class="EQQ_settingButtonText">'+_("设置")+'</div>\t                    </div>\t</a>                    <div class="EQQ_titleText">'+_("在线互听")+'<span id="EQQ_onlineCount">(0)</span></div>                    <div class="EQQ_betaText" title="1.0.10.12"></div>                </div>                <div style="display:none;" id="EQQ_MyPanel" class="EQQ_myPanel">                    <div class="EQQ_myInfo">                        <div id="EQQ_MyState" class="EQQ_myState" title="'+_("我的状态")+'">                            <div id="EQQ_MyStateShow" class="EQQ_myStateShow EQQ_offline">'+_("状态")+'</div>                            <div class="EQQ_myStateDown">'+_("下")+'</div>                        </div>                        <div id="EQQ_MyNick" class="EQQ_myNick" title="'+_("昵称")+'">'+_("昵称")+'</div>                        <ul id="EQQ_StateSelectPanel" class="EQQ_stateSelectPanel">                            <li id="EQQ_SetOnline" state="online"><div class="EQQ_stateSelect_icon EQQ_online"></div><div class="EQQ_stateSelect_text">'+_("我在线上")+'</div></li>                            <li id="EQQ_SetCallme" state="callme"><div class="EQQ_stateSelect_icon EQQ_callme"></div><div class="EQQ_stateSelect_text">Q'+_("我吧")+'</div></li>                            <li id="EQQ_SetAway" state="away"><div class="EQQ_stateSelect_icon EQQ_away"></div><div class="EQQ_stateSelect_text">'+_("离开")+'</div></li>                            <li id="EQQ_SetBusy" state="busy"><div class="EQQ_stateSelect_icon EQQ_busy"></div><div class="EQQ_stateSelect_text">'+_("忙碌")+'</div></li>                            <li id="EQQ_SetSilent" state="silent"><div class="EQQ_stateSelect_icon EQQ_silent"></div><div class="EQQ_stateSelect_text">'+_("请勿打扰")+'</div></li>                            <li id="EQQ_SetHidden" state="hidden"><div class="EQQ_stateSelect_icon EQQ_hidden"></div><div class="EQQ_stateSelect_text">'+_("隐身")+'</div></li>                            <li id="EQQ_SetOffline" state="offline"><div class="EQQ_stateSelect_icon EQQ_offline"></div><div class="EQQ_stateSelect_text">'+_("离线")+'</div></li>                        </ul>                    </div>                    <div id="EQQ_MySignature" class="EQQ_mySignature" title="'+_("载入中")+'...">'+_("载入中")+'...</div>                </div>                <div id="EQQ_YellowTips" class="EQQ_YellowTips">                    <div id="EQQ_YellowTips_CloseButton" class="EQQ_YellowTips_CloseButton" title="'+_("关闭提示")+'">X</div>                    <a class="EQQ_YellowTips_Link" href="http://survey.qq.com/cgi-bin/submitsurvey?id=2473&qpage=1&page=1&rm=dnN4k1bBG" target="_blank">'+_("邀请参与")+"WebQQ"+_("用户调查")+'</a>                </div>                <div id="EQQ_SearchBar" class="EQQ_SearchBar">                    <input id="EQQ_SearchBox" class="EQQ_SearchBox" name="EQQ_SearchBox" type="text" value="'+_("输入微博帐号")+'..." title="'+_("直接输入微博帐号")+'..." />                    <div id="EQQ_SearchButton" class="EQQ_SearchButton" title="'+_("回车打开会话窗口")+'">'+_("搜索按钮")+'</div>                </div>                <div id="EQQ_SearchResultPanel" class="EQQ_SearchResultPanel">                    <div class="EQQ_SearchResultItem" title="">Kevity1(666666)</div>                    <div class="EQQ_SearchResultItemHover" title="">Kevity2(666666)</div>                    <div class="EQQ_SearchResultItem" title="">Kevity3(66666)</div>                </div>                <div id="EQQ_Logining" class="EQQ_Logining">'+_("登录中")+'...</div>                <div id="EQQ_ReLoginPanel" class="EQQ_ReLoginPanel">            '+_("登录失败")+'，<span id="EQQ_ReLoginButton" class="EQQ_ReLoginButton">'+_("重试")+'</span>                </div>                <\!--                <div id="EQQ_VerifyPanel" class="EQQ_VerifyPanel">                    <div id="EQQ_VerifyText" class="EQQ_VerifyText">'+_("请输入验证码")+'</div>                    <div id="EQQ_VerifyTip" class="EQQ_VerifyTip">'+_("输入验证码有误")+","+_("请重试")+'</div><input type="text" id="EQQ_VerifyInput" class="EQQ_VerifyInput" maxlength=4 />                    <img id="EQQ_VerifyImg" class="EQQ_VerifyImg" src="http://imgcache.qq.com/ac/b.gif" />                    <a id="EQQ_VerifyChange" class="EQQ_VerifyChange" href="#">'+_("换一张")+'</a>                    <div id="EQQ_VerifySummit" class="EQQ_VerifySummit"></div>                </div>                --\>                <div style="display:none;" id="EQQ_BuddyList" class="EQQ_buddyList">\t<div id="EQQ_listClassHead_0" class="EQQ_listClassHeadCollapsed" classIndex="0"><div class="EQQ_listClassHeadIcon">icon</div><div class="EQQ_ClassList_RightContainer" title="">\t&nbsp;[<span id="EQQ_Class_0_OnlineCounter"></span>/<span id="EQQ_Class_0_Counter"></span>]</div>\t</div>\t<div id="EQQ_listClassBody_0" class="EQQ_listClassBody"><div id="EQQ_Class_0_callme" class="EQQ_callmeBuddy"></div><div style="display:block;" id="EQQ_Class_0_online" class="EQQ_onlineBuddy"></div><div id="EQQ_Class_0_busy" class="EQQ_busyBuddy"></div><div id="EQQ_Class_0_away" class="EQQ_awayBuddy"></div><div id="EQQ_Class_0_silent" class="EQQ_silentBuddy"></div><div id="EQQ_Class_0_offline" class="EQQ_offlineBuddy"></div>\t</div>                </div>            </div>            <\!--            <div id="EQQ_MsgBox" class="EQQ_msgBox">                <div class="EQQ_titleInMsgBox">                    <div class="EQQ_titleTextInMsgBox">'+_("消息盒子")+'</div>                    <div id="EQQ_ViewMainPanelButtonInMsgBox" class="EQQ_viewMainPanelButtonInMsgBox" title="'+_("点击查看好友列表")+'">'+_("好友列表")+'</div>                </div>                <div id="EQQ_MessageList" class="EQQ_messageList">                </div>                <div id="EQQ_IgnoreAllMsgButtonInMsgBox" class="EQQ_ignoreAllMsgButtonInMsgBox" title="'+_("点击忽略全部消息")+'">'+_("忽略全部")+'</div>            </div>            <div id="EQQ_LoginBox" class="EQQ_LoginBox">                <div class="EQQ_LoginBox_Title">                    <div id="EQQ_LoginBox_CloseButton" class="EQQ_LoginBox_CloseButton" title="'+_("关闭")+'">X</div>                    <div class="EQQ_LoginBox_TitleText">WebQQ'+_("登录保护")+"</div>                </div>            </div>            --\>    ";m=v.extend({target:"EQQ_Container",container:["div",{"class":"EQQ_global_yellowTips"}],template:'        <div style="width:<%=width+8%>px" class="EQQ_global_yellowTips_content">            <div class="EQQ_global_yellowTips_content_left"></div>            <div style="width:<%=width%>px" class="EQQ_global_yellowTips_content_middle">                <div class="EQQ_global_yellowTips_content_middle_text">                    <%=text%>                </div>                <div class="EQQ_global_yellowTips_content_middle_close">                </div>            </div>            <div class="EQQ_global_yellowTips_content_right"></div>        </div>        <div class="EQQ_global_yellowTips_arrow">^</div>        ',events:{".EQQ_global_yellowTips_content_middle_close click":function(i,n){n.trigger("puke",n.getId())}},resetPosition:function(i){var n=j.getClientWidth(),C=j.getClientHeight(),E=j.getClientXY(i);i=E[1];n-=E[0]+parseInt(this.id("EQQ_Container").style.right)+25;this.el.style.right=n-this._data.width+25+"px";this.el.style.bottom=C-i+3+"px"},delayClose:function(i){var n=this;setTimeout(function(){try{n.trigger("puke",n.getId())}catch(C){}},i*1E3)}});r=r.extend({map:function(i,n,C){if(i=="text"){i=n.replace(/[^\x00-\xff]/g,"aa");C.width=Math.floor(Math.round(i.length/2)*14.5)}return n}});p=p.extend({model:r,key:"type"});t=new (t.extend({collection:p,view:m,viewObserver:{puke:function(i,n){n.puke(i)}}}))({});var x=v.extend({target:"EQQ_SearchResultPanel",template:'\t<% for(var i=0;i<results.length;i++) {%><div flag="<%=results[i].id%>" class="EQQ_SearchResultItem" title=""><%=results[i].htmlNick%>(<%=results[i].id%>)</div>\t<% } %>',events:{".EQQ_SearchResultItem click":function(i){i=i.target.getAttribute("flag");i=webq.module.buddyList.collection.find(i);webq.module.taskBar.chat(i);webq.module.chatBox.chat(i)}},arrowDown:function(i){if(!this.isHide){if(this.pointer){this.pointer[0][this.pointer[1]].className="EQQ_SearchResultItem";if(i)this.pointer[1]--;else this.pointer[1]++;this.pointer[1]=(this.pointer[1]+this.pointer[2])%this.pointer[2]}else{i=j.getElementsByClassName(this.el,"div","EQQ_SearchResultItem");this.pointer=[i,0,i.length]}this.pointer[0][this.pointer[1]].className="EQQ_SearchResultItemHover"}},arrowUp:function(){this.arrowDown(true)},hide:function(){this.isHide=true;j.hide(this.el);this.pointer=null},show:function(){this.isHide=false;this.pointer=null;j.show(this.el)}}),o,a=v.extend({target:"EQQ_Container",events:{"#EQQ_ExtendButton,#EQQ_ExtendButton>.EQQ_extendButton_bg click":function(i,n){if(n.isTaskBarRightExtend())n.hideTaskBar();else n.isTaskBarLeftExtend()&&n.showTaskBar()},"!.faceButtonInChatbox click":function(){b.hideFacePanel()},"@ @click":function(i,n){i.stopPropagation();o&&o.hide();n.hideSettingPanel();e.reset()}},hideTaskBar:function(){if(this.isTaskBarRightExtend()){this.id("EQQ_ExtendButton").className="EQQ_leftExtendButton";this.taskBarWidth=parseInt(this.id("EQQ_TaskBar").style.width);this.id("EQQ_TaskBar").style.width="17px";j.hide(this.id("EQQ_ChatBuddyList"))}},showTaskBar:function(){if(this.isTaskBarLeftExtend()){this.id("EQQ_ExtendButton").className="EQQ_rightExtendButton";j.show(this.id("EQQ_ChatBuddyList"));this.id("EQQ_TaskBar").style.width=this.taskBarWidth+"px";this.unflashTaskBar()}},TASKWIDTH:35,taskAdd:function(){var i=this.TASKWIDTH;if(this.id("EQQ_ExtendButton").className=="EQQ_noExtendButton"){var n=17+i;i=0+i}else{n=this.isTaskBarLeftExtend()?this.taskBarWidth+=i:parseInt(this.id("EQQ_TaskBar").style.width||17)+i;i=parseInt(this.id("EQQ_ChatBuddyList").style.width||0)+i}this.id("EQQ_ExtendButton").className="EQQ_rightExtendButton";this.id("EQQ_TaskBar").style.width=n+"px";this.id("EQQ_ChatBuddyList").style.width=i+"px";j.show(this.id("EQQ_ChatBuddyList"))},taskRemove:function(){var i=this.TASKWIDTH;if(this.isTaskBarLeftExtend()){this.taskBarWidth-=i;i=parseInt(this.id("EQQ_ChatBuddyList").style.width||0)-i;this.id("EQQ_ChatBuddyList").style.width=i+"px";if(this.taskBarWidth==17){this.id("EQQ_ExtendButton").className="EQQ_noExtendButton";this.id("EQQ_TaskBar").style.width="2px"}}else{var n=parseInt(this.id("EQQ_TaskBar").style.width||17)-i;i=parseInt(this.id("EQQ_ChatBuddyList").style.width||0)-i;if(n==17){this.id("EQQ_ExtendButton").className="EQQ_noExtendButton";this.id("EQQ_TaskBar").style.width="2px"}else this.id("EQQ_TaskBar").style.width=n+"px";this.id("EQQ_ChatBuddyList").style.width=i+"px"}},flashMainBar:function(){if(!b.isMainPanelShow){var i=this.id("EQQ_StartButtonIcon");this.unflashMainBar();j.addClass(i,"EQQ_startButtonIconRadio");this.isMainBarFlashing=new l.fx(4,l.toggle(function(){j.addClass(i,"EQQ_startButtonIconFlash")},function(){j.removeClass(i,"EQQ_startButtonIconFlash")},true))}},unflashMainBar:function(){if(this.isMainBarFlashing){var i=this.id("EQQ_StartButtonIcon");j.removeClass(i,"EQQ_startButtonIconRadio");this.isMainBarFlashing.stop();this.isMainBarFlashing=null}},flashTaskBar:function(){if(this.isTaskBarLeftExtend()){var i=this.id("EQQ_ExtendButton");this.unflashTaskBar();this.isTaskBarFlashing=new l.fx(4,l.toggle(function(){j.addClass(i,"EQQ_flashExtendButton")},function(){j.removeClass(i,"EQQ_flashExtendButton")},true))}},unflashTaskBar:function(){if(this.isTaskBarFlashing){this.isTaskBarFlashing.stop();this.isTaskBarFlashing=null}},isTaskBarLeftExtend:function(){return j.hasClass(this.id("EQQ_ExtendButton"),"EQQ_leftExtendButton")},isTaskBarRightExtend:function(){return j.hasClass(this.id("EQQ_ExtendButton"),"EQQ_rightExtendButton")},showSettingPanel:function(){this.id("EQQ_SettingButton").className="EQQ_settingButton_buttonDown";j.show(this.id("EQQ_SettingPanel"))},hideSettingPanel:function(){this.id("EQQ_SettingButton").className="EQQ_settingButton";j.hide(this.id("EQQ_SettingPanel"))}});a=new a;a.render();var c=l.toggle(function(){b.show();a.unflashMainBar();j.addClass(d,"EQQ_startButtonDown");webq.module.buddyList.initAvatar();MI.WebQQ.report2m(151290)},function(){b.hide();j.removeClass(d,"EQQ_startButtonDown")}),e=l.toggle(function(){a.showSettingPanel()},function(){a.hideSettingPanel()},true);p=v.extend({target:"EQQ_Container",container:["div"],html:k,afterRender:function(){var i=this;if(MI.AutoCmt){o=new MI.AutoCmt({target:i.id("EQQ_SearchBox"),key:0,tips:_("输入微博帐号，发起聊天"),topic:1,maxWidth:159,face:1,call:function(n){n.stop();n=i.id("EQQ_SearchBox");var C=n.value;n.blur();setTimeout(function(){var E=webq.module.buddyList.collection.find(C);if(E){webq.module.taskBar.chat(E);webq.module.chatBox.chat(E)}else i.remoteAtChat()},0)}});UI.EA(window,"scroll",function(){o.hide()})}},observers:{search:function(i,n){var C=n.id("EQQ_SearchBox").value;C=C.split("@").join("");if(C!=""){C=webq.module.buddyList.collection.filter({nick:C,id:C});if(C.length){var E;if(E=n.searchResultView)n.searchResultView.update({results:C.slice(0,5)});else{E=n.searchResultView=new x({results:C.slice(0,5)});E.render()}E.show();n.searchKeyWord=null}}n.id("EQQ_SearchBox").focus()}},events:{".EQQ_SearchButton click":function(){},".EQQ_SearchBox keyup":function(){},"!.faceButtonInChatbox click":function(){b.hideFacePanel()},"#EQQ_SearchBox click":function(i){if(i.target.value==_("输入微博帐号")+"..."){i.target.value="";i.target.style.color="black"}},"#EQQ_SearchBox blur":function(i,n){if(i.target.value==""){i.target.value=_("输入微博帐号...");i.target.style.color="#999"}setTimeout(function(){if(n.searchResultView)n.searchResultView.isHide||n.searchResultView.hide()},2E3)},".EQQ_qqfaces click":function(i,n){webq.module.chatBox.appendFace(i.target.title);n.hideFacePanel()},".EQQ_settingButton,.EQQ_settingButtonIcon,#EQQ_settingButtonText click":function(i){i.preventDefault();e()},"!.EQQ_settingButton,.EQQ_settingButtonIcon,#EQQ_settingButtonText click":function(i){i.preventDefault();a.hideSettingPanel();e.reset()},".~EQQ_SettingPanel_item,.~EQQ_setIcon,.EQQ_SettingPanel_Text click":function(i,n){for(var C=j.findPapa()(i.target,"EQQ_SettingPanel_item"),E=j.getElementsByClassName(n.id("EQQ_SettingPanel"),"li","EQQ_SettingPanel_item"),G=E.length-1;G>=0;G--)j.removeClass(E[G],"EQQ_CurrentMode");j.addClass(C,"EQQ_CurrentMode");e.reset();switch(C.getAttribute("flag")){case "offline":A(function(){n.id("EQQ_settingButtonText").className="EQQ_settingButtonText_offline";n.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconOffline"});break;case "online":y(function(){n.id("EQQ_settingButtonText").className="EQQ_settingButtonText_online";n.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconActive"});webq.framework.cookie.set("mb_chat",(new Date).getTime(),"t.qq.com");break;case "lock":q(function(){n.id("EQQ_settingButtonText").className="EQQ_settingButtonText_lock";n.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconForbidden"})}},".~EQQ_MinButton click":function(i){i.preventDefault();c()},"@ @click":function(i){i.stopPropagation();o&&o.hide()}},show:function(){this.isMainPanelShow=true;j.show(this.id("EQQ_MainPanel"))},hide:function(){this.isMainPanelShow=false;j.hide(this.id("EQQ_MainPanel"))},showFacePanel:function(i){if(this.isFacePanelShow)this.hideFacePanel();else{this.id("EQQ_FaceSelection").style.right=i+"px";j.show(this.id("EQQ_FaceSelection"));this.isFacePanelShow=true}},hideFacePanel:function(){j.hide(this.id("EQQ_FaceSelection"));this.isFacePanelShow=false},remoteAtChat:function(){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/get_friend_info",{context:this,data:{to:this.id("EQQ_SearchBox").value.split("@").join("")},onSuccess:function(i){i.retcode===0?webq.module.buddyList.chat(i.result.id,i.result):webq.module.yellowTips.bite({type:"remoteAtChatFail",text:_("未相互收听，无法即时聊天")},{beforeRender:function(){this.resetPosition(this.id("EQQ_SearchBox"));this.delayClose(3)}})},onError:function(){webq.module.yellowTips.bite({type:"remoteAtChatFail",text:_("未相互收听，无法即时聊天")},{beforeRender:function(){this.resetPosition(this.id("EQQ_SearchBox"));this.delayClose(3)}})}})}});webq.CONST.index=0;var b=new p(webq.CONST);b.render();b.afterRender();var d=j.id("EQQ_StartButton"),f=true,g=function(i){if(f){f=false;webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/login",{context:this,data:{},onSuccess:function(n){if(n.retcode===0){webq.CONST.myId=n.result.id;webq.CONST.myNick=n.result.nick;webq.CONST.uin=n.result.uin;i||webq.module.buddyList.fetch(c);webq.module.buddyList.fetch();h.off(d);h.on(d,"click",c);d.setAttribute("title","");s();u=z|w;MI&&MI.bannerTips&&MI.bannerTips()}else f=true},onError:function(){f=true},onTimeout:function(){f=true}})}};h.on(d,"click",g);var q=function(i){webq.module.taskBar.clear();webq.module.chatBox.clear();b.hide();c.reset();j.removeClass(d,"EQQ_startButtonDown");u&z&&B(i);u&w&&setTimeout(function(){D()},0)},y=function(i){u&z||s();u&w||setTimeout(function(){F(i)},0)},z=1,w=2,u=0,A=function(i){u&z||s(i);u&w&&setTimeout(function(){D(i)},0)},F=function(i){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/login",{context:this,data:{},onSuccess:function(n){if(n.retcode===0){webq.CONST.msg_id=0;webq.module.poll.poll();j.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconActive";i&&i();u|=w}},onError:function(){}})},D=function(i){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/logout",{onSuccess:function(n){if(n.retcode===0){webq.module.poll.stopPoll();webq.CONST.msg_id=0;u^=w;i&&setTimeout(i,0)}}})},B=function(i){typeof UI!="undefined"&&MI.ajax&&MI.ajax({url:MI.url.chatStat,type:"post",data:{v:0},success:function(n){if(n.indexOf("result:0")>-1){i&&i();u^=z}}});MI.WebQQ.report2m(151295)},s=function(i){typeof UI!="undefined"&&MI.ajax&&MI.ajax({url:MI.url.chatStat,type:"post",data:{v:1},success:function(n){if(n.indexOf("result:0")>-1){i&&i();u|=z}}})};(new (v.extend({target:document,events:{"!.addAttention,.reply,.chat,.msg,...moreFun,...talkWrap,...DWrap,...tbSendMsg click":function(){b.hideFacePanel();b.hide();c.reset();j.removeClass(d,"EQQ_startButtonDown");webq.module.chatBox.hide()}}}))).render();webq.module.container=a;webq.module.ammo=b;setTimeout(function(){g(true)},100);webq.module.login={setOffline:A};webq.module.yellowTips=t})();(function(){var k=webq.framework,j=k.rpcservice={},v=k.string;document.domain="qq.com";if(typeof window.XMLHttpRequest==="undefined")window.XMLHttpRequest=function(){return new window.ActiveXObject(navigator.userAgent.indexOf("MSIE 5")>=0?"Microsoft.XMLHTTP":"Msxml2.XMLHTTP")};webq.tProxyReady=function(){};var r=webq.CONST.CLIENTID,p,t=false,l=[],h=function(o,a){if(p)m(o,a);else{l.push({url:o,option:a});if(!t){t=true;var c=document.body,e=document.createElement("div"),b="EQQ_ProxySendIframe"+(new Date).getTime();e.innerHTML='<iframe id="'+b+'" class="hiddenIframe" name="'+b+'" width="1" height="1" src="about:blank"></iframe>';c.appendChild(e);c=document.getElementById(b);webq.tProxyReady=function(){p=window.frames[b].ajax;for(var d=0;d<l.length;++d){var f=l[d].url,g=l[d].option;try{m(f,g)}catch(q){if(!g.onError)break;f={};f.arguments=g.arguments||{};g.onError.call(g.context,f)}}};c.setAttribute("src",webq.CONST.CONN_PROXY_URL)}}},m=function(o,a){a=a||{};a.cacheTime=a.cacheTime||0;a.onSuccess=a.onSuccess||function(){};a.onError=a.onError||function(){};a.onTimeout=a.onTimeout||function(){};a.onComplete=a.onComplete||function(){};var c={method:a.method||"GET",enctype:a.enctype||"",data:a.data||{},arguments:a.arguments||{},context:a.context||null,timeout:a.timeout,onSuccess:function(b){var d={},f=false;b.responseText=b.responseText||"-";try{d=k.json.parse(b.responseText)}catch(g){b.responseText+=":bad-JSON-format:";f=true}finally{d.arguments=a.arguments||{};d.o=b;a.onSuccess.call(a.context,d,f)}},onError:function(b){a.onError.call(a.context,b)},onTimeout:function(){var b={};b.arguments=a.arguments||{};a.onTimeout.call(a.context,b)},onComplete:function(){var b={};b.arguments=a.arguments||{};a.onComplete.call(a.context,b)}};c.data.clientid=r;if(c.method=="GET"){var e=v.obj2queryString(c.data);if(a.cacheTime===0)e+=e?"&t="+(new Date).getTime():"t="+(new Date).getTime();if(e)o=o+"?"+e;c.data=null}else{c.contentType="application/x-www-form-urlencoded";o.indexOf("?")}p(o,c)},x=function(o,a){var c,e,b,d=false,f=false;a={method:a.method||"GET",data:a.data||null,arguments:a.arguments||null,onSuccess:a.onSuccess||function(){},onError:a.onError||function(){},onComplete:a.onComplete||function(){},onTimeout:a.onTimeout||function(){},isAsync:a.isAsync||true,timeout:a.timeout?a.timeout:1E4,contentType:a.contentType?a.contentType:"utf-8",type:a.type||"xml"};o=o||"";b=a.timeout;c=new window.XMLHttpRequest;c.open(a.method,o,a.isAsync);c.setRequestHeader("Content-Type",a.contentType);e=function(g){try{return!g.status&&location.protocol=="file:"||g.status>=200&&g.status<300||g.status==304||navigator.userAgent.indexOf("Safari")>-1&&typeof g.status=="undefined"}catch(q){}return false};c.onreadystatechange=function(){if(c.readyState==4){if(!d){var g={};g.responseText=c.responseText;g.responseXML=c.responseXML;g.data=a.data;g.status=c.status;g.uri=o;g.arguments=a.arguments;if(e(c)){a.type==="script"&&eval.call(window,data);a.onSuccess(g)}else a.onError(g);a.onComplete(g)}f=true;c=null}};c.send(a.data);window.setTimeout(function(){var g;if(!f){d=true;g={};g.uri=o;g.arguments=a.arguments;a.onTimeout(g);a.onComplete(g)}},b);return c};j.send=h;j.combine=function(o,a,c){var e=function(b){a.onError=a.errback||function(){};b=b||function(){};a.onSuccess=function(d){a.callback(d,b)};h(o,a)};return c?e:e()};j.require=function(o,a){for(var c=o.length,e=function(){c--;c==0&&setTimeout(a,13)},b=0;b<c;b++)o[b](e)};j.abortProxy=function(){try{(void 0).abort()}catch(o){}};j.ajax=function(o,a){a=a||{};a.cacheTime=a.cacheTime||0;a.onSuccess=a.onSuccess||function(){};a.onError=a.onError||function(){};a.onTimeout=a.onTimeout||function(){};a.onComplete=a.onComplete||function(){};var c={method:a.method||"GET",contentType:a.contentType||"",enctype:a.enctype||"",param:a.param||{},arguments:a.arguments||{},context:a.context||null,timeout:a.timeout||3E4,onSuccess:function(b){b=k.json.parse(b.responseText);b.arguments=a.arguments||{};a.onSuccess.call(a.context,b)},onError:function(b){a.onError.call(a.context,b)},onTimeout:function(){var b={};b.arguments=a.arguments||{};a.onTimeout.call(a.context,b)},onComplete:function(){var b={};b.arguments=a.arguments||{};a.onComplete.call(a.context,b)}};if(c.method=="GET"){c.data=a.data||{};var e=k.string.Obj2QueryString(c.data);if(a.cacheTime===0)e+=e?"&t="+(new Date).getTime():"t="+(new Date).getTime();if(e)o=o+"?"+e;c.data=null}else{c.data=a.data||"";c.contentType="application/x-www-form-urlencoded";o.indexOf("?")}x(o,c)}})();(function(){function k(l){return this instanceof arguments.callee?this.init.call(this,l):t.api}var j=webq.framework,v=j.dom,r=j.rpcservice,p=webq.CONST;k.prototype={init:function(){},timeout:9E4,pollCount:0,pollMax:1,failCount:0,sendPoll:function(l){l={msg_id:webq.CONST.msg_id,clientid:webq.CONST.clientid};if(this.pollCount<this.pollMax){this.pollCount++;r.send(p.CONN_SERVER_DOMAIN+"channel/poll",{context:this,data:l,timeout:this.timeout,onSuccess:this.sendPollSuccess,onError:this.sendPollError,onTimeout:this.sendPollTimeout})}},startPoll:function(){this.pollMax=1;this.sendPoll()},stopPoll:function(){this.pollMax=0},sendPollSuccess:function(l){this.pollCount--;if(l.retcode===0||l.retcode===102){this.resetFailCount();this.router(l.result);this.sendPoll()}else{this.sendPoll();this.onFail()}},sendPollError:function(){this.sendPollTimeout()},sendPollTimeout:function(){this.pollCount--;this.sendPoll();this.onFail()},resetFailCount:function(){this.failCount=0},onFail:function(){this.failCount++;if(this.failCount>4){this.failCount=0;k().stopPoll();webq.module.yellowTips.bite({type:"pollovermax",text:_("登录失效请刷新页面")},{beforeRender:function(){this.resetPosition(this.id("EQQ_MainBar"));UI&&$$("#EQQ_Container .mdTips")&&$$("#EQQ_Container .mdTips")[0]&&UI.hide($$("#EQQ_Container .mdTips")[0])}})}},router:function(l){if(l)try{var h=l.message,m=l.history,x=l.buddies_status_change,o=l.logout;if(h){h.sort(function(e,b){return e[1].msg_id>b[1].msg_id?1:-1});for(var a=0;a<h.length;a++){webq.module.chatBox.msgRouter(webq.module.msg.setItem(h[a]));webq.CONST.msg_id=h[a][1].msg_id}}if(m){m.sort(function(e,b){return e[1].msg_id>b[1].msg_id?1:-1});for(a=0;a<m.length;a++){webq.module.chatBox.msgRouter(webq.module.msg.setItem(m[a]),true);webq.CONST.msg_id=m[a][1].msg_id}}x&&webq.module.buddyList.buddyRouter(x);o&&webq.module.login.setOffline()}catch(c){}}};var t={};t.api={core:new k,poll:function(){this.core.startPoll();v.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconActive"},stopPoll:function(){this.core.stopPoll()}};webq.module.poll=k()})();(function(){var k=webq.framework,j=k.dom,v=k.model,r=k.controller,p=k.collection,t=k.func;k=k.view.extend({target:"EQQ_Class_0_online",container:["div",{style:"height:34px;overflow:auto;"},function(){}],template:'<div id="EQQ_BuddyList_AvatarContainer_<%=id%>" class="EQQ_BuddyList_AvatarContainer" uin="<%=id%>" title="<%=id%>">\t<img id="EQQ_BuddyList_Avatar_<%=id%>" class="EQQ_BuddyList_Avatar" src="http://mat1.gtimg.com/www/mb/images/head_30.jpg" />\t<div class="EQQ_BuddyList_State"></div></div><div id="EQQ_BuddyList_RightContainer_<%=id%>" class="EQQ_BuddyList_RightContainer" title="<%=htmlNick%>(<%=id%>)">\t<div class="EQQ_BuddyList_Nick"><div class="EQQ_BuddyList_Nick_inner"><%=htmlNick%>(<%=id%>)</div></div>\t<a class="EQQ_BuddyList_QzoneIcon" target="_blank" href="http://t.qq.com/<%=id%>" title="'+_("查看最新微博")+'"></a></div>',events:{".EQQ_BuddyList_RightContainer,.EQQ_BuddyList_Nick,.EQQ_BuddyList_Nick_inner,.EQQ_BuddyList_Avatar click":function(h,m){m.trigger("chat",m.getId());m.trigger("unflash",m.getId())}},afterRender:function(h){h||this.loadAvatar()},loadAvatar:function(){if(!this._loaded){j.id("EQQ_BuddyList_Avatar_"+this._data.id).src=this._data.avatar;this._loaded=true}},init:function(){},flash:function(){var h=this;this.unflash();this.isFlashing=new t.fx(4,t.toggle(function(){h.el.style.background="#73cff1"},function(){h.el.style.background="transparent"},true))},unflash:function(){if(this.isFlashing){this.el.style.background="transparent";this.isFlashing.stop();delete this.isFlashing}},insertBefore:function(){this.target.insertBefore(this.el,this.target.childNodes[0])},renew:function(){j.removeClass(this.el,"fade");this.trigger("renew",this.getId())},fade:function(){j.addClass(this.el,"fade");this.target.appendChild(this.el);this.trigger("fade",this.getId())},update:function(h){if(h.statu=="online"){this.renew();this.insertBefore()}else h.statu=="offline"&&this.fade()}});v=v.extend({xss:{nick:"htmlNick"},map:function(h,m,x){if(h=="avatar"){var o;if(m){o=m+"/20";m+="/30"}else o=m=webq.CONST.DEFAULT_FACE_URL;x[h+"_20"]=o}return m}});p=p.extend({model:v,key:"id"});var l=new (r.extend({init:function(){var h=this;this.collection.bind("add",function(){h.updateOnlineCount(+1)})},collection:p,view:k,viewObserver:{chat:function(h,m){m.chat(h);webq.module.container.unflashTaskBar()},unflash:function(h,m){m.unflash(h);webq.module.taskBar.unflash(h)},renew:function(h,m){m.updateOnlineCount(+1)},fade:function(h,m){m.updateOnlineCount(-1)}},_onlineCount:0,updateOnlineCount:function(h){this._onlineCount+=h;j.id("EQQ_onlineCount").innerHTML="("+this._onlineCount+")"},initAvatar:function(){if(!this._initAvatar){var h=this;this.collection.map(function(m){(m=h.find(m))&&m.loadAvatar()});this._initAvatar=true}},chat:function(h,m){if(m){this.bite(m);m.statu=="offline"&&this.find(h).fade()}m=this.collection.find(h);webq.module.taskBar.chat(m);webq.module.chatBox.chat(m)},fetch:function(h){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/get_online_buddies",{context:this,data:{},onSuccess:function(m){if(m.retcode===0){m.result.sort(function(o,a){return o.id<a.id?-1:1});for(var x=m.result.length-1;x>=0;x--)m.result[x].statu="online";j.hide("EQQ_Logining");j.show("EQQ_BuddyList");this.feed(m.result,{delay:true});h&&h();setTimeout(function(){webq.module.poll.poll();for(var o=MI.WebQQ.chatQueue;0<o.length;o++)MI.WebQQ.chat.apply(null,o[0])},0)}},onError:function(){}})},buddyRouter:function(h){this.bite(h)},unflash:function(h){if(this.flashingViews){var m=t.arrayIndexOf(this.flashingViews,h);if(m>-1){this.flashingViews.splice(m,1);this.find(h).unflash();this.flashingViews.length==0&&webq.module.container.unflashMainBar()}}},insertBefore:function(h){(h=this.find(h))&&h.insertBefore()},GET_FRIEND_INFO_LOCK:{},msgRouter:function(h){var m=this.find(h),x=this;if(m){webq.module.titleMaquee.run();m.flash();this.flashingViews=this.flashingViews||[];t.arrayIndexOf(this.flashingViews,h)>-1||this.flashingViews.push(h);m.insertBefore();webq.module.container.flashMainBar()}else if(!x.GET_FRIEND_INFO_LOCK[h]){x.GET_FRIEND_INFO_LOCK[h]=true;webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/get_friend_info",{data:{to:h},timeout:5E3,onSuccess:function(o){if(o.retcode===0){x.bite(o.result);var a=x.find(h);a.flash();o.result.statu=="offline"&&a.fade();x.flashingViews=x.flashingViews||[];x.flashingViews.push(h);a.insertBefore();webq.module.container.flashMainBar();webq.module.titleMaquee.run()}delete x.GET_FRIEND_INFO_LOCK[h]},onError:function(){delete x.GET_FRIEND_INFO_LOCK[h]},onTimeout:function(){delete x.GET_FRIEND_INFO_LOCK[h]}})}}}))({});webq.module.buddyList=l;MI.WebQQ.chat=function(h,m,x){l.chat(h,{id:h,nick:m,avatar:x})}})();(function(){var k=webq.framework,j=k.dom,v=k.model,r=k.controller,p=k.collection,t=k.func;k=k.view.extend({target:"EQQ_ChatBuddyList",container:["div",{style:"width:35px;height:35px;float:left;cursor: pointer;"}],template:'<div id="EQQ_FlashDiv_<%=id%>" class="EQQ_TaskBar_FlashDiv EQQ_taskBar_currentBuddy">                    <div id="EQQ_TaskBar_BuddyState_<%=id%>" class="EQQ_taskBar_onlineBuddy">                        <img class="EQQ_taskBar_avatar" src="<%=avatar_20%>" />                        <div class="EQQ_taskBar_state">online</div>                    </div>                    <div class="EQQ_taskBar_nick"><%=htmlNick%></div>                </div>                <div id="EQQ_TaskBar_CloseChatBoxButton_<%=id%>" class="EQQ_TaskBar_CloseChatBoxButton" title="'+_("关闭会话窗口")+'">X</div>            ',init:function(){},afterInit:function(){this.trigger("taskAdd")},destory:function(){this.el.parentNode.removeChild(this.el);this.trigger("taskRemove")},getRight:function(){var l=j.getClientWidth(),h=j.getClientXY(this.el)[0];l-=h+parseInt(this.id("EQQ_Container").style.right)+25;if(h<265)l-=265-h;return l},setCurrent:function(){j.addClass(this.el.childNodes[0],"EQQ_taskBar_currentBuddy")},setUnCurrent:function(){j.removeClass(this.el.childNodes[0],"EQQ_taskBar_currentBuddy")},events:{"@ @click":function(l,h){var m=h.getId();h.trigger("click",h);h.trigger("unflash",m)}},update:function(){j.show(this.el)},flash:function(){var l=this;this.unflash();this.isFlashing=new t.fx(4,t.toggle(function(){l.el.style.background="#C9F1FF"},function(){l.el.style.background="transparent"},true))},unflash:function(){if(this.isFlashing){this.el.style.background="transparent";this.isFlashing.stop();delete this.isFlashing}},insertBefore:function(){this.target.appendChild(this.el);this.trigger("insertBefore",this.getId())}});v=v.extend({});p=p.extend({model:v,key:"id"});r=new (r.extend({collection:p,view:k,viewObserver:{click:function(l,h){var m=h.collection.find(l.getId());h.chat(m);webq.module.chatBox.chat(m);webq.module.container.unflashTaskBar()},taskAdd:function(l){webq.module.container.taskAdd();l.checkTaskLimit()},taskRemove:function(){webq.module.container.taskRemove()},insertBefore:function(l,h){h.collection.insertBefore(l)},unflash:function(l,h){h.unflash(l);webq.module.buddyList.unflash(l)}},chat:function(l){this.bite(l);this.setCurrent(l[this.key])},setCurrent:function(l){if(this.currentId){var h=this.find(this.currentId);h&&h.setUnCurrent()}this.currentId=l;this.find(l).setCurrent()},setUnCurrent:function(l){this.find(l).setUnCurrent()},unflash:function(l){if(this.flashingViews){var h=t.arrayIndexOf(this.flashingViews,l);if(h>-1){this.flashingViews.splice(h,1);this.find(l).unflash();this.flashingViews.length==0&&webq.module.container.unflashTaskBar()}}},msgRouter:function(l){var h=this.find(l);if(h){h.flash();this.flashingViews=this.flashingViews||[];this.flashingViews.push(l);h.insertBefore();webq.module.container.flashTaskBar()}},clear:function(){var l=this;this.collection.map(function(h){l.puke(h)});this.currentId=null},taskLimit:Math.floor(795.8),checkTaskLimit:function(){if(this.collection.getLength()>this.taskLimit){var l=this.collection.getFirst();this.puke(l);webq.module.chatBox.puke(l)}}}))({});webq.module.taskBar=r})();(function(){var k=webq.framework,j=k.dom,v=k.view,r=k.model,p=k.controller,t=k.collection,l=k.json,h=k.string,m=k.func,x=function(){return parseInt(webq.framework.cookie.get("luin").substr(1),"10")||parseInt(webq.framework.cookie.get("uin").substr(1),"10")},o=function(b){return String(b).length<2?"0"+b:b},a=function(b){if(String(b).length<13)b=parseInt(b)*1E3;b=new Date(parseInt(b));return[o(b.getHours())+":"+o(b.getMinutes()),b.getMonth()+1+"-"+b.getDate()]},c={toofast:_("您的说话速度太快了，请稍后再发。"),uinconflict:_("登录失效请刷新页面"),charsovermax:_("消息内容请勿超过300字，请修改后再试。"),selfoffline:_("您已经离线，无法进行会话，请重新上线后再试。"),offline:_("对方已经下线，可能无法即时回复，您可以给他发送离线消息或者私信。"),msgmiss:_("现在通过微博实时聊天的记录会自动转存为私信，方便您以后查阅，快来试试吧 ~"),dirtyword:_("您输入的内容有误，请修改后再次发送。"),notfollow:_("会话方与您不存在互听关系，如需发起实时聊天，需要双方微博互听。"),notopen:function(b){var d=e.collection.find(b).getter("htmlNick");return _("对方禁用了聊天，无法收到本条消息")+'...<a style="text-decoration:underline;cursor:pointer" onclick=\'MI.message("'+b+'","Hi~'+d+"，"+_("我正在使用腾讯微博的实时聊天功能，快来这里开通实时聊天功能，与我在线聊天吧！")+"http://t.qq.com/setting/others\");return false;'>"+_("点这里")+"</a>"+_("，发封私信告诉Ta开通实时聊天权限吧。")}};k=v.extend({target:"EQQ_Container",container:["div",{"class":"EQQ_chatbox"}],template:'<div id="EQQ_uin_chatboxTitle" class="EQQ_chatboxTitle">                <div id="chatBox_avatarArea_<%=id%>" class="onlineBuddyInChatbox" title="">                    <a title="<%=nick%>(@<%=id%>)" href="http://t.qq.com/<%=id%>"><img id="EQQ_Chatbox_Avatar_<%=id%>" class="avatarInChatbox" title="<%=nick%>(@<%=id%>)" src="<%=avatar%>" /></a>                    <div class="stateInChatbox">'+_("状态")+'</div>                </div>                <div class="EQQ_chatboxControler">                    <a href="#" onclick="return false;"><div id="EQQ_ChatboxCloseButton_<%=id%>" class="EQQ_chatboxCloseButton" title="'+_("关闭")+'" href="#"></div></a>                    <a href="#" onclick="return false;"><div id="EQQ_ChatboxMinButton_<%=id%>" class="EQQ_chatboxMinButton" title="'+_("最小化")+'" href="#"></div></a>                </div>                <div class="EQQ_chatboxNameLine">                    <a id="EQQ_ChatboxName_<%=id%>" class="EQQ_chatboxName" href="/<%=id%>" ><span id="EQQ_ChatboxMainName_<%=id%>" class="mainName"><%=htmlNick%>(<%=id%>)</span></a>                </div>                <div id="EQQ_ChatboxMoreInfo_<%=id%>" class="EQQ_chatboxMoreInfo">                    <a href="#" onclick="return false;" title="'+_("加为QQ好友")+'"><div class="EQQ_addBuddyIcon"></div><div class="EQQ_addBuddyText">'+_("加为QQ好友")+'</div></a>                </div>            </div>            <div class="EQQ_chatOutline">                <div id="ChatContentInChatbox_<%=id%>" class="chatContentInChatbox">\t<\!--\t<dl class= "myMsgInChatbox"><dt class="msgHead">dasdasdasdsa</dt><dd class="msgBody">dasdasdas</dd>\t</dl>\t<dl class="buddyMsgInChatbox"><dt class="msgHead">asdasdads</dt><dd class="msgBody">dasdasd</dd>\t</dl>\t--\>                </div>            </div>            </div>            <div class="optionInChatbox">            <a href="#" style="width: 20px;display: block;" onclick="return false;">            \t<div id="FaceButtonInChatbox_<%=id%>" class="faceButtonInChatbox">'+_("表情")+'</div>\t</a>\t</div>            <textarea id="TextareaInChatbox_<%=id%>" class="textareaInChatbox"></textarea>            <div class="EQQ_chatControler"><a href="#" onclick=\'MI.report("<%=id%>");return false;\' style="display: block; margin-left: 5px; position: absolute; margin-top: 3px;"><div class="EQQ_chatReport">'+_("举报")+'</div></a>                <a href="#" onclick="return false;"><div id="EQQ_sendMsgButton_<%=id%>" class="EQQ_sendMsgButton" title="'+_("发送")+'" >'+_("发送")+'</div></a>                <a href="#" onclick="return false;"><div id="EQQ_ChatboxCloseButton2_<%=id%>" class="EQQ_chatboxCloseButton2" title="'+_("关闭")+'" >'+_("关闭")+"</div></a>            </div>",events:{".EQQ_chatboxCloseButton,.EQQ_chatboxCloseButton2 click":function(b,d){d.trigger("puke",d.getId());webq.module.ammo.hideFacePanel()},".EQQ_chatboxMinButton click":function(b,d){d.hide();d.trigger("mini",d.getId())},".textareaInChatbox keydown":function(b,d){if(b.keyCode==13&&b.ctrlKey){var f=d.getId(),g=d.getContent();d.trigger("send",f,g)}},".EQQ_sendMsgButton click":function(b,d){var f=d.getId(),g=d.getContent();d.trigger("send",f,g)},".faceButtonInChatbox click":function(b,d){b.preventDefault();b.stopPropagation();var f=j.getClientWidth(),g=j.getClientXY(b.target)[0];f-=g+parseInt(d.id("EQQ_Container").style.right)+25;if(g<411)f-=411-g;try{d.id("TextareaInChatbox_"+d.getId()).focus()}catch(q){}if((g=document.selection)&&g.createRange)this.selection=g.createRange();d.trigger("face",d.getId(),f)},".EQQ_yellowTips_close click":function(b,d){var f=b.target.parentNode;d.closeTips(f);f.getAttribute("flag")=="msgmiss"&&d.trigger("setNoWarnning")},"...EQQ_chatboxMoreInfo click":function(b,d){MI&&MI.addQQ&&MI.addQQ(d.getId());MI.WebQQ.report2m(151291)}},tipsCount:0,renderTips:function(b,d){var f,g=false;if(f=j.id("EQQ_yellowTips_"+this.getId()+"_"+b))this.closeTips(f);var q=this;f=j.node("div",{id:"EQQ_yellowTips_"+this.getId()+"_"+b,"class":"EQQ_yellowTips",flag:b});if(b=="notopen"){f.innerHTML=h.template('\t<div class="EQQ_yellowTips_info">!</div>\t<div class="EQQ_yellowTips_text"><%=content%></div>\t<div class="EQQ_yellowTips_close">X</div>\t',{content:c[b](this.getId())});g=true}else f.innerHTML=h.template('\t<div class="EQQ_yellowTips_info">!</div>\t<div class="EQQ_yellowTips_text"><%=content%></div>\t<div class="EQQ_yellowTips_close">X</div>\t',{content:c[b]});this.id("ChatContentInChatbox_"+this.getId()).appendChild(f);this.tipsCount++;j.addClass(this.id("ChatContentInChatbox_"+this.getId()),"tips");if(!g||d)setTimeout(function(){q.closeTips(f)},6E3)},closeTips:function(b){try{b.parentNode.removeChild(b);this.tipsCount--;this.tipsCount==0&&j.removeClass(this.id("ChatContentInChatbox_"+this.getId()),"tips")}catch(d){}},afterInit:function(){this.isShow=true},update:function(){var b=this;j.show(this.el);var d=this.id("ChatContentInChatbox_"+this.getId());setTimeout(function(){d.scrollTop=d.scrollHeight;try{b.id("TextareaInChatbox_"+b.getId()).focus()}catch(f){}},0);this.trigger("update",this.getId())},afterRender:function(){this.id("TextareaInChatbox_"+this.getId()).focus();this.trigger("fillMe",this.getId());this.trigger("setTips",this.getId());MI.Card&&MI.Card.build&&MI.Card.build(document,"#EQQ_Chatbox_Avatar_"+this.getId(),3)},appendMsg:function(b){var d=webq.CONST.myId==b.from_id?j.node("dl",{"class":"myMsgInChatbox"}):j.node("dl",{"class":"buddyMsgInChatbox"}),f=b.content,g=a(b.time)[0],q=webq.CONST.SHORTCUT_2_FACE,y=[],z;f=h.encodeHtmlSimple(f);f.replace(/\/[\u4e00-\u9fa5ON]/g,function(A,F){var D,B;if(D=q[A]){(B=m.each(D,function(s){s=f.substr(F,s.length);if(typeof D[s]!="undefined")return[s,D[s]]}))&&y.push(B);return A}});for(z=y.length-1;z>=0;z--){var w='<img class="EQQ_faceImg" src="'+webq.CONST.SYSTEM_FACE_URL+y[z][1]+'.gif" />';f=f.split(y[z][0]).join(w)}f=f.replace(/\r\n|\r|\n/ig,"<br />");d.innerHTML=h.template('<dt class="msgHead"><%=htmlAllName%> <%=hm%></dt>                        <dd class="msgBody"><%=htmlContent%></dd>            ',{htmlContent:f,htmlAllName:b.htmlNick+"("+b.from_id+")",hm:g});var u=this.id("ChatContentInChatbox_"+this.getId());u.appendChild(d);setTimeout(function(){u.scrollTop=u.scrollHeight},0)},appendFace:function(b){var d=this.id("TextareaInChatbox_"+this.getId());d.focus();var f=document.selection;if(typeof d.selectionStart!="undefined")d.value=d.value.substr(0,d.selectionStart)+b+d.value.substr(d.selectionEnd);else if(f&&f.createRange){d=f.createRange();d.text=b;try{d.moveStart("character",-strlen(b))}catch(g){}}else d.value+=b},setRight:function(b){this.el.style.right=b+"px"},getContent:function(){return this.id("TextareaInChatbox_"+this.getId()).value},clearContent:function(){this.id("TextareaInChatbox_"+this.getId()).value="";this.id("TextareaInChatbox_"+this.getId()).focus()}});r=r.extend({});t=t.extend({model:r,key:"id"});var e=new (p.extend({init:function(){this.collection.bind("add",function(){MI.WebQQ.report2m(151289)})},collection:t,view:k,viewObserver:{puke:function(b,d){d.puke(b);webq.module.taskBar.puke(b);if(b==d.currentId)d.currentId=null},update:function(b,d){d.setRight(b);d.currentId&&d.find(d.currentId).hide();d.currentId=b},fillMe:function(b,d){for(var f=d.find(b),g=webq.module.msg.getItem(b),q=0;q<g.length;q++)f.appendMsg(g[q][1])},mini:function(b,d){webq.module.taskBar.setUnCurrent(b);if(b==d.currentId)d.currentId=null},send:function(b,d,f){if(d&&d.length>300)f.find(b).renderTips("charsovermax");else if(f.find(b).SENDING)f.find(b).renderTips("toofast");else if(d){f.find(b).SENDING=true;webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/send_msg",{method:"post",timeout:5E3,data:h.obj2queryString({r:l.stringify({to:b,content:d})}),onSuccess:function(g){delete f.find(b).SENDING;switch(g.retcode){case 0:f.find(b).clearContent();MI.WebQQ.report2m(151293);break;case 118:f.find(b).renderTips("offline");f.msgRouter(webq.module.msg.setItem(["message",{msg_id:webq.module.msg.getSequence(),from_id:webq.CONST.myId,to_id:b,time:Math.floor((new Date).getTime()/1E3),content:d}]));f.find(b).clearContent();MI.WebQQ.report2m(151292);break;case 117:f.find(b).renderTips("dirtyword");MI.WebQQ.report2m(151294);break;case 119:x()!=webq.CONST.uin?webq.module.yellowTips.bite({type:"uinconflict",text:_("登录失效请刷新页面")},{beforeRender:function(){this.resetPosition(this.id("EQQ_StartButtonIcon"))}}):f.find(b).renderTips("notfollow");MI.WebQQ.report2m(151294);break;case 121:f.find(b).renderTips("notopen");MI.WebQQ.report2m(151294);break;case 103:case 100:x()!=webq.CONST.uin?webq.module.yellowTips.bite({type:"uinconflict",text:_("登录失效请刷新页面")},{beforeRender:function(){this.resetPosition(this.id("EQQ_StartButtonIcon"))}}):f.find(b).renderTips("selfoffline");MI.WebQQ.report2m(151294)}},onError:function(){delete f.find(b).SENDING},onTimeout:function(){delete f.find(b).SENDING}})}},face:function(b,d){webq.module.ammo.showFacePanel(d)},setTips:function(b,d){d.isWarnning&&d.find(b).renderTips("msgmiss",true)},setNoWarnning:function(b){b.isWarnning=false}},isWarnning:true,appendFace:function(b){if(this.currentId){var d=this.find(this.currentId);d.isShow&&d.appendFace(b)}},setRight:function(b){if(webq.module.container.isTaskBarRightExtend()){var d=webq.module.taskBar.find(b).getRight();this.find(b).setRight(d)}},chat:function(b){if(b[this.key]==this.currentId){this.find(this.currentId).hide();webq.module.taskBar.setUnCurrent(this.currentId);this.currentId=null}else{var d=b[this.key];this.bite(b);this.setRight(d);this.currentId&&this.find(this.currentId).hide();this.currentId=d;this.find(d).show()}},msgRouter:function(b,d){var f=b[1],g,q;q=f.from_id;if(q==webq.CONST.myId)q=f.to_id;if(g=this.find(q))g.appendMsg(f);if(!((g=this.find(q))&&g.isShow))if(d)q!=f.to_id&&webq.module.buddyList.insertBefore(q);else if(q!=f.to_id){webq.module.buddyList.msgRouter(q);webq.module.taskBar.msgRouter(q)}},clear:function(){var b=this;this.collection.map(function(d){b.puke(d)});this.currentId=null},hide:function(){if(this.currentId){this.find(this.currentId).hide();webq.module.taskBar.setUnCurrent(this.currentId);this.currentId=null}}}))({});webq.module.chatBox=e})();(function(){var k=webq.framework,j=k.func,v=k.event;webq.module.msg=function(){var r={},p=(new Date).getTime();p=(p-p%1E3)/1E3;p=p%1E4*1E4;var t=0;return{getItem:function(l){return r[l]||[]},setItem:function(l){var h,m;if(l[1].from_id==webq.CONST.myId){h=r[l[1].to_id]=r[l[1].to_id]||[];l[1].htmlNick=_(webq.CONST.myNick)}else{h=r[l[1].from_id]=r[l[1].from_id]||[];m=webq.module.buddyList.collection.find(l[1].from_id);l[1].htmlNick=m?m.getter("htmlNick"):l[1].from_id}h.push(l);return l},getSequence:function(){t++;return p+t}}}();webq.module.titleMaquee=function(){var r,p=_(" 收到新的微博实时聊天消息"),t=p,l=document.title+"",h=false,m=function(){if(r){r.stop();r=null}t=p;document.title=(MI.newCountNum?"("+MI.newCountNum+") ":"")+(document.titleTmp||l)};if("onfocusin"in document){v.on(document,"focusin",function(){h=false;m()});v.on(document,"focusout",function(){h=true})}else{v.on(window,"focus",function(){h=false;m()});v.on(window,"blur",function(){h=true})}return{run:function(){m();if(h)r=new j.fx(2,function(){t=t.substr(1)+t.charAt(0);document.title=t})},stop:m}}()})();/*  |xGv00|1e999a3b91925cb82eca61b85d74e8a9 */